{"remainingRequest":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\babel-loader\\lib\\index.js??ref--3-1!D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\valine\\dist\\Valine.min.js","dependencies":[{"path":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\valine\\dist\\Valine.min.js","mtime":499162500000},{"path":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90eXBlb2YgPSByZXF1aXJlKCJEOi92c2NvZGVwcm9qZWN0cy92dWVwcmVzcy10aGVtZS1yZWNvL215YmxvZ3Mvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mIilbImRlZmF1bHQiXTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZGVmaW5lLXByb3BlcnR5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5pdGVyYXRvci5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuY29uc3RydWN0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mb3ItZWFjaC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLnRpbWVycy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuZGF0ZS5ub3cuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLnRvLXN0cmluZy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1wcm90b3R5cGUtb2YuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS1idWZmZXIuc2xpY2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS51aW50OC1hcnJheS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmNvcHktd2l0aGluLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZXZlcnkuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWxsLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmlsdGVyLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQtaW5kZXguanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5mb3ItZWFjaC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluY2x1ZGVzLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5kZXgtb2YuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pdGVyYXRvci5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmpvaW4uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5sYXN0LWluZGV4LW9mLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubWFwLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLXJpZ2h0LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmV2ZXJzZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNldC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNsaWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29tZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvcnQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zdWJhcnJheS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLWxvY2FsZS1zdHJpbmcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1zdHJpbmcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS1idWZmZXIuY29uc3RydWN0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuYXN5bmMtaXRlcmF0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5kYXRhLXZpZXcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5mbG9hdDMyLWFycmF5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmxvYXQ2NC1hcnJheS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmludDgtYXJyYXkuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pbnQxNi1hcnJheS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmludDMyLWFycmF5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMubWFwLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucGFyc2UtZmxvYXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5wYXJzZS1pbnQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zZXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS51aW50OC1jbGFtcGVkLWFycmF5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudWludDE2LWFycmF5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudWludDMyLWFycmF5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMud2Vhay1tYXAuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy53ZWFrLXNldC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLmJpbmQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZi5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLWVuZC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmlzLWFycmF5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmxpbmsuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmNyZWF0ZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC50by1zdHJpbmctdGFnLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi50by1zdHJpbmctdGFnLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMubWF0aC50by1zdHJpbmctdGFnLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmV2ZXJzZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LW5hbWVzLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC5qcyIpOwoKLyohCiAqIFZhbGluZSB2MS40LjE0CiAqIChjKSAyMDE3LTIwMjAgeENzcwogKiBSZWxlYXNlZCB1bmRlciB0aGUgR1BMLTIuMCBMaWNlbnNlLgogKiBMYXN0IFVwZGF0ZTogMjAyMC80LzI2IOS4i+WNiDg6Mzk6MDgKICovCiFmdW5jdGlvbiAoZSwgdCkgewogICJvYmplY3QiID09ICh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZXhwb3J0cykpICYmICJvYmplY3QiID09ICh0eXBlb2YgbW9kdWxlID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihtb2R1bGUpKSA/IG1vZHVsZS5leHBvcnRzID0gdCgpIDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgZGVmaW5lICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoW10sIHQpIDogIm9iamVjdCIgPT0gKHR5cGVvZiBleHBvcnRzID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihleHBvcnRzKSkgPyBleHBvcnRzLlZhbGluZSA9IHQoKSA6IGUuVmFsaW5lID0gdCgpOwp9KHRoaXMsIGZ1bmN0aW9uICgpIHsKICByZXR1cm4gZnVuY3Rpb24gKGUpIHsKICAgIGZ1bmN0aW9uIHQocikgewogICAgICBpZiAobltyXSkgcmV0dXJuIG5bcl0uZXhwb3J0czsKICAgICAgdmFyIG8gPSBuW3JdID0gewogICAgICAgIGk6IHIsCiAgICAgICAgbDogITEsCiAgICAgICAgZXhwb3J0czoge30KICAgICAgfTsKICAgICAgcmV0dXJuIGVbcl0uY2FsbChvLmV4cG9ydHMsIG8sIG8uZXhwb3J0cywgdCksIG8ubCA9ICEwLCBvLmV4cG9ydHM7CiAgICB9CgogICAgdmFyIG4gPSB7fTsKICAgIHJldHVybiB0Lm0gPSBlLCB0LmMgPSBuLCB0LmkgPSBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZTsKICAgIH0sIHQuZCA9IGZ1bmN0aW9uIChlLCBuLCByKSB7CiAgICAgIHQubyhlLCBuKSB8fCBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgbiwgewogICAgICAgIGNvbmZpZ3VyYWJsZTogITEsCiAgICAgICAgZW51bWVyYWJsZTogITAsCiAgICAgICAgZ2V0OiByCiAgICAgIH0pOwogICAgfSwgdC5uID0gZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIG4gPSBlICYmIGUuX19lc01vZHVsZSA/IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZVsiZGVmYXVsdCJdOwogICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBlOwogICAgICB9OwogICAgICByZXR1cm4gdC5kKG4sICJhIiwgbiksIG47CiAgICB9LCB0Lm8gPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsIHQpOwogICAgfSwgdC5wID0gIiIsIHQodC5zID0gNjMpOwogIH0oW2Z1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgZnVuY3Rpb24gcihlKSB7CiAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7CiAgICAgICAgImRlZmF1bHQiOiBlCiAgICAgIH07CiAgICB9CgogICAgdC5fX2VzTW9kdWxlID0gITA7CiAgICB2YXIgbyA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiAic3ltYm9sIiA9PSBfdHlwZW9mKFN5bWJvbC5pdGVyYXRvcikgPyBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gX3R5cGVvZihlKTsKICAgIH0gOiBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZSAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgZS5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIGUgIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IF90eXBlb2YoZSk7CiAgICB9LAogICAgICAgIGkgPSBuKDM4KSwKICAgICAgICBhID0gcihpKSwKICAgICAgICBzID0gbigyOCksCiAgICAgICAgbCA9IHIocyksCiAgICAgICAgYyA9IG4oMjcpLAogICAgICAgIHUgPSByKGMpLAogICAgICAgIGQgPSBuKDQyKSwKICAgICAgICBwID0gcihkKSwKICAgICAgICBmID0gZG9jdW1lbnQsCiAgICAgICAgaCA9IG5hdmlnYXRvciwKICAgICAgICB2ID0gL1smPD4iJ2BcXF0vZywKICAgICAgICBnID0gUmVnRXhwKHYuc291cmNlKSwKICAgICAgICBtID0gLyYoPzphbXB8bHR8Z3R8cXVvdHwjMzl8I3g2MHwjeDVjKTsvZywKICAgICAgICB5ID0gUmVnRXhwKG0uc291cmNlKSwKICAgICAgICBiID0gewogICAgICAiJiI6ICImYW1wOyIsCiAgICAgICI8IjogIiZsdDsiLAogICAgICAiPiI6ICImZ3Q7IiwKICAgICAgJyInOiAiJnF1b3Q7IiwKICAgICAgIiciOiAiJiMzOTsiLAogICAgICAiYCI6ICImI3g2MDsiLAogICAgICAiXFwiOiAiJiN4NWM7IgogICAgfSwKICAgICAgICB3ID0ge307CgogICAgZm9yICh2YXIgeCBpbiBiKSB7CiAgICAgIHdbYlt4XV0gPSB4OwogICAgfQoKICAgIHZhciBrID0gbnVsbDsKICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoIHx8IChBcnJheS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIHZhciBuLCByOwogICAgICBpZiAobnVsbCA9PSB0aGlzKSB0aHJvdyBuZXcgVHlwZUVycm9yKCIgdGhpcyBpcyBudWxsIG9yIG5vdCBkZWZpbmVkIik7CiAgICAgIHZhciBvID0gT2JqZWN0KHRoaXMpLAogICAgICAgICAgaSA9IG8ubGVuZ3RoID4+PiAwOwogICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgZSkgdGhyb3cgbmV3IFR5cGVFcnJvcihlICsgIiBpcyBub3QgYSBmdW5jdGlvbiIpOwoKICAgICAgZm9yIChhcmd1bWVudHMubGVuZ3RoID4gMSAmJiAobiA9IHQpLCByID0gMDsgciA8IGk7KSB7CiAgICAgICAgdmFyIGE7CiAgICAgICAgciBpbiBvICYmIChhID0gb1tyXSwgZS5jYWxsKG4sIGEsIHIsIG8pKSwgcisrOwogICAgICB9CiAgICB9KSwgd2luZG93Lk5vZGVMaXN0ICYmICFOb2RlTGlzdC5wcm90b3R5cGUuZm9yRWFjaCAmJiAoTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2ggPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCksIFN0cmluZy5wcm90b3R5cGUudHJpbSB8fCAoU3RyaW5nLnByb3RvdHlwZS50cmltID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZywgIiIpOwogICAgfSksICgwLCBhWyJkZWZhdWx0Il0pKGxbImRlZmF1bHQiXS5mbiwgewogICAgICBwcmVwZW5kOiBmdW5jdGlvbiBwcmVwZW5kKGUpIHsKICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50IHx8IChlID0gZVswXSksIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgdC5pbnNlcnRBZGphY2VudEVsZW1lbnQoImFmdGVyQmVnaW4iLCBlKTsKICAgICAgICB9KSwgdGhpczsKICAgICAgfSwKICAgICAgYXBwZW5kOiBmdW5jdGlvbiBhcHBlbmQoZSkgewogICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgfHwgKGUgPSBlWzBdKSwgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICB0Lmluc2VydEFkamFjZW50RWxlbWVudCgiYmVmb3JlRW5kIiwgZSk7CiAgICAgICAgfSksIHRoaXM7CiAgICAgIH0sCiAgICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKCkgewogICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlKTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgICAgfSksIHRoaXM7CiAgICAgIH0sCiAgICAgIGZpbmQ6IGZ1bmN0aW9uIGZpbmQoZSkgewogICAgICAgIHJldHVybiAoMCwgbFsiZGVmYXVsdCJdKShlLCB0aGlzKTsKICAgICAgfSwKICAgICAgc2hvdzogZnVuY3Rpb24gc2hvdygpIHsKICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBlLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgIH0pLCB0aGlzOwogICAgICB9LAogICAgICBoaWRlOiBmdW5jdGlvbiBoaWRlKCkgewogICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICB9KSwgdGhpczsKICAgICAgfSwKICAgICAgb246IGZ1bmN0aW9uIG9uKGUsIHQsIG4pIHsKICAgICAgICByZXR1cm4gbFsiZGVmYXVsdCJdLmZuLm9mZihlLCB0LCBuKSwgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICBlLnNwbGl0KCIgIikuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICByLmFkZEV2ZW50TGlzdGVuZXIgPyByLmFkZEV2ZW50TGlzdGVuZXIoZSwgdCwgbiB8fCAhMSkgOiByLmF0dGFjaEV2ZW50ID8gci5hdHRhY2hFdmVudCgib24iICsgZSwgdCkgOiByWyJvbiIgKyBlXSA9IHQ7CiAgICAgICAgICB9KTsKICAgICAgICB9KSwgdGhpczsKICAgICAgfSwKICAgICAgb2ZmOiBmdW5jdGlvbiBvZmYoZSwgdCwgbikgewogICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24gKHIpIHsKICAgICAgICAgIGUuc3BsaXQoIiAiKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHIucmVtb3ZlRXZlbnRMaXN0ZW5lciA/IHIucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLCB0LCBuIHx8ICExKSA6IHIuZGV0YWNoRXZlbnQgPyByLmRldGFjaEV2ZW50KCJvbiIgKyBlLCB0KSA6IHJbIm9uIiArIGVdID0gbnVsbDsKICAgICAgICAgIH0pOwogICAgICAgIH0pLCB0aGlzOwogICAgICB9LAogICAgICBodG1sOiBmdW5jdGlvbiBodG1sKGUpIHsKICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBlID8gKHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgdC5pbm5lckhUTUwgPSBlOwogICAgICAgIH0pLCB0aGlzKSA6IHRoaXNbMF0uaW5uZXJIVE1MOwogICAgICB9LAogICAgICB0ZXh0OiBmdW5jdGlvbiB0ZXh0KGUpIHsKICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBlID8gKHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgdC5pbm5lclRleHQgPSBlOwogICAgICAgIH0pLCB0aGlzKSA6IHRoaXNbMF0uaW5uZXJUZXh0OwogICAgICB9LAogICAgICBlbXB0eTogZnVuY3Rpb24gZW1wdHkoZSkgewogICAgICAgIHJldHVybiBlID0gZSB8fCAwLCB0aGlzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdC5pbm5lclRleHQgPSAiIjsKICAgICAgICAgIH0sIGUpOwogICAgICAgIH0pLCB0aGlzOwogICAgICB9LAogICAgICB2YWw6IGZ1bmN0aW9uIHZhbChlKSB7CiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gZSA/ICh0aGlzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHQudmFsdWUgPSBlOwogICAgICAgIH0pLCB0aGlzKSA6IHRoaXNbMF0udmFsdWUgfHwgIiI7CiAgICAgIH0sCiAgICAgIGF0dHI6IGZ1bmN0aW9uIGF0dHIoKSB7CiAgICAgICAgdmFyIGUgPSBhcmd1bWVudHM7CgogICAgICAgIGlmICgib2JqZWN0IiA9PSBvKGFyZ3VtZW50c1swXSkpIHsKICAgICAgICAgIHZhciB0ID0gYXJndW1lbnRzWzBdLAogICAgICAgICAgICAgIG4gPSB0aGlzOwogICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHQpLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgbi5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICAgICAgbi5zZXRBdHRyaWJ1dGUoZSwgdFtlXSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSksIHRoaXM7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gInN0cmluZyIgPT0gdHlwZW9mIGFyZ3VtZW50c1swXSAmJiBhcmd1bWVudHMubGVuZ3RoIDwgMiA/IHRoaXNbMF0uZ2V0QXR0cmlidXRlKGFyZ3VtZW50c1swXSkgfHwgIiIgOiAodGhpcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICB0LnNldEF0dHJpYnV0ZShlWzBdLCBlWzFdKTsKICAgICAgICB9KSwgdGhpcyk7CiAgICAgIH0sCiAgICAgIHJlbW92ZUF0dHI6IGZ1bmN0aW9uIHJlbW92ZUF0dHIoZSkgewogICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHZhciBuLAogICAgICAgICAgICAgIHIgPSAwLAogICAgICAgICAgICAgIG8gPSBlICYmIGUubWF0Y2goL1teXHgyMFx0XHJcblxmXCpcL1xcXSsvZyk7CiAgICAgICAgICBpZiAobyAmJiAxID09PSB0Lm5vZGVUeXBlKSBmb3IgKDsgbiA9IG9bcisrXTspIHsKICAgICAgICAgICAgdC5yZW1vdmVBdHRyaWJ1dGUobik7CiAgICAgICAgICB9CiAgICAgICAgfSksIHRoaXM7CiAgICAgIH0sCiAgICAgIGhhc0NsYXNzOiBmdW5jdGlvbiBoYXNDbGFzcyhlKSB7CiAgICAgICAgcmV0dXJuICEhdGhpc1swXSAmJiBuZXcgUmVnRXhwKCIoXFxzfF4pIiArIGUgKyAiKFxcc3wkKSIpLnRlc3QodGhpc1swXS5nZXRBdHRyaWJ1dGUoImNsYXNzIikpOwogICAgICB9LAogICAgICBhZGRDbGFzczogZnVuY3Rpb24gYWRkQ2xhc3MoZSkgewogICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHZhciBuID0gKDAsIGxbImRlZmF1bHQiXSkodCksCiAgICAgICAgICAgICAgciA9IG4uYXR0cigiY2xhc3MiKTsKICAgICAgICAgIG4uaGFzQ2xhc3MoZSkgfHwgbi5hdHRyKCJjbGFzcyIsIHIgKz0gIiAiICsgZSk7CiAgICAgICAgfSksIHRoaXM7CiAgICAgIH0sCiAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbiByZW1vdmVDbGFzcyhlKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgdmFyIG4gPSAoMCwgbFsiZGVmYXVsdCJdKSh0KSwKICAgICAgICAgICAgICByID0gbi5hdHRyKCJjbGFzcyIpOwoKICAgICAgICAgIGlmIChuLmhhc0NsYXNzKGUpKSB7CiAgICAgICAgICAgIHZhciBvID0gbmV3IFJlZ0V4cCgiKFxcc3xeKSIgKyBlICsgIihcXHN8JCkiKTsKICAgICAgICAgICAgbi5hdHRyKCJjbGFzcyIsIHIucmVwbGFjZShvLCAiIikpOwogICAgICAgICAgfQogICAgICAgIH0pLCB0aGlzOwogICAgICB9CiAgICB9KSwgKDAsIGFbImRlZmF1bHQiXSkobFsiZGVmYXVsdCJdLCB7CiAgICAgIGV4dGVuZDogYVsiZGVmYXVsdCJdLAogICAgICBub29wOiBmdW5jdGlvbiBub29wKCkge30sCiAgICAgIG5hdmk6IGgsCiAgICAgIHVhOiBoLnVzZXJBZ2VudCwKICAgICAgbGFuZzogaC5sYW5ndWFnZSB8fCBoLmxhbmd1YWdlc1swXSwKICAgICAgZGV0ZWN0OiB1WyJkZWZhdWx0Il0sCiAgICAgIHN0b3JlOiBwWyJkZWZhdWx0Il0sCiAgICAgIGVzY2FwZTogZnVuY3Rpb24gZXNjYXBlKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiBnLnRlc3QoZSkgPyBlLnJlcGxhY2UodiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBiW2VdOwogICAgICAgIH0pIDogZTsKICAgICAgfSwKICAgICAgdW5lc2NhcGU6IGZ1bmN0aW9uIHVuZXNjYXBlKGUpIHsKICAgICAgICByZXR1cm4gZSAmJiB5LnRlc3QoZSkgPyBlLnJlcGxhY2UobSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiB3W2VdOwogICAgICAgIH0pIDogZTsKICAgICAgfSwKICAgICAgZHluYW1pY0xvYWRTb3VyY2U6IGZ1bmN0aW9uIGR5bmFtaWNMb2FkU291cmNlKGUsIHQpIHsKICAgICAgICBpZiAoKDAsIGxbImRlZmF1bHQiXSkoJ3NjcmlwdFtzcmM9IicgKyBlICsgJyJdJykubGVuZ3RoKSB0ICYmIHQoKTtlbHNlIHsKICAgICAgICAgIHZhciBuID0gZi5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKICAgICAgICAgIG4ub25sb2FkID0gbi5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBlID0gdGhpczsKICAgICAgICAgICAgZS5vbmxvYWQgPSBlLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGwsIHQgJiYgdCgpLCAoMCwgbFsiZGVmYXVsdCJdKShuKS5yZW1vdmUoKTsKICAgICAgICAgIH0sIG4uYXN5bmMgPSAhMCwgbi5zZXRBdHRyaWJ1dGUoInJlZmVycmVyUG9saWN5IiwgIm5vLXJlZmVycmVyIik7CiAgICAgICAgICAoMCwgbFsiZGVmYXVsdCJdKSgiaGVhZCIpWzBdLmFwcGVuZENoaWxkKG4pLCBuLnNyYyA9IGU7CiAgICAgICAgfQogICAgICB9LAogICAgICBzZGtMb2FkZXI6IGZ1bmN0aW9uIHNka0xvYWRlcihlLCB0LCBuKSB7CiAgICAgICAgdCBpbiB3aW5kb3cgJiYgd2luZG93W3RdID8gKGsgJiYgY2xlYXJUaW1lb3V0KGspLCBuICYmIG4oKSkgOiBsWyJkZWZhdWx0Il0uZHluYW1pY0xvYWRTb3VyY2UoZSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgayA9IHNldFRpbWVvdXQobFsiZGVmYXVsdCJdLnNka0xvYWRlcihlLCB0LCBuKSwgMTAwKTsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgZGVsZXRlSW5XaW46IGZ1bmN0aW9uIGRlbGV0ZUluV2luKGUsIHQpIHsKICAgICAgICB2YXIgbiA9IGZ1bmN0aW9uIG4odCkgewogICAgICAgICAgaWYgKGUgaW4gd2luZG93KSB0cnkgewogICAgICAgICAgICBkZWxldGUgd2luZG93W2VdOwogICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICB3aW5kb3dbZV0gPSBudWxsOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIDAgPT09IHQgPyBuKCkgOiBzZXRUaW1lb3V0KG4sIHQgfHwgNTAwKTsKICAgICAgfSwKICAgICAgYWpheDogZnVuY3Rpb24gYWpheChlKSB7CiAgICAgICAgZSA9IGUgfHwge30sIGUudHlwZSA9IChlLnR5cGUgfHwgIkdFVCIpLnRvVXBwZXJDYXNlKCksIGUuZGF0YVR5cGUgPSBlLmRhdGFUeXBlIHx8ICJqc29uIiwgZS5hc3luYyA9IGUuYXN5bmMgfHwgITAsIGUudGltZW91dCA9IGUudGltZW91dCB8fCA4ZTM7CiAgICAgICAgdmFyIHQgPSAiW29iamVjdCBGb3JtRGF0YV0iID09IHt9LnRvU3RyaW5nLmNhbGwoZS5kYXRhKSA/IGUuZGF0YSA6IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB2YXIgdCA9IFtdOwoKICAgICAgICAgIGZvciAodmFyIG4gaW4gZSkgewogICAgICAgICAgICB0LnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KG4pICsgIj0iICsgZW5jb2RlVVJJQ29tcG9uZW50KGVbbl0pKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdC5wdXNoKCJ0PSIgKyBEYXRlLm5vdygpKSwgdC5qb2luKCImIik7CiAgICAgICAgfShlLmRhdGEpLAogICAgICAgICAgICBuID0gbnVsbCwKICAgICAgICAgICAgciA9ICJYTUxIdHRwUmVxdWVzdCIgaW4gd2luZG93ID8gbmV3IFhNTEh0dHBSZXF1ZXN0KCkgOiBuZXcgQWN0aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKTsKICAgICAgICByLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICBpZiAoNCA9PSByLnJlYWR5U3RhdGUpIHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KG4pOwogICAgICAgICAgICB2YXIgbyA9IHIuc3RhdHVzOwogICAgICAgICAgICBvID49IDIwMCAmJiBvIDwgMzAwID8gZS5zdWNjZXNzICYmIGUuc3VjY2VzcyhKU09OLnBhcnNlKHIucmVzcG9uc2VUZXh0KSkgOiBlLmZhaWwgJiYgZS5mYWlsKG8pOwogICAgICAgICAgfQogICAgICAgIH0sICJHRVQiID09IGUudHlwZSA/IChyLm9wZW4oIkdFVCIsIGUudXJsICsgIj8iICsgdCwgZS5hc3luYyksIHIuc2VuZChudWxsKSkgOiAiUE9TVCIgPT0gZS50eXBlICYmIChyLm9wZW4oIlBPU1QiLCBlLnVybCwgZS5hc3luYyksIHZvaWQgMCA9PSBlLmNvbnRlbnRUeXBlIHx8IG51bGwgPT0gZS5jb250ZW50VHlwZSA/IHIuc2VuZCh0KSA6IChyLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsIGUuY29udGVudFR5cGUpLCByLnNlbmQoSlNPTi5zdHJpbmdpZnkoZS5kYXRhKSkpKSwgbiA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGNsZWFyVGltZW91dChuKSwgci5hYm9ydCgpOwogICAgICAgIH0sIGUudGltZW91dCk7CiAgICAgIH0KICAgIH0pLCB0WyJkZWZhdWx0Il0gPSBsWyJkZWZhdWx0Il07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IFR5cGVFcnJvciwKICAgICAgICBvID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKICAgIGlmIChvKSB0cnkgewogICAgICBvKHt9LCAiIik7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIG8gPSBudWxsOwogICAgfQoKICAgIHZhciBpLAogICAgICAgIGEsCiAgICAgICAgcyA9IGZ1bmN0aW9uIHMoKSB7CiAgICAgIHRocm93IG5ldyByKCk7CiAgICB9LAogICAgICAgIGwgPSBvID8gZnVuY3Rpb24gKCkgewogICAgICB0cnkgewogICAgICAgIHJldHVybiBhcmd1bWVudHMuY2FsbGVlLCBzOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBvKGFyZ3VtZW50cywgImNhbGxlZSIpLmdldDsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICByZXR1cm4gczsKICAgICAgICB9CiAgICAgIH0KICAgIH0oKSA6IHMsCiAgICAgICAgYyA9IG4oNDcpKCksCiAgICAgICAgdSA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZS5fX3Byb3RvX187CiAgICB9LAogICAgICAgIGQgPSBpID8gdShpKSA6IHZvaWQgMCwKICAgICAgICBwID0gYSA/IHUoYSkgOiB2b2lkIDAsCiAgICAgICAgZiA9IGEgPyBhKCkgOiB2b2lkIDAsCiAgICAgICAgaCA9ICJ1bmRlZmluZWQiID09IHR5cGVvZiBVaW50OEFycmF5ID8gdm9pZCAwIDogdShVaW50OEFycmF5KSwKICAgICAgICB2ID0gewogICAgICAiJUFycmF5JSI6IEFycmF5LAogICAgICAiJUFycmF5QnVmZmVyJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBBcnJheUJ1ZmZlciA/IHZvaWQgMCA6IEFycmF5QnVmZmVyLAogICAgICAiJUFycmF5QnVmZmVyUHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBBcnJheUJ1ZmZlciA/IHZvaWQgMCA6IEFycmF5QnVmZmVyLnByb3RvdHlwZSwKICAgICAgIiVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJSI6IGMgPyB1KFtdW1N5bWJvbC5pdGVyYXRvcl0oKSkgOiB2b2lkIDAsCiAgICAgICIlQXJyYXlQcm90b3R5cGUlIjogQXJyYXkucHJvdG90eXBlLAogICAgICAiJUFycmF5UHJvdG9fZW50cmllcyUiOiBBcnJheS5wcm90b3R5cGUuZW50cmllcywKICAgICAgIiVBcnJheVByb3RvX2ZvckVhY2glIjogQXJyYXkucHJvdG90eXBlLmZvckVhY2gsCiAgICAgICIlQXJyYXlQcm90b19rZXlzJSI6IEFycmF5LnByb3RvdHlwZS5rZXlzLAogICAgICAiJUFycmF5UHJvdG9fdmFsdWVzJSI6IEFycmF5LnByb3RvdHlwZS52YWx1ZXMsCiAgICAgICIlQXN5bmNGcm9tU3luY0l0ZXJhdG9yUHJvdG90eXBlJSI6IHZvaWQgMCwKICAgICAgIiVBc3luY0Z1bmN0aW9uJSI6IHZvaWQgMCwKICAgICAgIiVBc3luY0Z1bmN0aW9uUHJvdG90eXBlJSI6IHZvaWQgMCwKICAgICAgIiVBc3luY0dlbmVyYXRvciUiOiBhID8gdShmKSA6IHZvaWQgMCwKICAgICAgIiVBc3luY0dlbmVyYXRvckZ1bmN0aW9uJSI6IHAsCiAgICAgICIlQXN5bmNHZW5lcmF0b3JQcm90b3R5cGUlIjogcCA/IHAucHJvdG90eXBlIDogdm9pZCAwLAogICAgICAiJUFzeW5jSXRlcmF0b3JQcm90b3R5cGUlIjogZiAmJiBjICYmIFN5bWJvbC5hc3luY0l0ZXJhdG9yID8gZltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSA6IHZvaWQgMCwKICAgICAgIiVBdG9taWNzJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBBdG9taWNzID8gdm9pZCAwIDogQXRvbWljcywKICAgICAgIiVCb29sZWFuJSI6IEJvb2xlYW4sCiAgICAgICIlQm9vbGVhblByb3RvdHlwZSUiOiBCb29sZWFuLnByb3RvdHlwZSwKICAgICAgIiVEYXRhVmlldyUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgRGF0YVZpZXcgPyB2b2lkIDAgOiBEYXRhVmlldywKICAgICAgIiVEYXRhVmlld1Byb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgRGF0YVZpZXcgPyB2b2lkIDAgOiBEYXRhVmlldy5wcm90b3R5cGUsCiAgICAgICIlRGF0ZSUiOiBEYXRlLAogICAgICAiJURhdGVQcm90b3R5cGUlIjogRGF0ZS5wcm90b3R5cGUsCiAgICAgICIlZGVjb2RlVVJJJSI6IGRlY29kZVVSSSwKICAgICAgIiVkZWNvZGVVUklDb21wb25lbnQlIjogZGVjb2RlVVJJQ29tcG9uZW50LAogICAgICAiJWVuY29kZVVSSSUiOiBlbmNvZGVVUkksCiAgICAgICIlZW5jb2RlVVJJQ29tcG9uZW50JSI6IGVuY29kZVVSSUNvbXBvbmVudCwKICAgICAgIiVFcnJvciUiOiBFcnJvciwKICAgICAgIiVFcnJvclByb3RvdHlwZSUiOiBFcnJvci5wcm90b3R5cGUsCiAgICAgICIlZXZhbCUiOiBldmFsLAogICAgICAiJUV2YWxFcnJvciUiOiBFdmFsRXJyb3IsCiAgICAgICIlRXZhbEVycm9yUHJvdG90eXBlJSI6IEV2YWxFcnJvci5wcm90b3R5cGUsCiAgICAgICIlRmxvYXQzMkFycmF5JSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBGbG9hdDMyQXJyYXkgPyB2b2lkIDAgOiBGbG9hdDMyQXJyYXksCiAgICAgICIlRmxvYXQzMkFycmF5UHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBGbG9hdDMyQXJyYXkgPyB2b2lkIDAgOiBGbG9hdDMyQXJyYXkucHJvdG90eXBlLAogICAgICAiJUZsb2F0NjRBcnJheSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgRmxvYXQ2NEFycmF5ID8gdm9pZCAwIDogRmxvYXQ2NEFycmF5LAogICAgICAiJUZsb2F0NjRBcnJheVByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgRmxvYXQ2NEFycmF5ID8gdm9pZCAwIDogRmxvYXQ2NEFycmF5LnByb3RvdHlwZSwKICAgICAgIiVGdW5jdGlvbiUiOiBGdW5jdGlvbiwKICAgICAgIiVGdW5jdGlvblByb3RvdHlwZSUiOiBGdW5jdGlvbi5wcm90b3R5cGUsCiAgICAgICIlR2VuZXJhdG9yJSI6IGkgPyB1KGkoKSkgOiB2b2lkIDAsCiAgICAgICIlR2VuZXJhdG9yRnVuY3Rpb24lIjogZCwKICAgICAgIiVHZW5lcmF0b3JQcm90b3R5cGUlIjogZCA/IGQucHJvdG90eXBlIDogdm9pZCAwLAogICAgICAiJUludDhBcnJheSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgSW50OEFycmF5ID8gdm9pZCAwIDogSW50OEFycmF5LAogICAgICAiJUludDhBcnJheVByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgSW50OEFycmF5ID8gdm9pZCAwIDogSW50OEFycmF5LnByb3RvdHlwZSwKICAgICAgIiVJbnQxNkFycmF5JSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBJbnQxNkFycmF5ID8gdm9pZCAwIDogSW50MTZBcnJheSwKICAgICAgIiVJbnQxNkFycmF5UHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBJbnQxNkFycmF5ID8gdm9pZCAwIDogSW50OEFycmF5LnByb3RvdHlwZSwKICAgICAgIiVJbnQzMkFycmF5JSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBJbnQzMkFycmF5ID8gdm9pZCAwIDogSW50MzJBcnJheSwKICAgICAgIiVJbnQzMkFycmF5UHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBJbnQzMkFycmF5ID8gdm9pZCAwIDogSW50MzJBcnJheS5wcm90b3R5cGUsCiAgICAgICIlaXNGaW5pdGUlIjogaXNGaW5pdGUsCiAgICAgICIlaXNOYU4lIjogaXNOYU4sCiAgICAgICIlSXRlcmF0b3JQcm90b3R5cGUlIjogYyA/IHUodShbXVtTeW1ib2wuaXRlcmF0b3JdKCkpKSA6IHZvaWQgMCwKICAgICAgIiVKU09OJSI6ICJvYmplY3QiID09ICh0eXBlb2YgSlNPTiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoSlNPTikpID8gSlNPTiA6IHZvaWQgMCwKICAgICAgIiVKU09OUGFyc2UlIjogIm9iamVjdCIgPT0gKHR5cGVvZiBKU09OID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihKU09OKSkgPyBKU09OLnBhcnNlIDogdm9pZCAwLAogICAgICAiJU1hcCUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgTWFwID8gdm9pZCAwIDogTWFwLAogICAgICAiJU1hcEl0ZXJhdG9yUHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBNYXAgJiYgYyA/IHUobmV3IE1hcCgpW1N5bWJvbC5pdGVyYXRvcl0oKSkgOiB2b2lkIDAsCiAgICAgICIlTWFwUHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBNYXAgPyB2b2lkIDAgOiBNYXAucHJvdG90eXBlLAogICAgICAiJU1hdGglIjogTWF0aCwKICAgICAgIiVOdW1iZXIlIjogTnVtYmVyLAogICAgICAiJU51bWJlclByb3RvdHlwZSUiOiBOdW1iZXIucHJvdG90eXBlLAogICAgICAiJU9iamVjdCUiOiBPYmplY3QsCiAgICAgICIlT2JqZWN0UHJvdG90eXBlJSI6IE9iamVjdC5wcm90b3R5cGUsCiAgICAgICIlT2JqUHJvdG9fdG9TdHJpbmclIjogT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZywKICAgICAgIiVPYmpQcm90b192YWx1ZU9mJSI6IE9iamVjdC5wcm90b3R5cGUudmFsdWVPZiwKICAgICAgIiVwYXJzZUZsb2F0JSI6IHBhcnNlRmxvYXQsCiAgICAgICIlcGFyc2VJbnQlIjogcGFyc2VJbnQsCiAgICAgICIlUHJvbWlzZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgUHJvbWlzZSA/IHZvaWQgMCA6IFByb21pc2UsCiAgICAgICIlUHJvbWlzZVByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgUHJvbWlzZSA/IHZvaWQgMCA6IFByb21pc2UucHJvdG90eXBlLAogICAgICAiJVByb21pc2VQcm90b190aGVuJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBQcm9taXNlID8gdm9pZCAwIDogUHJvbWlzZS5wcm90b3R5cGUudGhlbiwKICAgICAgIiVQcm9taXNlX2FsbCUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgUHJvbWlzZSA/IHZvaWQgMCA6IFByb21pc2UuYWxsLAogICAgICAiJVByb21pc2VfcmVqZWN0JSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBQcm9taXNlID8gdm9pZCAwIDogUHJvbWlzZS5yZWplY3QsCiAgICAgICIlUHJvbWlzZV9yZXNvbHZlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBQcm9taXNlID8gdm9pZCAwIDogUHJvbWlzZS5yZXNvbHZlLAogICAgICAiJVByb3h5JSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBQcm94eSA/IHZvaWQgMCA6IFByb3h5LAogICAgICAiJVJhbmdlRXJyb3IlIjogUmFuZ2VFcnJvciwKICAgICAgIiVSYW5nZUVycm9yUHJvdG90eXBlJSI6IFJhbmdlRXJyb3IucHJvdG90eXBlLAogICAgICAiJVJlZmVyZW5jZUVycm9yJSI6IFJlZmVyZW5jZUVycm9yLAogICAgICAiJVJlZmVyZW5jZUVycm9yUHJvdG90eXBlJSI6IFJlZmVyZW5jZUVycm9yLnByb3RvdHlwZSwKICAgICAgIiVSZWZsZWN0JSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBSZWZsZWN0ID8gdm9pZCAwIDogUmVmbGVjdCwKICAgICAgIiVSZWdFeHAlIjogUmVnRXhwLAogICAgICAiJVJlZ0V4cFByb3RvdHlwZSUiOiBSZWdFeHAucHJvdG90eXBlLAogICAgICAiJVNldCUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgU2V0ID8gdm9pZCAwIDogU2V0LAogICAgICAiJVNldEl0ZXJhdG9yUHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBTZXQgJiYgYyA/IHUobmV3IFNldCgpW1N5bWJvbC5pdGVyYXRvcl0oKSkgOiB2b2lkIDAsCiAgICAgICIlU2V0UHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBTZXQgPyB2b2lkIDAgOiBTZXQucHJvdG90eXBlLAogICAgICAiJVNoYXJlZEFycmF5QnVmZmVyJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBTaGFyZWRBcnJheUJ1ZmZlciA/IHZvaWQgMCA6IFNoYXJlZEFycmF5QnVmZmVyLAogICAgICAiJVNoYXJlZEFycmF5QnVmZmVyUHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBTaGFyZWRBcnJheUJ1ZmZlciA/IHZvaWQgMCA6IFNoYXJlZEFycmF5QnVmZmVyLnByb3RvdHlwZSwKICAgICAgIiVTdHJpbmclIjogU3RyaW5nLAogICAgICAiJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJSI6IGMgPyB1KCIiW1N5bWJvbC5pdGVyYXRvcl0oKSkgOiB2b2lkIDAsCiAgICAgICIlU3RyaW5nUHJvdG90eXBlJSI6IFN0cmluZy5wcm90b3R5cGUsCiAgICAgICIlU3ltYm9sJSI6IGMgPyBTeW1ib2wgOiB2b2lkIDAsCiAgICAgICIlU3ltYm9sUHJvdG90eXBlJSI6IGMgPyBTeW1ib2wucHJvdG90eXBlIDogdm9pZCAwLAogICAgICAiJVN5bnRheEVycm9yJSI6IFN5bnRheEVycm9yLAogICAgICAiJVN5bnRheEVycm9yUHJvdG90eXBlJSI6IFN5bnRheEVycm9yLnByb3RvdHlwZSwKICAgICAgIiVUaHJvd1R5cGVFcnJvciUiOiBsLAogICAgICAiJVR5cGVkQXJyYXklIjogaCwKICAgICAgIiVUeXBlZEFycmF5UHJvdG90eXBlJSI6IGggPyBoLnByb3RvdHlwZSA6IHZvaWQgMCwKICAgICAgIiVUeXBlRXJyb3IlIjogciwKICAgICAgIiVUeXBlRXJyb3JQcm90b3R5cGUlIjogci5wcm90b3R5cGUsCiAgICAgICIlVWludDhBcnJheSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgVWludDhBcnJheSA/IHZvaWQgMCA6IFVpbnQ4QXJyYXksCiAgICAgICIlVWludDhBcnJheVByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgVWludDhBcnJheSA/IHZvaWQgMCA6IFVpbnQ4QXJyYXkucHJvdG90eXBlLAogICAgICAiJVVpbnQ4Q2xhbXBlZEFycmF5JSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBVaW50OENsYW1wZWRBcnJheSA/IHZvaWQgMCA6IFVpbnQ4Q2xhbXBlZEFycmF5LAogICAgICAiJVVpbnQ4Q2xhbXBlZEFycmF5UHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBVaW50OENsYW1wZWRBcnJheSA/IHZvaWQgMCA6IFVpbnQ4Q2xhbXBlZEFycmF5LnByb3RvdHlwZSwKICAgICAgIiVVaW50MTZBcnJheSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgVWludDE2QXJyYXkgPyB2b2lkIDAgOiBVaW50MTZBcnJheSwKICAgICAgIiVVaW50MTZBcnJheVByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgVWludDE2QXJyYXkgPyB2b2lkIDAgOiBVaW50MTZBcnJheS5wcm90b3R5cGUsCiAgICAgICIlVWludDMyQXJyYXklIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFVpbnQzMkFycmF5ID8gdm9pZCAwIDogVWludDMyQXJyYXksCiAgICAgICIlVWludDMyQXJyYXlQcm90b3R5cGUlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFVpbnQzMkFycmF5ID8gdm9pZCAwIDogVWludDMyQXJyYXkucHJvdG90eXBlLAogICAgICAiJVVSSUVycm9yJSI6IFVSSUVycm9yLAogICAgICAiJVVSSUVycm9yUHJvdG90eXBlJSI6IFVSSUVycm9yLnByb3RvdHlwZSwKICAgICAgIiVXZWFrTWFwJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBXZWFrTWFwID8gdm9pZCAwIDogV2Vha01hcCwKICAgICAgIiVXZWFrTWFwUHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBXZWFrTWFwID8gdm9pZCAwIDogV2Vha01hcC5wcm90b3R5cGUsCiAgICAgICIlV2Vha1NldCUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgV2Vha1NldCA/IHZvaWQgMCA6IFdlYWtTZXQsCiAgICAgICIlV2Vha1NldFByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgV2Vha1NldCA/IHZvaWQgMCA6IFdlYWtTZXQucHJvdG90eXBlCiAgICB9LAogICAgICAgIGcgPSBuKDQpLAogICAgICAgIG0gPSBnLmNhbGwoRnVuY3Rpb24uY2FsbCwgU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlKSwKICAgICAgICB5ID0gL1teJS5bXF1dK3xcWyg/OigtP1xkKyg/OlwuXGQrKT8pfChbIiddKSgoPzooPyFcMilbXlxcXXxcXC4pKj8pXDIpXF18KD89KD86XC58XFtcXSkoPzpcLnxcW1xdfCUkKSkvZywKICAgICAgICBiID0gL1xcKFxcKT8vZywKICAgICAgICB3ID0gZnVuY3Rpb24gdyhlKSB7CiAgICAgIHZhciB0ID0gW107CiAgICAgIHJldHVybiBtKGUsIHksIGZ1bmN0aW9uIChlLCBuLCByLCBvKSB7CiAgICAgICAgdFt0Lmxlbmd0aF0gPSByID8gbShvLCBiLCAiJDEiKSA6IG4gfHwgZTsKICAgICAgfSksIHQ7CiAgICB9LAogICAgICAgIHggPSBmdW5jdGlvbiB4KGUsIHQpIHsKICAgICAgaWYgKCEoZSBpbiB2KSkgdGhyb3cgbmV3IFN5bnRheEVycm9yKCJpbnRyaW5zaWMgIiArIGUgKyAiIGRvZXMgbm90IGV4aXN0ISIpOwogICAgICBpZiAodm9pZCAwID09PSB2W2VdICYmICF0KSB0aHJvdyBuZXcgcigiaW50cmluc2ljICIgKyBlICsgIiBleGlzdHMsIGJ1dCBpcyBub3QgYXZhaWxhYmxlLiBQbGVhc2UgZmlsZSBhbiBpc3N1ZSEiKTsKICAgICAgcmV0dXJuIHZbZV07CiAgICB9OwoKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgZSB8fCAwID09PSBlLmxlbmd0aCkgdGhyb3cgbmV3IFR5cGVFcnJvcigiaW50cmluc2ljIG5hbWUgbXVzdCBiZSBhIG5vbi1lbXB0eSBzdHJpbmciKTsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmICJib29sZWFuIiAhPSB0eXBlb2YgdCkgdGhyb3cgbmV3IFR5cGVFcnJvcignImFsbG93TWlzc2luZyIgYXJndW1lbnQgbXVzdCBiZSBhIGJvb2xlYW4nKTsKCiAgICAgIGZvciAodmFyIG4gPSB3KGUpLCBpID0geCgiJSIgKyAobi5sZW5ndGggPiAwID8gblswXSA6ICIiKSArICIlIiwgdCksIGEgPSAxOyBhIDwgbi5sZW5ndGg7IGEgKz0gMSkgewogICAgICAgIGlmIChudWxsICE9IGkpIGlmIChvICYmIGEgKyAxID49IG4ubGVuZ3RoKSB7CiAgICAgICAgICB2YXIgcyA9IG8oaSwgblthXSk7CiAgICAgICAgICBpZiAoISh0IHx8IG5bYV0gaW4gaSkpIHRocm93IG5ldyByKCJiYXNlIGludHJpbnNpYyBmb3IgIiArIGUgKyAiIGV4aXN0cywgYnV0IHRoZSBwcm9wZXJ0eSBpcyBub3QgYXZhaWxhYmxlLiIpOwogICAgICAgICAgaSA9IHMgPyBzLmdldCB8fCBzLnZhbHVlIDogaVtuW2FdXTsKICAgICAgICB9IGVsc2UgaSA9IGlbblthXV07CiAgICAgIH0KCiAgICAgIHJldHVybiBpOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHQuX19lc01vZHVsZSA9ICEwOwogICAgdC5ERUZBVUxUX0VNT0pJX0NETiA9ICIvL2ltZy50LnNpbmFqcy5jbi90NC9hcHBzdHlsZS9leHByZXNzaW9uL2V4dC9ub3JtYWwvIiwgdC5EQl9OQU1FID0gIkNvbW1lbnQiLCB0LmRlZmF1bHRDb25maWcgPSB7CiAgICAgIGxhbmc6ICJ6aC1DTiIsCiAgICAgIGxhbmdNb2RlOiBudWxsLAogICAgICBhcHBJZDogIiIsCiAgICAgIGFwcEtleTogIiIsCiAgICAgIGNsYXp6TmFtZTogIkNvbW1lbnQiLAogICAgICBtZXRhOiBbIm5pY2siLCAibWFpbCIsICJsaW5rIl0sCiAgICAgIHBhdGg6IGxvY2F0aW9uLnBhdGhuYW1lLAogICAgICBwbGFjZWhvbGRlcjogIkp1c3QgR28gR28iLAogICAgICBwYWdlU2l6ZTogMTAsCiAgICAgIHJlY29yZElQOiAhMCwKICAgICAgc2VydmVyVVJMczogIiIsCiAgICAgIHZpc2l0b3I6ICExLAogICAgICBlbW9qaUNETjogIiIsCiAgICAgIGVtb2ppTWFwczogdm9pZCAwLAogICAgICBlbmFibGVRUTogITEsCiAgICAgIHJlcXVpcmVkRmllbGRzOiBbXQogICAgfSwgdC5kZWZhdWx0TWV0YSA9IFsibmljayIsICJtYWlsIiwgImxpbmsiXSwgdC5RUUNhY2hlS2V5ID0gIl92X0NhY2hlX1EiLCB0Lk1ldGFDYWNoZUtleSA9ICJfdl9DYWNoZV9NZXRhIiwgdC5SYW5kb21TdHIgPSAoRGF0ZS5ub3coKSArIE1hdGgucm91bmQoMWUzICogTWF0aC5yYW5kb20oKSkpLnRvU3RyaW5nKDMyKSwgdC5WRVJTSU9OID0gIjEuNC4xNCI7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIGZ1bmN0aW9uIHIoZSwgdCkgewogICAgICByZXR1cm4gbmV3IGkodCkucHJvY2VzcyhlKTsKICAgIH0KCiAgICB2YXIgbyA9IG4oNyksCiAgICAgICAgaSA9IG4oMjkpOwogICAgdCA9IGUuZXhwb3J0cyA9IHIsIHQuRmlsdGVyQ1NTID0gaTsKCiAgICBmb3IgKHZhciBhIGluIG8pIHsKICAgICAgdFthXSA9IG9bYV07CiAgICB9CgogICAgInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdyAmJiAod2luZG93LmZpbHRlckNTUyA9IGUuZXhwb3J0cyk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oMzIpOwogICAgZS5leHBvcnRzID0gRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgfHwgcjsKICB9LCBmdW5jdGlvbiAoZSwgdCkgewogICAgZS5leHBvcnRzID0gewogICAgICBpbmRleE9mOiBmdW5jdGlvbiBpbmRleE9mKGUsIHQpIHsKICAgICAgICB2YXIgbiwgcjsKICAgICAgICBpZiAoQXJyYXkucHJvdG90eXBlLmluZGV4T2YpIHJldHVybiBlLmluZGV4T2YodCk7CgogICAgICAgIGZvciAobiA9IDAsIHIgPSBlLmxlbmd0aDsgbiA8IHI7IG4rKykgewogICAgICAgICAgaWYgKGVbbl0gPT09IHQpIHJldHVybiBuOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9LAogICAgICBmb3JFYWNoOiBmdW5jdGlvbiBmb3JFYWNoKGUsIHQsIG4pIHsKICAgICAgICB2YXIgciwgbzsKICAgICAgICBpZiAoQXJyYXkucHJvdG90eXBlLmZvckVhY2gpIHJldHVybiBlLmZvckVhY2godCwgbik7CgogICAgICAgIGZvciAociA9IDAsIG8gPSBlLmxlbmd0aDsgciA8IG87IHIrKykgewogICAgICAgICAgdC5jYWxsKG4sIGVbcl0sIHIsIGUpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdHJpbTogZnVuY3Rpb24gdHJpbShlKSB7CiAgICAgICAgcmV0dXJuIFN0cmluZy5wcm90b3R5cGUudHJpbSA/IGUudHJpbSgpIDogZS5yZXBsYWNlKC8oXlxzKil8KFxzKiQpL2csICIiKTsKICAgICAgfSwKICAgICAgc3BhY2VJbmRleDogZnVuY3Rpb24gc3BhY2VJbmRleChlKSB7CiAgICAgICAgdmFyIHQgPSAvXHN8XG58XHQvLAogICAgICAgICAgICBuID0gdC5leGVjKGUpOwogICAgICAgIHJldHVybiBuID8gbi5pbmRleCA6IC0xOwogICAgICB9CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdC5fX2VzTW9kdWxlID0gITA7CiAgICB2YXIgciA9IG4oMiksCiAgICAgICAgbyA9IHsKICAgICAgY2RuOiByLkRFRkFVTFRfRU1PSklfQ0ROLAogICAgICBtYXBzOiBuKDUzKSwKICAgICAgcGFyc2U6IGZ1bmN0aW9uIHBhcnNlKGUpIHsKICAgICAgICByZXR1cm4gU3RyaW5nKGUpLnJlcGxhY2UobmV3IFJlZ0V4cCgiOigiICsgT2JqZWN0LmtleXMoby5tYXBzKS5qb2luKCJ8IikgKyAiKToiLCAiaWciKSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIHJldHVybiBvLm1hcHNbdF0gPyBvLmJ1aWxkKHQpIDogZTsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgYnVpbGQ6IGZ1bmN0aW9uIGJ1aWxkKGUpIHsKICAgICAgICB2YXIgdCA9IC9eKGh0dHBzPzopP1wvXC8vaSwKICAgICAgICAgICAgbiA9IG8ubWFwc1tlXSwKICAgICAgICAgICAgciA9IHQudGVzdChuKSA/IG4gOiBvLmNkbiArIG47CiAgICAgICAgcmV0dXJuIHQudGVzdChyKSA/ICc8aW1nIGFsdD0iJyArIGUgKyAnIiByZWZlcnJlclBvbGljeT0ibm8tcmVmZXJyZXIiIGNsYXNzPSJ2ZW1vamkiIHNyYz0iJyArIHIgKyAnIiAvPicgOiAiIjsKICAgICAgfQogICAgfTsKICAgIHRbImRlZmF1bHQiXSA9IG87CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGZ1bmN0aW9uIG4oKSB7CiAgICAgIHZhciBlID0ge307CiAgICAgIHJldHVybiBlWyJhbGlnbi1jb250ZW50Il0gPSAhMSwgZVsiYWxpZ24taXRlbXMiXSA9ICExLCBlWyJhbGlnbi1zZWxmIl0gPSAhMSwgZVsiYWxpZ25tZW50LWFkanVzdCJdID0gITEsIGVbImFsaWdubWVudC1iYXNlbGluZSJdID0gITEsIGUuYWxsID0gITEsIGVbImFuY2hvci1wb2ludCJdID0gITEsIGUuYW5pbWF0aW9uID0gITEsIGVbImFuaW1hdGlvbi1kZWxheSJdID0gITEsIGVbImFuaW1hdGlvbi1kaXJlY3Rpb24iXSA9ICExLCBlWyJhbmltYXRpb24tZHVyYXRpb24iXSA9ICExLCBlWyJhbmltYXRpb24tZmlsbC1tb2RlIl0gPSAhMSwgZVsiYW5pbWF0aW9uLWl0ZXJhdGlvbi1jb3VudCJdID0gITEsIGVbImFuaW1hdGlvbi1uYW1lIl0gPSAhMSwgZVsiYW5pbWF0aW9uLXBsYXktc3RhdGUiXSA9ICExLCBlWyJhbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uIl0gPSAhMSwgZS5hemltdXRoID0gITEsIGVbImJhY2tmYWNlLXZpc2liaWxpdHkiXSA9ICExLCBlLmJhY2tncm91bmQgPSAhMCwgZVsiYmFja2dyb3VuZC1hdHRhY2htZW50Il0gPSAhMCwgZVsiYmFja2dyb3VuZC1jbGlwIl0gPSAhMCwgZVsiYmFja2dyb3VuZC1jb2xvciJdID0gITAsIGVbImJhY2tncm91bmQtaW1hZ2UiXSA9ICEwLCBlWyJiYWNrZ3JvdW5kLW9yaWdpbiJdID0gITAsIGVbImJhY2tncm91bmQtcG9zaXRpb24iXSA9ICEwLCBlWyJiYWNrZ3JvdW5kLXJlcGVhdCJdID0gITAsIGVbImJhY2tncm91bmQtc2l6ZSJdID0gITAsIGVbImJhc2VsaW5lLXNoaWZ0Il0gPSAhMSwgZS5iaW5kaW5nID0gITEsIGUuYmxlZWQgPSAhMSwgZVsiYm9va21hcmstbGFiZWwiXSA9ICExLCBlWyJib29rbWFyay1sZXZlbCJdID0gITEsIGVbImJvb2ttYXJrLXN0YXRlIl0gPSAhMSwgZS5ib3JkZXIgPSAhMCwgZVsiYm9yZGVyLWJvdHRvbSJdID0gITAsIGVbImJvcmRlci1ib3R0b20tY29sb3IiXSA9ICEwLCBlWyJib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzIl0gPSAhMCwgZVsiYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXMiXSA9ICEwLCBlWyJib3JkZXItYm90dG9tLXN0eWxlIl0gPSAhMCwgZVsiYm9yZGVyLWJvdHRvbS13aWR0aCJdID0gITAsIGVbImJvcmRlci1jb2xsYXBzZSJdID0gITAsIGVbImJvcmRlci1jb2xvciJdID0gITAsIGVbImJvcmRlci1pbWFnZSJdID0gITAsIGVbImJvcmRlci1pbWFnZS1vdXRzZXQiXSA9ICEwLCBlWyJib3JkZXItaW1hZ2UtcmVwZWF0Il0gPSAhMCwgZVsiYm9yZGVyLWltYWdlLXNsaWNlIl0gPSAhMCwgZVsiYm9yZGVyLWltYWdlLXNvdXJjZSJdID0gITAsIGVbImJvcmRlci1pbWFnZS13aWR0aCJdID0gITAsIGVbImJvcmRlci1sZWZ0Il0gPSAhMCwgZVsiYm9yZGVyLWxlZnQtY29sb3IiXSA9ICEwLCBlWyJib3JkZXItbGVmdC1zdHlsZSJdID0gITAsIGVbImJvcmRlci1sZWZ0LXdpZHRoIl0gPSAhMCwgZVsiYm9yZGVyLXJhZGl1cyJdID0gITAsIGVbImJvcmRlci1yaWdodCJdID0gITAsIGVbImJvcmRlci1yaWdodC1jb2xvciJdID0gITAsIGVbImJvcmRlci1yaWdodC1zdHlsZSJdID0gITAsIGVbImJvcmRlci1yaWdodC13aWR0aCJdID0gITAsIGVbImJvcmRlci1zcGFjaW5nIl0gPSAhMCwgZVsiYm9yZGVyLXN0eWxlIl0gPSAhMCwgZVsiYm9yZGVyLXRvcCJdID0gITAsIGVbImJvcmRlci10b3AtY29sb3IiXSA9ICEwLCBlWyJib3JkZXItdG9wLWxlZnQtcmFkaXVzIl0gPSAhMCwgZVsiYm9yZGVyLXRvcC1yaWdodC1yYWRpdXMiXSA9ICEwLCBlWyJib3JkZXItdG9wLXN0eWxlIl0gPSAhMCwgZVsiYm9yZGVyLXRvcC13aWR0aCJdID0gITAsIGVbImJvcmRlci13aWR0aCJdID0gITAsIGUuYm90dG9tID0gITEsIGVbImJveC1kZWNvcmF0aW9uLWJyZWFrIl0gPSAhMCwgZVsiYm94LXNoYWRvdyJdID0gITAsIGVbImJveC1zaXppbmciXSA9ICEwLCBlWyJib3gtc25hcCJdID0gITAsIGVbImJveC1zdXBwcmVzcyJdID0gITAsIGVbImJyZWFrLWFmdGVyIl0gPSAhMCwgZVsiYnJlYWstYmVmb3JlIl0gPSAhMCwgZVsiYnJlYWstaW5zaWRlIl0gPSAhMCwgZVsiY2FwdGlvbi1zaWRlIl0gPSAhMSwgZS5jaGFpbnMgPSAhMSwgZS5jbGVhciA9ICEwLCBlLmNsaXAgPSAhMSwgZVsiY2xpcC1wYXRoIl0gPSAhMSwgZVsiY2xpcC1ydWxlIl0gPSAhMSwgZS5jb2xvciA9ICEwLCBlWyJjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnMiXSA9ICEwLCBlWyJjb2x1bW4tY291bnQiXSA9ICExLCBlWyJjb2x1bW4tZmlsbCJdID0gITEsIGVbImNvbHVtbi1nYXAiXSA9ICExLCBlWyJjb2x1bW4tcnVsZSJdID0gITEsIGVbImNvbHVtbi1ydWxlLWNvbG9yIl0gPSAhMSwgZVsiY29sdW1uLXJ1bGUtc3R5bGUiXSA9ICExLCBlWyJjb2x1bW4tcnVsZS13aWR0aCJdID0gITEsIGVbImNvbHVtbi1zcGFuIl0gPSAhMSwgZVsiY29sdW1uLXdpZHRoIl0gPSAhMSwgZS5jb2x1bW5zID0gITEsIGUuY29udGFpbiA9ICExLCBlLmNvbnRlbnQgPSAhMSwgZVsiY291bnRlci1pbmNyZW1lbnQiXSA9ICExLCBlWyJjb3VudGVyLXJlc2V0Il0gPSAhMSwgZVsiY291bnRlci1zZXQiXSA9ICExLCBlLmNyb3AgPSAhMSwgZS5jdWUgPSAhMSwgZVsiY3VlLWFmdGVyIl0gPSAhMSwgZVsiY3VlLWJlZm9yZSJdID0gITEsIGUuY3Vyc29yID0gITEsIGUuZGlyZWN0aW9uID0gITEsIGUuZGlzcGxheSA9ICEwLCBlWyJkaXNwbGF5LWluc2lkZSJdID0gITAsIGVbImRpc3BsYXktbGlzdCJdID0gITAsIGVbImRpc3BsYXktb3V0c2lkZSJdID0gITAsIGVbImRvbWluYW50LWJhc2VsaW5lIl0gPSAhMSwgZS5lbGV2YXRpb24gPSAhMSwgZVsiZW1wdHktY2VsbHMiXSA9ICExLCBlLmZpbHRlciA9ICExLCBlLmZsZXggPSAhMSwgZVsiZmxleC1iYXNpcyJdID0gITEsIGVbImZsZXgtZGlyZWN0aW9uIl0gPSAhMSwgZVsiZmxleC1mbG93Il0gPSAhMSwgZVsiZmxleC1ncm93Il0gPSAhMSwgZVsiZmxleC1zaHJpbmsiXSA9ICExLCBlWyJmbGV4LXdyYXAiXSA9ICExLCBlWyJmbG9hdCJdID0gITEsIGVbImZsb2F0LW9mZnNldCJdID0gITEsIGVbImZsb29kLWNvbG9yIl0gPSAhMSwgZVsiZmxvb2Qtb3BhY2l0eSJdID0gITEsIGVbImZsb3ctZnJvbSJdID0gITEsIGVbImZsb3ctaW50byJdID0gITEsIGUuZm9udCA9ICEwLCBlWyJmb250LWZhbWlseSJdID0gITAsIGVbImZvbnQtZmVhdHVyZS1zZXR0aW5ncyJdID0gITAsIGVbImZvbnQta2VybmluZyJdID0gITAsIGVbImZvbnQtbGFuZ3VhZ2Utb3ZlcnJpZGUiXSA9ICEwLCBlWyJmb250LXNpemUiXSA9ICEwLCBlWyJmb250LXNpemUtYWRqdXN0Il0gPSAhMCwgZVsiZm9udC1zdHJldGNoIl0gPSAhMCwgZVsiZm9udC1zdHlsZSJdID0gITAsIGVbImZvbnQtc3ludGhlc2lzIl0gPSAhMCwgZVsiZm9udC12YXJpYW50Il0gPSAhMCwgZVsiZm9udC12YXJpYW50LWFsdGVybmF0ZXMiXSA9ICEwLCBlWyJmb250LXZhcmlhbnQtY2FwcyJdID0gITAsIGVbImZvbnQtdmFyaWFudC1lYXN0LWFzaWFuIl0gPSAhMCwgZVsiZm9udC12YXJpYW50LWxpZ2F0dXJlcyJdID0gITAsIGVbImZvbnQtdmFyaWFudC1udW1lcmljIl0gPSAhMCwgZVsiZm9udC12YXJpYW50LXBvc2l0aW9uIl0gPSAhMCwgZVsiZm9udC13ZWlnaHQiXSA9ICEwLCBlLmdyaWQgPSAhMSwgZVsiZ3JpZC1hcmVhIl0gPSAhMSwgZVsiZ3JpZC1hdXRvLWNvbHVtbnMiXSA9ICExLCBlWyJncmlkLWF1dG8tZmxvdyJdID0gITEsIGVbImdyaWQtYXV0by1yb3dzIl0gPSAhMSwgZVsiZ3JpZC1jb2x1bW4iXSA9ICExLCBlWyJncmlkLWNvbHVtbi1lbmQiXSA9ICExLCBlWyJncmlkLWNvbHVtbi1zdGFydCJdID0gITEsIGVbImdyaWQtcm93Il0gPSAhMSwgZVsiZ3JpZC1yb3ctZW5kIl0gPSAhMSwgZVsiZ3JpZC1yb3ctc3RhcnQiXSA9ICExLCBlWyJncmlkLXRlbXBsYXRlIl0gPSAhMSwgZVsiZ3JpZC10ZW1wbGF0ZS1hcmVhcyJdID0gITEsIGVbImdyaWQtdGVtcGxhdGUtY29sdW1ucyJdID0gITEsIGVbImdyaWQtdGVtcGxhdGUtcm93cyJdID0gITEsIGVbImhhbmdpbmctcHVuY3R1YXRpb24iXSA9ICExLCBlLmhlaWdodCA9ICEwLCBlLmh5cGhlbnMgPSAhMSwgZS5pY29uID0gITEsIGVbImltYWdlLW9yaWVudGF0aW9uIl0gPSAhMSwgZVsiaW1hZ2UtcmVzb2x1dGlvbiJdID0gITEsIGVbImltZS1tb2RlIl0gPSAhMSwgZVsiaW5pdGlhbC1sZXR0ZXJzIl0gPSAhMSwgZVsiaW5saW5lLWJveC1hbGlnbiJdID0gITEsIGVbImp1c3RpZnktY29udGVudCJdID0gITEsIGVbImp1c3RpZnktaXRlbXMiXSA9ICExLCBlWyJqdXN0aWZ5LXNlbGYiXSA9ICExLCBlLmxlZnQgPSAhMSwgZVsibGV0dGVyLXNwYWNpbmciXSA9ICEwLCBlWyJsaWdodGluZy1jb2xvciJdID0gITAsIGVbImxpbmUtYm94LWNvbnRhaW4iXSA9ICExLCBlWyJsaW5lLWJyZWFrIl0gPSAhMSwgZVsibGluZS1ncmlkIl0gPSAhMSwgZVsibGluZS1oZWlnaHQiXSA9ICExLCBlWyJsaW5lLXNuYXAiXSA9ICExLCBlWyJsaW5lLXN0YWNraW5nIl0gPSAhMSwgZVsibGluZS1zdGFja2luZy1ydWJ5Il0gPSAhMSwgZVsibGluZS1zdGFja2luZy1zaGlmdCJdID0gITEsIGVbImxpbmUtc3RhY2tpbmctc3RyYXRlZ3kiXSA9ICExLCBlWyJsaXN0LXN0eWxlIl0gPSAhMCwgZVsibGlzdC1zdHlsZS1pbWFnZSJdID0gITAsIGVbImxpc3Qtc3R5bGUtcG9zaXRpb24iXSA9ICEwLCBlWyJsaXN0LXN0eWxlLXR5cGUiXSA9ICEwLCBlLm1hcmdpbiA9ICEwLCBlWyJtYXJnaW4tYm90dG9tIl0gPSAhMCwgZVsibWFyZ2luLWxlZnQiXSA9ICEwLCBlWyJtYXJnaW4tcmlnaHQiXSA9ICEwLCBlWyJtYXJnaW4tdG9wIl0gPSAhMCwgZVsibWFya2VyLW9mZnNldCJdID0gITEsIGVbIm1hcmtlci1zaWRlIl0gPSAhMSwgZS5tYXJrcyA9ICExLCBlLm1hc2sgPSAhMSwgZVsibWFzay1ib3giXSA9ICExLCBlWyJtYXNrLWJveC1vdXRzZXQiXSA9ICExLCBlWyJtYXNrLWJveC1yZXBlYXQiXSA9ICExLCBlWyJtYXNrLWJveC1zbGljZSJdID0gITEsIGVbIm1hc2stYm94LXNvdXJjZSJdID0gITEsIGVbIm1hc2stYm94LXdpZHRoIl0gPSAhMSwgZVsibWFzay1jbGlwIl0gPSAhMSwgZVsibWFzay1pbWFnZSJdID0gITEsIGVbIm1hc2stb3JpZ2luIl0gPSAhMSwgZVsibWFzay1wb3NpdGlvbiJdID0gITEsIGVbIm1hc2stcmVwZWF0Il0gPSAhMSwgZVsibWFzay1zaXplIl0gPSAhMSwgZVsibWFzay1zb3VyY2UtdHlwZSJdID0gITEsIGVbIm1hc2stdHlwZSJdID0gITEsIGVbIm1heC1oZWlnaHQiXSA9ICEwLCBlWyJtYXgtbGluZXMiXSA9ICExLCBlWyJtYXgtd2lkdGgiXSA9ICEwLCBlWyJtaW4taGVpZ2h0Il0gPSAhMCwgZVsibWluLXdpZHRoIl0gPSAhMCwgZVsibW92ZS10byJdID0gITEsIGVbIm5hdi1kb3duIl0gPSAhMSwgZVsibmF2LWluZGV4Il0gPSAhMSwgZVsibmF2LWxlZnQiXSA9ICExLCBlWyJuYXYtcmlnaHQiXSA9ICExLCBlWyJuYXYtdXAiXSA9ICExLCBlWyJvYmplY3QtZml0Il0gPSAhMSwgZVsib2JqZWN0LXBvc2l0aW9uIl0gPSAhMSwgZS5vcGFjaXR5ID0gITEsIGUub3JkZXIgPSAhMSwgZS5vcnBoYW5zID0gITEsIGUub3V0bGluZSA9ICExLCBlWyJvdXRsaW5lLWNvbG9yIl0gPSAhMSwgZVsib3V0bGluZS1vZmZzZXQiXSA9ICExLCBlWyJvdXRsaW5lLXN0eWxlIl0gPSAhMSwgZVsib3V0bGluZS13aWR0aCJdID0gITEsIGUub3ZlcmZsb3cgPSAhMSwgZVsib3ZlcmZsb3ctd3JhcCJdID0gITEsIGVbIm92ZXJmbG93LXgiXSA9ICExLCBlWyJvdmVyZmxvdy15Il0gPSAhMSwgZS5wYWRkaW5nID0gITAsIGVbInBhZGRpbmctYm90dG9tIl0gPSAhMCwgZVsicGFkZGluZy1sZWZ0Il0gPSAhMCwgZVsicGFkZGluZy1yaWdodCJdID0gITAsIGVbInBhZGRpbmctdG9wIl0gPSAhMCwgZS5wYWdlID0gITEsIGVbInBhZ2UtYnJlYWstYWZ0ZXIiXSA9ICExLCBlWyJwYWdlLWJyZWFrLWJlZm9yZSJdID0gITEsIGVbInBhZ2UtYnJlYWstaW5zaWRlIl0gPSAhMSwgZVsicGFnZS1wb2xpY3kiXSA9ICExLCBlLnBhdXNlID0gITEsIGVbInBhdXNlLWFmdGVyIl0gPSAhMSwgZVsicGF1c2UtYmVmb3JlIl0gPSAhMSwgZS5wZXJzcGVjdGl2ZSA9ICExLCBlWyJwZXJzcGVjdGl2ZS1vcmlnaW4iXSA9ICExLCBlLnBpdGNoID0gITEsIGVbInBpdGNoLXJhbmdlIl0gPSAhMSwgZVsicGxheS1kdXJpbmciXSA9ICExLCBlLnBvc2l0aW9uID0gITEsIGVbInByZXNlbnRhdGlvbi1sZXZlbCJdID0gITEsIGUucXVvdGVzID0gITEsIGVbInJlZ2lvbi1mcmFnbWVudCJdID0gITEsIGUucmVzaXplID0gITEsIGUucmVzdCA9ICExLCBlWyJyZXN0LWFmdGVyIl0gPSAhMSwgZVsicmVzdC1iZWZvcmUiXSA9ICExLCBlLnJpY2huZXNzID0gITEsIGUucmlnaHQgPSAhMSwgZS5yb3RhdGlvbiA9ICExLCBlWyJyb3RhdGlvbi1wb2ludCJdID0gITEsIGVbInJ1YnktYWxpZ24iXSA9ICExLCBlWyJydWJ5LW1lcmdlIl0gPSAhMSwgZVsicnVieS1wb3NpdGlvbiJdID0gITEsIGVbInNoYXBlLWltYWdlLXRocmVzaG9sZCJdID0gITEsIGVbInNoYXBlLW91dHNpZGUiXSA9ICExLCBlWyJzaGFwZS1tYXJnaW4iXSA9ICExLCBlLnNpemUgPSAhMSwgZS5zcGVhayA9ICExLCBlWyJzcGVhay1hcyJdID0gITEsIGVbInNwZWFrLWhlYWRlciJdID0gITEsIGVbInNwZWFrLW51bWVyYWwiXSA9ICExLCBlWyJzcGVhay1wdW5jdHVhdGlvbiJdID0gITEsIGVbInNwZWVjaC1yYXRlIl0gPSAhMSwgZS5zdHJlc3MgPSAhMSwgZVsic3RyaW5nLXNldCJdID0gITEsIGVbInRhYi1zaXplIl0gPSAhMSwgZVsidGFibGUtbGF5b3V0Il0gPSAhMSwgZVsidGV4dC1hbGlnbiJdID0gITAsIGVbInRleHQtYWxpZ24tbGFzdCJdID0gITAsIGVbInRleHQtY29tYmluZS11cHJpZ2h0Il0gPSAhMCwgZVsidGV4dC1kZWNvcmF0aW9uIl0gPSAhMCwgZVsidGV4dC1kZWNvcmF0aW9uLWNvbG9yIl0gPSAhMCwgZVsidGV4dC1kZWNvcmF0aW9uLWxpbmUiXSA9ICEwLCBlWyJ0ZXh0LWRlY29yYXRpb24tc2tpcCJdID0gITAsIGVbInRleHQtZGVjb3JhdGlvbi1zdHlsZSJdID0gITAsIGVbInRleHQtZW1waGFzaXMiXSA9ICEwLCBlWyJ0ZXh0LWVtcGhhc2lzLWNvbG9yIl0gPSAhMCwgZVsidGV4dC1lbXBoYXNpcy1wb3NpdGlvbiJdID0gITAsIGVbInRleHQtZW1waGFzaXMtc3R5bGUiXSA9ICEwLCBlWyJ0ZXh0LWhlaWdodCJdID0gITAsIGVbInRleHQtaW5kZW50Il0gPSAhMCwgZVsidGV4dC1qdXN0aWZ5Il0gPSAhMCwgZVsidGV4dC1vcmllbnRhdGlvbiJdID0gITAsIGVbInRleHQtb3ZlcmZsb3ciXSA9ICEwLCBlWyJ0ZXh0LXNoYWRvdyJdID0gITAsIGVbInRleHQtc3BhY2UtY29sbGFwc2UiXSA9ICEwLCBlWyJ0ZXh0LXRyYW5zZm9ybSJdID0gITAsIGVbInRleHQtdW5kZXJsaW5lLXBvc2l0aW9uIl0gPSAhMCwgZVsidGV4dC13cmFwIl0gPSAhMCwgZS50b3AgPSAhMSwgZS50cmFuc2Zvcm0gPSAhMSwgZVsidHJhbnNmb3JtLW9yaWdpbiJdID0gITEsIGVbInRyYW5zZm9ybS1zdHlsZSJdID0gITEsIGUudHJhbnNpdGlvbiA9ICExLCBlWyJ0cmFuc2l0aW9uLWRlbGF5Il0gPSAhMSwgZVsidHJhbnNpdGlvbi1kdXJhdGlvbiJdID0gITEsIGVbInRyYW5zaXRpb24tcHJvcGVydHkiXSA9ICExLCBlWyJ0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbiJdID0gITEsIGVbInVuaWNvZGUtYmlkaSJdID0gITEsIGVbInZlcnRpY2FsLWFsaWduIl0gPSAhMSwgZS52aXNpYmlsaXR5ID0gITEsIGVbInZvaWNlLWJhbGFuY2UiXSA9ICExLCBlWyJ2b2ljZS1kdXJhdGlvbiJdID0gITEsIGVbInZvaWNlLWZhbWlseSJdID0gITEsIGVbInZvaWNlLXBpdGNoIl0gPSAhMSwgZVsidm9pY2UtcmFuZ2UiXSA9ICExLCBlWyJ2b2ljZS1yYXRlIl0gPSAhMSwgZVsidm9pY2Utc3RyZXNzIl0gPSAhMSwgZVsidm9pY2Utdm9sdW1lIl0gPSAhMSwgZS52b2x1bWUgPSAhMSwgZVsid2hpdGUtc3BhY2UiXSA9ICExLCBlLndpZG93cyA9ICExLCBlLndpZHRoID0gITAsIGVbIndpbGwtY2hhbmdlIl0gPSAhMSwgZVsid29yZC1icmVhayJdID0gITAsIGVbIndvcmQtc3BhY2luZyJdID0gITAsIGVbIndvcmQtd3JhcCJdID0gITAsIGVbIndyYXAtZmxvdyJdID0gITEsIGVbIndyYXAtdGhyb3VnaCJdID0gITEsIGVbIndyaXRpbmctbW9kZSJdID0gITEsIGVbInotaW5kZXgiXSA9ICExLCBlOwogICAgfQoKICAgIGZ1bmN0aW9uIHIoZSwgdCwgbikge30KCiAgICBmdW5jdGlvbiBvKGUsIHQsIG4pIHt9CgogICAgZnVuY3Rpb24gaShlLCB0KSB7CiAgICAgIHJldHVybiBhLnRlc3QodCkgPyAiIiA6IHQ7CiAgICB9CgogICAgdmFyIGEgPSAvamF2YXNjcmlwdFxzKlw6L2dpbTsKICAgIHQud2hpdGVMaXN0ID0gbigpLCB0LmdldERlZmF1bHRXaGl0ZUxpc3QgPSBuLCB0Lm9uQXR0ciA9IHIsIHQub25JZ25vcmVBdHRyID0gbywgdC5zYWZlQXR0clZhbHVlID0gaTsKICB9LCBmdW5jdGlvbiAoZSwgdCkgewogICAgZS5leHBvcnRzID0gewogICAgICBpbmRleE9mOiBmdW5jdGlvbiBpbmRleE9mKGUsIHQpIHsKICAgICAgICB2YXIgbiwgcjsKICAgICAgICBpZiAoQXJyYXkucHJvdG90eXBlLmluZGV4T2YpIHJldHVybiBlLmluZGV4T2YodCk7CgogICAgICAgIGZvciAobiA9IDAsIHIgPSBlLmxlbmd0aDsgbiA8IHI7IG4rKykgewogICAgICAgICAgaWYgKGVbbl0gPT09IHQpIHJldHVybiBuOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9LAogICAgICBmb3JFYWNoOiBmdW5jdGlvbiBmb3JFYWNoKGUsIHQsIG4pIHsKICAgICAgICB2YXIgciwgbzsKICAgICAgICBpZiAoQXJyYXkucHJvdG90eXBlLmZvckVhY2gpIHJldHVybiBlLmZvckVhY2godCwgbik7CgogICAgICAgIGZvciAociA9IDAsIG8gPSBlLmxlbmd0aDsgciA8IG87IHIrKykgewogICAgICAgICAgdC5jYWxsKG4sIGVbcl0sIHIsIGUpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdHJpbTogZnVuY3Rpb24gdHJpbShlKSB7CiAgICAgICAgcmV0dXJuIFN0cmluZy5wcm90b3R5cGUudHJpbSA/IGUudHJpbSgpIDogZS5yZXBsYWNlKC8oXlxzKil8KFxzKiQpL2csICIiKTsKICAgICAgfSwKICAgICAgdHJpbVJpZ2h0OiBmdW5jdGlvbiB0cmltUmlnaHQoZSkgewogICAgICAgIHJldHVybiBTdHJpbmcucHJvdG90eXBlLnRyaW1SaWdodCA/IGUudHJpbVJpZ2h0KCkgOiBlLnJlcGxhY2UoLyhccyokKS9nLCAiIik7CiAgICAgIH0KICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oNDApLAogICAgICAgIG8gPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gX3R5cGVvZihTeW1ib2woImZvbyIpKSwKICAgICAgICBpID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZywKICAgICAgICBhID0gQXJyYXkucHJvdG90eXBlLmNvbmNhdCwKICAgICAgICBzID0gT2JqZWN0LmRlZmluZVByb3BlcnR5LAogICAgICAgIGwgPSBmdW5jdGlvbiBsKGUpIHsKICAgICAgcmV0dXJuICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgJiYgIltvYmplY3QgRnVuY3Rpb25dIiA9PT0gaS5jYWxsKGUpOwogICAgfSwKICAgICAgICBjID0gcyAmJiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBlID0ge307CgogICAgICB0cnkgewogICAgICAgIHMoZSwgIngiLCB7CiAgICAgICAgICBlbnVtZXJhYmxlOiAhMSwKICAgICAgICAgIHZhbHVlOiBlCiAgICAgICAgfSk7CgogICAgICAgIGZvciAodmFyIHQgaW4gZSkgewogICAgICAgICAgcmV0dXJuICExOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGUueCA9PT0gZTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJldHVybiAhMTsKICAgICAgfQogICAgfSgpLAogICAgICAgIHUgPSBmdW5jdGlvbiB1KGUsIHQsIG4sIHIpIHsKICAgICAgKCEodCBpbiBlKSB8fCBsKHIpICYmIHIoKSkgJiYgKGMgPyBzKGUsIHQsIHsKICAgICAgICBjb25maWd1cmFibGU6ICEwLAogICAgICAgIGVudW1lcmFibGU6ICExLAogICAgICAgIHZhbHVlOiBuLAogICAgICAgIHdyaXRhYmxlOiAhMAogICAgICB9KSA6IGVbdF0gPSBuKTsKICAgIH0sCiAgICAgICAgZCA9IGZ1bmN0aW9uIGQoZSwgdCkgewogICAgICB2YXIgbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDoge30sCiAgICAgICAgICBpID0gcih0KTsKICAgICAgbyAmJiAoaSA9IGEuY2FsbChpLCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHQpKSk7CgogICAgICBmb3IgKHZhciBzID0gMDsgcyA8IGkubGVuZ3RoOyBzICs9IDEpIHsKICAgICAgICB1KGUsIGlbc10sIHRbaVtzXV0sIG5baVtzXV0pOwogICAgICB9CiAgICB9OwoKICAgIGQuc3VwcG9ydHNEZXNjcmlwdG9ycyA9ICEhYywgZS5leHBvcnRzID0gZDsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzsKCiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdCA9IHIuY2FsbChlKSwKICAgICAgICAgIG4gPSAiW29iamVjdCBBcmd1bWVudHNdIiA9PT0gdDsKICAgICAgcmV0dXJuIG4gfHwgKG4gPSAiW29iamVjdCBBcnJheV0iICE9PSB0ICYmIG51bGwgIT09IGUgJiYgIm9iamVjdCIgPT0gX3R5cGVvZihlKSAmJiAibnVtYmVyIiA9PSB0eXBlb2YgZS5sZW5ndGggJiYgZS5sZW5ndGggPj0gMCAmJiAiW29iamVjdCBGdW5jdGlvbl0iID09PSByLmNhbGwoZS5jYWxsZWUpKSwgbjsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oNDUpLAogICAgICAgIG8gPSBuKDQ0KSwKICAgICAgICBpID0gbig0NiksCiAgICAgICAgYSA9IGkoIlN0cmluZy5wcm90b3R5cGUucmVwbGFjZSIpLAogICAgICAgIHMgPSAvXltceDA5XHgwQVx4MEJceDBDXHgwRFx4MjBceEEwXHUxNjgwXHUxODBFXHUyMDAwXHUyMDAxXHUyMDAyXHUyMDAzXHUyMDA0XHUyMDA1XHUyMDA2XHUyMDA3XHUyMDA4XHUyMDA5XHUyMDBBXHUyMDJGXHUyMDVGXHUzMDAwXHUyMDI4XHUyMDI5XHVGRUZGXSsvLAogICAgICAgIGwgPSAvW1x4MDlceDBBXHgwQlx4MENceDBEXHgyMFx4QTBcdTE2ODBcdTE4MEVcdTIwMDBcdTIwMDFcdTIwMDJcdTIwMDNcdTIwMDRcdTIwMDVcdTIwMDZcdTIwMDdcdTIwMDhcdTIwMDlcdTIwMEFcdTIwMkZcdTIwNUZcdTMwMDBcdTIwMjhcdTIwMjlcdUZFRkZdKyQvOwoKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGUgPSBvKHIodGhpcykpOwogICAgICByZXR1cm4gYShhKGUsIHMsICIiKSwgbCwgIiIpOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gbig0KSwKICAgICAgICBvID0gbigxKSwKICAgICAgICBpID0gbygiJUZ1bmN0aW9uJSIpLAogICAgICAgIGEgPSBpLmFwcGx5LAogICAgICAgIHMgPSBpLmNhbGw7CiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiByLmFwcGx5KHMsIGFyZ3VtZW50cyk7CiAgICB9LCBlLmV4cG9ydHMuYXBwbHkgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiByLmFwcGx5KGEsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBuKDExKSwKICAgICAgICBvID0gIuKAiyI7CgogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gU3RyaW5nLnByb3RvdHlwZS50cmltICYmIG8udHJpbSgpID09PSBvID8gU3RyaW5nLnByb3RvdHlwZS50cmltIDogcjsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIHZhciBuOwoKICAgIG4gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSgpOwoKICAgIHRyeSB7CiAgICAgIG4gPSBuIHx8IEZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCkgfHwgKDAsIGV2YWwpKCJ0aGlzIik7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgICJvYmplY3QiID09ICh0eXBlb2Ygd2luZG93ID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZih3aW5kb3cpKSAmJiAobiA9IHdpbmRvdyk7CiAgICB9CgogICAgZS5leHBvcnRzID0gbjsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgZnVuY3Rpb24gcigpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBhOiBbInRhcmdldCIsICJocmVmIiwgInRpdGxlIl0sCiAgICAgICAgYWJicjogWyJ0aXRsZSJdLAogICAgICAgIGFkZHJlc3M6IFtdLAogICAgICAgIGFyZWE6IFsic2hhcGUiLCAiY29vcmRzIiwgImhyZWYiLCAiYWx0Il0sCiAgICAgICAgYXJ0aWNsZTogW10sCiAgICAgICAgYXNpZGU6IFtdLAogICAgICAgIGF1ZGlvOiBbImF1dG9wbGF5IiwgImNvbnRyb2xzIiwgImxvb3AiLCAicHJlbG9hZCIsICJzcmMiXSwKICAgICAgICBiOiBbXSwKICAgICAgICBiZGk6IFsiZGlyIl0sCiAgICAgICAgYmRvOiBbImRpciJdLAogICAgICAgIGJpZzogW10sCiAgICAgICAgYmxvY2txdW90ZTogWyJjaXRlIl0sCiAgICAgICAgYnI6IFtdLAogICAgICAgIGNhcHRpb246IFtdLAogICAgICAgIGNlbnRlcjogW10sCiAgICAgICAgY2l0ZTogW10sCiAgICAgICAgY29kZTogW10sCiAgICAgICAgY29sOiBbImFsaWduIiwgInZhbGlnbiIsICJzcGFuIiwgIndpZHRoIl0sCiAgICAgICAgY29sZ3JvdXA6IFsiYWxpZ24iLCAidmFsaWduIiwgInNwYW4iLCAid2lkdGgiXSwKICAgICAgICBkZDogW10sCiAgICAgICAgZGVsOiBbImRhdGV0aW1lIl0sCiAgICAgICAgZGV0YWlsczogWyJvcGVuIl0sCiAgICAgICAgZGl2OiBbXSwKICAgICAgICBkbDogW10sCiAgICAgICAgZHQ6IFtdLAogICAgICAgIGVtOiBbXSwKICAgICAgICBmb250OiBbImNvbG9yIiwgInNpemUiLCAiZmFjZSJdLAogICAgICAgIGZvb3RlcjogW10sCiAgICAgICAgaDE6IFtdLAogICAgICAgIGgyOiBbXSwKICAgICAgICBoMzogW10sCiAgICAgICAgaDQ6IFtdLAogICAgICAgIGg1OiBbXSwKICAgICAgICBoNjogW10sCiAgICAgICAgaGVhZGVyOiBbXSwKICAgICAgICBocjogW10sCiAgICAgICAgaTogW10sCiAgICAgICAgaW1nOiBbInNyYyIsICJhbHQiLCAidGl0bGUiLCAid2lkdGgiLCAiaGVpZ2h0Il0sCiAgICAgICAgaW5zOiBbImRhdGV0aW1lIl0sCiAgICAgICAgbGk6IFtdLAogICAgICAgIG1hcms6IFtdLAogICAgICAgIG5hdjogW10sCiAgICAgICAgb2w6IFtdLAogICAgICAgIHA6IFtdLAogICAgICAgIHByZTogW10sCiAgICAgICAgczogW10sCiAgICAgICAgc2VjdGlvbjogW10sCiAgICAgICAgc21hbGw6IFtdLAogICAgICAgIHNwYW46IFtdLAogICAgICAgIHN1YjogW10sCiAgICAgICAgc3VwOiBbXSwKICAgICAgICBzdHJvbmc6IFtdLAogICAgICAgIHRhYmxlOiBbIndpZHRoIiwgImJvcmRlciIsICJhbGlnbiIsICJ2YWxpZ24iXSwKICAgICAgICB0Ym9keTogWyJhbGlnbiIsICJ2YWxpZ24iXSwKICAgICAgICB0ZDogWyJ3aWR0aCIsICJyb3dzcGFuIiwgImNvbHNwYW4iLCAiYWxpZ24iLCAidmFsaWduIl0sCiAgICAgICAgdGZvb3Q6IFsiYWxpZ24iLCAidmFsaWduIl0sCiAgICAgICAgdGg6IFsid2lkdGgiLCAicm93c3BhbiIsICJjb2xzcGFuIiwgImFsaWduIiwgInZhbGlnbiJdLAogICAgICAgIHRoZWFkOiBbImFsaWduIiwgInZhbGlnbiJdLAogICAgICAgIHRyOiBbInJvd3NwYW4iLCAiYWxpZ24iLCAidmFsaWduIl0sCiAgICAgICAgdHQ6IFtdLAogICAgICAgIHU6IFtdLAogICAgICAgIHVsOiBbXSwKICAgICAgICB2aWRlbzogWyJhdXRvcGxheSIsICJjb250cm9scyIsICJsb29wIiwgInByZWxvYWQiLCAic3JjIiwgImhlaWdodCIsICJ3aWR0aCJdCiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gbyhlLCB0LCBuKSB7fQoKICAgIGZ1bmN0aW9uIGkoZSwgdCwgbikge30KCiAgICBmdW5jdGlvbiBhKGUsIHQsIG4pIHt9CgogICAgZnVuY3Rpb24gcyhlLCB0LCBuKSB7fQoKICAgIGZ1bmN0aW9uIGwoZSkgewogICAgICByZXR1cm4gZS5yZXBsYWNlKFMsICImbHQ7IikucmVwbGFjZShPLCAiJmd0OyIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGMoZSwgdCwgbiwgcikgewogICAgICBpZiAobiA9IHYobiksICJocmVmIiA9PT0gdCB8fCAic3JjIiA9PT0gdCkgewogICAgICAgIGlmICgiIyIgPT09IChuID0gXy50cmltKG4pKSkgcmV0dXJuICIjIjsKICAgICAgICBpZiAoImh0dHA6Ly8iICE9PSBuLnN1YnN0cigwLCA3KSAmJiAiaHR0cHM6Ly8iICE9PSBuLnN1YnN0cigwLCA4KSAmJiAibWFpbHRvOiIgIT09IG4uc3Vic3RyKDAsIDcpICYmICJ0ZWw6IiAhPT0gbi5zdWJzdHIoMCwgNCkgJiYgIiMiICE9PSBuWzBdICYmICIvIiAhPT0gblswXSkgcmV0dXJuICIiOwogICAgICB9IGVsc2UgaWYgKCJiYWNrZ3JvdW5kIiA9PT0gdCkgewogICAgICAgIGlmIChJLmxhc3RJbmRleCA9IDAsIEkudGVzdChuKSkgcmV0dXJuICIiOwogICAgICB9IGVsc2UgaWYgKCJzdHlsZSIgPT09IHQpIHsKICAgICAgICBpZiAoUC5sYXN0SW5kZXggPSAwLCBQLnRlc3QobikpIHJldHVybiAiIjsKICAgICAgICBpZiAoTS5sYXN0SW5kZXggPSAwLCBNLnRlc3QobikgJiYgKEkubGFzdEluZGV4ID0gMCwgSS50ZXN0KG4pKSkgcmV0dXJuICIiOwogICAgICAgICExICE9PSByICYmIChyID0gciB8fCBBLCBuID0gci5wcm9jZXNzKG4pKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG4gPSBnKG4pOwogICAgfQoKICAgIGZ1bmN0aW9uIHUoZSkgewogICAgICByZXR1cm4gZS5yZXBsYWNlKCQsICImcXVvdDsiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkKGUpIHsKICAgICAgcmV0dXJuIGUucmVwbGFjZShFLCAnIicpOwogICAgfQoKICAgIGZ1bmN0aW9uIHAoZSkgewogICAgICByZXR1cm4gZS5yZXBsYWNlKGosIGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuICJ4IiA9PT0gdFswXSB8fCAiWCIgPT09IHRbMF0gPyBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KHQuc3Vic3RyKDEpLCAxNikpIDogU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludCh0LCAxMCkpOwogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBmKGUpIHsKICAgICAgcmV0dXJuIGUucmVwbGFjZShULCAiOiIpLnJlcGxhY2UoQywgIiAiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBoKGUpIHsKICAgICAgZm9yICh2YXIgdCA9ICIiLCBuID0gMCwgciA9IGUubGVuZ3RoOyBuIDwgcjsgbisrKSB7CiAgICAgICAgdCArPSBlLmNoYXJDb2RlQXQobikgPCAzMiA/ICIgIiA6IGUuY2hhckF0KG4pOwogICAgICB9CgogICAgICByZXR1cm4gXy50cmltKHQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHYoZSkgewogICAgICByZXR1cm4gZSA9IGQoZSksIGUgPSBwKGUpLCBlID0gZihlKSwgZSA9IGgoZSk7CiAgICB9CgogICAgZnVuY3Rpb24gZyhlKSB7CiAgICAgIHJldHVybiBlID0gdShlKSwgZSA9IGwoZSk7CiAgICB9CgogICAgZnVuY3Rpb24gbSgpIHsKICAgICAgcmV0dXJuICIiOwogICAgfQoKICAgIGZ1bmN0aW9uIHkoZSwgdCkgewogICAgICBmdW5jdGlvbiBuKHQpIHsKICAgICAgICByZXR1cm4gISFyIHx8IC0xICE9PSBfLmluZGV4T2YoZSwgdCk7CiAgICAgIH0KCiAgICAgICJmdW5jdGlvbiIgIT0gdHlwZW9mIHQgJiYgKHQgPSBmdW5jdGlvbiB0KCkge30pOwogICAgICB2YXIgciA9ICFBcnJheS5pc0FycmF5KGUpLAogICAgICAgICAgbyA9IFtdLAogICAgICAgICAgaSA9ICExOwogICAgICByZXR1cm4gewogICAgICAgIG9uSWdub3JlVGFnOiBmdW5jdGlvbiBvbklnbm9yZVRhZyhlLCByLCBhKSB7CiAgICAgICAgICBpZiAobihlKSkgewogICAgICAgICAgICBpZiAoYS5pc0Nsb3NpbmcpIHsKICAgICAgICAgICAgICB2YXIgcyA9ICJbL3JlbW92ZWRdIiwKICAgICAgICAgICAgICAgICAgbCA9IGEucG9zaXRpb24gKyBzLmxlbmd0aDsKICAgICAgICAgICAgICByZXR1cm4gby5wdXNoKFshMSAhPT0gaSA/IGkgOiBhLnBvc2l0aW9uLCBsXSksIGkgPSAhMSwgczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGkgfHwgKGkgPSBhLnBvc2l0aW9uKSwgIltyZW1vdmVkXSI7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHQoZSwgciwgYSk7CiAgICAgICAgfSwKICAgICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShlKSB7CiAgICAgICAgICB2YXIgdCA9ICIiLAogICAgICAgICAgICAgIG4gPSAwOwogICAgICAgICAgcmV0dXJuIF8uZm9yRWFjaChvLCBmdW5jdGlvbiAocikgewogICAgICAgICAgICB0ICs9IGUuc2xpY2UobiwgclswXSksIG4gPSByWzFdOwogICAgICAgICAgfSksIHQgKz0gZS5zbGljZShuKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gYihlKSB7CiAgICAgIHJldHVybiBlLnJlcGxhY2UoUiwgIiIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHcoZSkgewogICAgICB2YXIgdCA9IGUuc3BsaXQoIiIpOwogICAgICByZXR1cm4gdCA9IHQuZmlsdGVyKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQgPSBlLmNoYXJDb2RlQXQoMCk7CiAgICAgICAgcmV0dXJuIDEyNyAhPT0gdCAmJiAoISh0IDw9IDMxKSB8fCAxMCA9PT0gdCB8fCAxMyA9PT0gdCk7CiAgICAgIH0pLCB0LmpvaW4oIiIpOwogICAgfQoKICAgIHZhciB4ID0gbigzKS5GaWx0ZXJDU1MsCiAgICAgICAgayA9IG4oMykuZ2V0RGVmYXVsdFdoaXRlTGlzdCwKICAgICAgICBfID0gbig1KSwKICAgICAgICBBID0gbmV3IHgoKSwKICAgICAgICBTID0gLzwvZywKICAgICAgICBPID0gLz4vZywKICAgICAgICAkID0gLyIvZywKICAgICAgICBFID0gLyZxdW90Oy9nLAogICAgICAgIGogPSAvJiMoW2EtekEtWjAtOV0qKTs/L2dpbSwKICAgICAgICBUID0gLyZjb2xvbjs/L2dpbSwKICAgICAgICBDID0gLyZuZXdsaW5lOz8vZ2ltLAogICAgICAgIEkgPSAvKChqXHMqYVxzKnZccyphfHZccypifGxccyppXHMqdlxzKmUpXHMqc1xzKmNccypyXHMqaVxzKnBccyp0XHMqfG1ccypvXHMqY1xzKmhccyphKVw6L2dpLAogICAgICAgIFAgPSAvZVxzKnhccypwXHMqclxzKmVccypzXHMqc1xzKmlccypvXHMqblxzKlwoLiovZ2ksCiAgICAgICAgTSA9IC91XHMqclxzKmxccypcKC4qL2dpLAogICAgICAgIFIgPSAvPCEtLVtcc1xTXSo/LS0+L2c7CgogICAgdC53aGl0ZUxpc3QgPSByKCksIHQuZ2V0RGVmYXVsdFdoaXRlTGlzdCA9IHIsIHQub25UYWcgPSBvLCB0Lm9uSWdub3JlVGFnID0gaSwgdC5vblRhZ0F0dHIgPSBhLCB0Lm9uSWdub3JlVGFnQXR0ciA9IHMsIHQuc2FmZUF0dHJWYWx1ZSA9IGMsIHQuZXNjYXBlSHRtbCA9IGwsIHQuZXNjYXBlUXVvdGUgPSB1LCB0LnVuZXNjYXBlUXVvdGUgPSBkLCB0LmVzY2FwZUh0bWxFbnRpdGllcyA9IHAsIHQuZXNjYXBlRGFuZ2VySHRtbDVFbnRpdGllcyA9IGYsIHQuY2xlYXJOb25QcmludGFibGVDaGFyYWN0ZXIgPSBoLCB0LmZyaWVuZGx5QXR0clZhbHVlID0gdiwgdC5lc2NhcGVBdHRyVmFsdWUgPSBnLCB0Lm9uSWdub3JlVGFnU3RyaXBBbGwgPSBtLCB0LlN0cmlwVGFnQm9keSA9IHksIHQuc3RyaXBDb21tZW50VGFnID0gYiwgdC5zdHJpcEJsYW5rQ2hhciA9IHcsIHQuY3NzRmlsdGVyID0gQSwgdC5nZXREZWZhdWx0Q1NTV2hpdGVMaXN0ID0gazsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgZnVuY3Rpb24gcihlKSB7CiAgICAgIHZhciB0ID0gZC5zcGFjZUluZGV4KGUpOwogICAgICBpZiAoLTEgPT09IHQpIHZhciBuID0gZS5zbGljZSgxLCAtMSk7ZWxzZSB2YXIgbiA9IGUuc2xpY2UoMSwgdCArIDEpOwogICAgICByZXR1cm4gbiA9IGQudHJpbShuKS50b0xvd2VyQ2FzZSgpLCAiLyIgPT09IG4uc2xpY2UoMCwgMSkgJiYgKG4gPSBuLnNsaWNlKDEpKSwgIi8iID09PSBuLnNsaWNlKC0xKSAmJiAobiA9IG4uc2xpY2UoMCwgLTEpKSwgbjsKICAgIH0KCiAgICBmdW5jdGlvbiBvKGUpIHsKICAgICAgcmV0dXJuICI8LyIgPT09IGUuc2xpY2UoMCwgMik7CiAgICB9CgogICAgZnVuY3Rpb24gaShlLCB0LCBuKSB7CiAgICAgICJ1c2VyIHN0cmljdCI7CgogICAgICB2YXIgaSA9ICIiLAogICAgICAgICAgYSA9IDAsCiAgICAgICAgICBzID0gITEsCiAgICAgICAgICBsID0gITEsCiAgICAgICAgICBjID0gMCwKICAgICAgICAgIHUgPSBlLmxlbmd0aCwKICAgICAgICAgIGQgPSAiIiwKICAgICAgICAgIHAgPSAiIjsKCiAgICAgIGZvciAoYyA9IDA7IGMgPCB1OyBjKyspIHsKICAgICAgICB2YXIgZiA9IGUuY2hhckF0KGMpOwoKICAgICAgICBpZiAoITEgPT09IHMpIHsKICAgICAgICAgIGlmICgiPCIgPT09IGYpIHsKICAgICAgICAgICAgcyA9IGM7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoITEgPT09IGwpIHsKICAgICAgICAgIGlmICgiPCIgPT09IGYpIHsKICAgICAgICAgICAgaSArPSBuKGUuc2xpY2UoYSwgYykpLCBzID0gYywgYSA9IGM7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICgiPiIgPT09IGYpIHsKICAgICAgICAgICAgaSArPSBuKGUuc2xpY2UoYSwgcykpLCBwID0gZS5zbGljZShzLCBjICsgMSksIGQgPSByKHApLCBpICs9IHQocywgaS5sZW5ndGgsIGQsIHAsIG8ocCkpLCBhID0gYyArIDEsIHMgPSAhMTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCgnIicgPT09IGYgfHwgIiciID09PSBmKSAmJiAiPSIgPT09IGUuY2hhckF0KGMgLSAxKSkgewogICAgICAgICAgICBsID0gZjsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChmID09PSBsKSB7CiAgICAgICAgICBsID0gITE7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBhIDwgZS5sZW5ndGggJiYgKGkgKz0gbihlLnN1YnN0cihhKSkpLCBpOwogICAgfQoKICAgIGZ1bmN0aW9uIGEoZSwgdCkgewogICAgICAidXNlciBzdHJpY3QiOwoKICAgICAgZnVuY3Rpb24gbihlLCBuKSB7CiAgICAgICAgaWYgKGUgPSBkLnRyaW0oZSksIGUgPSBlLnJlcGxhY2UocCwgIiIpLnRvTG93ZXJDYXNlKCksICEoZS5sZW5ndGggPCAxKSkgewogICAgICAgICAgdmFyIHIgPSB0KGUsIG4gfHwgIiIpOwogICAgICAgICAgciAmJiBvLnB1c2gocik7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciByID0gMCwgbyA9IFtdLCBpID0gITEsIGEgPSBlLmxlbmd0aCwgYyA9IDA7IGMgPCBhOyBjKyspIHsKICAgICAgICB2YXIgZiwKICAgICAgICAgICAgaCwKICAgICAgICAgICAgdiA9IGUuY2hhckF0KGMpOwogICAgICAgIGlmICghMSAhPT0gaSB8fCAiPSIgIT09IHYpIHsKICAgICAgICAgIGlmICghMSA9PT0gaSB8fCBjICE9PSByIHx8ICciJyAhPT0gdiAmJiAiJyIgIT09IHYgfHwgIj0iICE9PSBlLmNoYXJBdChjIC0gMSkpIHsKICAgICAgICAgICAgaWYgKC9cc3xcbnxcdC8udGVzdCh2KSkgewogICAgICAgICAgICAgIGlmIChlID0gZS5yZXBsYWNlKC9cc3xcbnxcdC9nLCAiICIpLCAhMSA9PT0gaSkgewogICAgICAgICAgICAgICAgaWYgKC0xID09PSAoaCA9IHMoZSwgYykpKSB7CiAgICAgICAgICAgICAgICAgIGYgPSBkLnRyaW0oZS5zbGljZShyLCBjKSksIG4oZiksIGkgPSAhMSwgciA9IGMgKyAxOwogICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjID0gaCAtIDE7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICgtMSA9PT0gKGggPSBsKGUsIGMgLSAxKSkpIHsKICAgICAgICAgICAgICAgIGYgPSBkLnRyaW0oZS5zbGljZShyLCBjKSksIGYgPSB1KGYpLCBuKGksIGYpLCBpID0gITEsIHIgPSBjICsgMTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICgtMSA9PT0gKGggPSBlLmluZGV4T2YodiwgYyArIDEpKSkgYnJlYWs7CiAgICAgICAgICAgIGYgPSBkLnRyaW0oZS5zbGljZShyICsgMSwgaCkpLCBuKGksIGYpLCBpID0gITEsIGMgPSBoLCByID0gYyArIDE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGkgPSBlLnNsaWNlKHIsIGMpLCByID0gYyArIDE7CiAgICAgIH0KCiAgICAgIHJldHVybiByIDwgZS5sZW5ndGggJiYgKCExID09PSBpID8gbihlLnNsaWNlKHIpKSA6IG4oaSwgdShkLnRyaW0oZS5zbGljZShyKSkpKSksIGQudHJpbShvLmpvaW4oIiAiKSk7CiAgICB9CgogICAgZnVuY3Rpb24gcyhlLCB0KSB7CiAgICAgIGZvciAoOyB0IDwgZS5sZW5ndGg7IHQrKykgewogICAgICAgIHZhciBuID0gZVt0XTsKICAgICAgICBpZiAoIiAiICE9PSBuKSByZXR1cm4gIj0iID09PSBuID8gdCA6IC0xOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gbChlLCB0KSB7CiAgICAgIGZvciAoOyB0ID4gMDsgdC0tKSB7CiAgICAgICAgdmFyIG4gPSBlW3RdOwogICAgICAgIGlmICgiICIgIT09IG4pIHJldHVybiAiPSIgPT09IG4gPyB0IDogLTE7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjKGUpIHsKICAgICAgcmV0dXJuICciJyA9PT0gZVswXSAmJiAnIicgPT09IGVbZS5sZW5ndGggLSAxXSB8fCAiJyIgPT09IGVbMF0gJiYgIiciID09PSBlW2UubGVuZ3RoIC0gMV07CiAgICB9CgogICAgZnVuY3Rpb24gdShlKSB7CiAgICAgIHJldHVybiBjKGUpID8gZS5zdWJzdHIoMSwgZS5sZW5ndGggLSAyKSA6IGU7CiAgICB9CgogICAgdmFyIGQgPSBuKDUpLAogICAgICAgIHAgPSAvW15hLXpBLVowLTlfOlwuXC1dL2dpbTsKICAgIHQucGFyc2VUYWcgPSBpLCB0LnBhcnNlQXR0ciA9IGE7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIHZhciByLCBvLCBpOwogICAgLyohCiAgICBhdXRvc2l6ZSA0LjAuMgogICAgbGljZW5zZTogTUlUCiAgICBodHRwOi8vd3d3LmphY2tsbW9vcmUuY29tL2F1dG9zaXplCiAgICAqLwoKICAgICFmdW5jdGlvbiAobiwgYSkgewogICAgICBvID0gW2UsIHRdLCByID0gYSwgdm9pZCAwICE9PSAoaSA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHIgPyByLmFwcGx5KHQsIG8pIDogcikgJiYgKGUuZXhwb3J0cyA9IGkpOwogICAgfSgwLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAidXNlIHN0cmljdCI7CgogICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICBmdW5jdGlvbiB0KHQpIHsKICAgICAgICAgIHZhciBuID0gZS5zdHlsZS53aWR0aDsKICAgICAgICAgIGUuc3R5bGUud2lkdGggPSAiMHB4IiwgZS5vZmZzZXRXaWR0aCwgZS5zdHlsZS53aWR0aCA9IG4sIGUuc3R5bGUub3ZlcmZsb3dZID0gdDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgICAgZm9yICh2YXIgdCA9IFtdOyBlICYmIGUucGFyZW50Tm9kZSAmJiBlLnBhcmVudE5vZGUgaW5zdGFuY2VvZiBFbGVtZW50OykgewogICAgICAgICAgICBlLnBhcmVudE5vZGUuc2Nyb2xsVG9wICYmIHQucHVzaCh7CiAgICAgICAgICAgICAgbm9kZTogZS5wYXJlbnROb2RlLAogICAgICAgICAgICAgIHNjcm9sbFRvcDogZS5wYXJlbnROb2RlLnNjcm9sbFRvcAogICAgICAgICAgICB9KSwgZSA9IGUucGFyZW50Tm9kZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHIoKSB7CiAgICAgICAgICBpZiAoMCAhPT0gZS5zY3JvbGxIZWlnaHQpIHsKICAgICAgICAgICAgdmFyIHQgPSBuKGUpLAogICAgICAgICAgICAgICAgciA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wOwogICAgICAgICAgICBlLnN0eWxlLmhlaWdodCA9ICIiLCBlLnN0eWxlLmhlaWdodCA9IGUuc2Nyb2xsSGVpZ2h0ICsgcyArICJweCIsIGwgPSBlLmNsaWVudFdpZHRoLCB0LmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICBlLm5vZGUuc2Nyb2xsVG9wID0gZS5zY3JvbGxUb3A7CiAgICAgICAgICAgIH0pLCByICYmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID0gcik7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBvKCkgewogICAgICAgICAgcigpOwogICAgICAgICAgdmFyIG4gPSBNYXRoLnJvdW5kKHBhcnNlRmxvYXQoZS5zdHlsZS5oZWlnaHQpKSwKICAgICAgICAgICAgICBvID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZSwgbnVsbCksCiAgICAgICAgICAgICAgaSA9ICJjb250ZW50LWJveCIgPT09IG8uYm94U2l6aW5nID8gTWF0aC5yb3VuZChwYXJzZUZsb2F0KG8uaGVpZ2h0KSkgOiBlLm9mZnNldEhlaWdodDsKCiAgICAgICAgICBpZiAoaSA8IG4gPyAiaGlkZGVuIiA9PT0gby5vdmVyZmxvd1kgJiYgKHQoInNjcm9sbCIpLCByKCksIGkgPSAiY29udGVudC1ib3giID09PSBvLmJveFNpemluZyA/IE1hdGgucm91bmQocGFyc2VGbG9hdCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlLCBudWxsKS5oZWlnaHQpKSA6IGUub2Zmc2V0SGVpZ2h0KSA6ICJoaWRkZW4iICE9PSBvLm92ZXJmbG93WSAmJiAodCgiaGlkZGVuIiksIHIoKSwgaSA9ICJjb250ZW50LWJveCIgPT09IG8uYm94U2l6aW5nID8gTWF0aC5yb3VuZChwYXJzZUZsb2F0KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGUsIG51bGwpLmhlaWdodCkpIDogZS5vZmZzZXRIZWlnaHQpLCBjICE9PSBpKSB7CiAgICAgICAgICAgIGMgPSBpOwogICAgICAgICAgICB2YXIgcyA9IGEoImF1dG9zaXplOnJlc2l6ZWQiKTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgZS5kaXNwYXRjaEV2ZW50KHMpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGUgJiYgZS5ub2RlTmFtZSAmJiAiVEVYVEFSRUEiID09PSBlLm5vZGVOYW1lICYmICFpLmhhcyhlKSkgewogICAgICAgICAgdmFyIHMgPSBudWxsLAogICAgICAgICAgICAgIGwgPSBudWxsLAogICAgICAgICAgICAgIGMgPSBudWxsLAogICAgICAgICAgICAgIHUgPSBmdW5jdGlvbiB1KCkgewogICAgICAgICAgICBlLmNsaWVudFdpZHRoICE9PSBsICYmIG8oKTsKICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZCA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJyZXNpemUiLCB1LCAhMSksIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCBvLCAhMSksIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcigia2V5dXAiLCBvLCAhMSksIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcigiYXV0b3NpemU6ZGVzdHJveSIsIGQsICExKSwgZS5yZW1vdmVFdmVudExpc3RlbmVyKCJhdXRvc2l6ZTp1cGRhdGUiLCBvLCAhMSksIE9iamVjdC5rZXlzKHQpLmZvckVhY2goZnVuY3Rpb24gKG4pIHsKICAgICAgICAgICAgICBlLnN0eWxlW25dID0gdFtuXTsKICAgICAgICAgICAgfSksIGlbImRlbGV0ZSJdKGUpOwogICAgICAgICAgfS5iaW5kKGUsIHsKICAgICAgICAgICAgaGVpZ2h0OiBlLnN0eWxlLmhlaWdodCwKICAgICAgICAgICAgcmVzaXplOiBlLnN0eWxlLnJlc2l6ZSwKICAgICAgICAgICAgb3ZlcmZsb3dZOiBlLnN0eWxlLm92ZXJmbG93WSwKICAgICAgICAgICAgb3ZlcmZsb3dYOiBlLnN0eWxlLm92ZXJmbG93WCwKICAgICAgICAgICAgd29yZFdyYXA6IGUuc3R5bGUud29yZFdyYXAKICAgICAgICAgIH0pOwoKICAgICAgICAgIGUuYWRkRXZlbnRMaXN0ZW5lcigiYXV0b3NpemU6ZGVzdHJveSIsIGQsICExKSwgIm9ucHJvcGVydHljaGFuZ2UiIGluIGUgJiYgIm9uaW5wdXQiIGluIGUgJiYgZS5hZGRFdmVudExpc3RlbmVyKCJrZXl1cCIsIG8sICExKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIHUsICExKSwgZS5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsIG8sICExKSwgZS5hZGRFdmVudExpc3RlbmVyKCJhdXRvc2l6ZTp1cGRhdGUiLCBvLCAhMSksIGUuc3R5bGUub3ZlcmZsb3dYID0gImhpZGRlbiIsIGUuc3R5bGUud29yZFdyYXAgPSAiYnJlYWstd29yZCIsIGkuc2V0KGUsIHsKICAgICAgICAgICAgZGVzdHJveTogZCwKICAgICAgICAgICAgdXBkYXRlOiBvCiAgICAgICAgICB9KSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgdCA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGUsIG51bGwpOwogICAgICAgICAgICAidmVydGljYWwiID09PSB0LnJlc2l6ZSA/IGUuc3R5bGUucmVzaXplID0gIm5vbmUiIDogImJvdGgiID09PSB0LnJlc2l6ZSAmJiAoZS5zdHlsZS5yZXNpemUgPSAiaG9yaXpvbnRhbCIpLCBzID0gImNvbnRlbnQtYm94IiA9PT0gdC5ib3hTaXppbmcgPyAtKHBhcnNlRmxvYXQodC5wYWRkaW5nVG9wKSArIHBhcnNlRmxvYXQodC5wYWRkaW5nQm90dG9tKSkgOiBwYXJzZUZsb2F0KHQuYm9yZGVyVG9wV2lkdGgpICsgcGFyc2VGbG9hdCh0LmJvcmRlckJvdHRvbVdpZHRoKSwgaXNOYU4ocykgJiYgKHMgPSAwKSwgbygpOwogICAgICAgICAgfSgpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gcihlKSB7CiAgICAgICAgdmFyIHQgPSBpLmdldChlKTsKICAgICAgICB0ICYmIHQuZGVzdHJveSgpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBvKGUpIHsKICAgICAgICB2YXIgdCA9IGkuZ2V0KGUpOwogICAgICAgIHQgJiYgdC51cGRhdGUoKTsKICAgICAgfQoKICAgICAgdmFyIGkgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBNYXAgPyBuZXcgTWFwKCkgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGUgPSBbXSwKICAgICAgICAgICAgdCA9IFtdOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICBoYXM6IGZ1bmN0aW9uIGhhcyh0KSB7CiAgICAgICAgICAgIHJldHVybiBlLmluZGV4T2YodCkgPiAtMTsKICAgICAgICAgIH0sCiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldChuKSB7CiAgICAgICAgICAgIHJldHVybiB0W2UuaW5kZXhPZihuKV07CiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobiwgcikgewogICAgICAgICAgICAtMSA9PT0gZS5pbmRleE9mKG4pICYmIChlLnB1c2gobiksIHQucHVzaChyKSk7CiAgICAgICAgICB9LAogICAgICAgICAgImRlbGV0ZSI6IGZ1bmN0aW9uIF9kZWxldGUobikgewogICAgICAgICAgICB2YXIgciA9IGUuaW5kZXhPZihuKTsKICAgICAgICAgICAgciA+IC0xICYmIChlLnNwbGljZShyLCAxKSwgdC5zcGxpY2UociwgMSkpOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0oKSwKICAgICAgICAgIGEgPSBmdW5jdGlvbiBhKGUpIHsKICAgICAgICByZXR1cm4gbmV3IEV2ZW50KGUsIHsKICAgICAgICAgIGJ1YmJsZXM6ICEwCiAgICAgICAgfSk7CiAgICAgIH07CgogICAgICB0cnkgewogICAgICAgIG5ldyBFdmVudCgidGVzdCIpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgYSA9IGZ1bmN0aW9uIGEoZSkgewogICAgICAgICAgdmFyIHQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgiRXZlbnQiKTsKICAgICAgICAgIHJldHVybiB0LmluaXRFdmVudChlLCAhMCwgITEpLCB0OwogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBzID0gbnVsbDsKICAgICAgInVuZGVmaW5lZCIgPT0gdHlwZW9mIHdpbmRvdyB8fCAiZnVuY3Rpb24iICE9IHR5cGVvZiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSA/IChzID0gZnVuY3Rpb24gcyhlKSB7CiAgICAgICAgcmV0dXJuIGU7CiAgICAgIH0sIHMuZGVzdHJveSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGU7CiAgICAgIH0sIHMudXBkYXRlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZTsKICAgICAgfSkgOiAocyA9IGZ1bmN0aW9uIHMoZSwgdCkgewogICAgICAgIHJldHVybiBlICYmIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZS5sZW5ndGggPyBlIDogW2VdLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIG4oZSk7CiAgICAgICAgfSksIGU7CiAgICAgIH0sIHMuZGVzdHJveSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChlLmxlbmd0aCA/IGUgOiBbZV0sIHIpLCBlOwogICAgICB9LCBzLnVwZGF0ZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChlLmxlbmd0aCA/IGUgOiBbZV0sIG8pLCBlOwogICAgICB9KSwgdFsiZGVmYXVsdCJdID0gcywgZS5leHBvcnRzID0gdFsiZGVmYXVsdCJdOwogICAgfSk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICBmdW5jdGlvbiByKGUpIHsKICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsKICAgICAgICAiZGVmYXVsdCI6IGUKICAgICAgfTsKICAgIH0KCiAgICBmdW5jdGlvbiBvKGUpIHsKICAgICAgcmV0dXJuICEhZSAmJiB0aGlzLmluaXQoZSksIHRoaXM7CiAgICB9CgogICAgZnVuY3Rpb24gaShlKSB7CiAgICAgIHJldHVybiBuZXcgbyhlKTsKICAgIH0KCiAgICB2YXIgYSA9IG4oMjYpLAogICAgICAgIHMgPSByKGEpLAogICAgICAgIGwgPSBuKDE3KSwKICAgICAgICBjID0gcihsKSwKICAgICAgICB1ID0gbigyMCksCiAgICAgICAgZCA9IHIodSksCiAgICAgICAgcCA9IG4oNiksCiAgICAgICAgZiA9IHIocCksCiAgICAgICAgaCA9IG4oMiksCiAgICAgICAgdiA9IG4oMjQpLAogICAgICAgIGcgPSByKHYpLAogICAgICAgIG0gPSBuKDApLAogICAgICAgIHkgPSByKG0pLAogICAgICAgIGIgPSBuKDIyKSwKICAgICAgICB3ID0gcihiKSwKICAgICAgICB4ID0gbigxOSksCiAgICAgICAgayA9IHIoeCksCiAgICAgICAgXyA9IG4oMjMpLAogICAgICAgIEEgPSBuKDI1KSwKICAgICAgICBTID0gcihBKSwKICAgICAgICBPID0gbigyMSksCiAgICAgICAgJCA9IHIoTyksCiAgICAgICAgRSA9IHsKICAgICAgY29tbWVudDogIiIsCiAgICAgIG5pY2s6ICIiLAogICAgICBtYWlsOiAiIiwKICAgICAgbGluazogIiIsCiAgICAgIHVhOiB5WyJkZWZhdWx0Il0udWEsCiAgICAgIHVybDogIiIsCiAgICAgIFFRQXZhdGFyOiAiIgogICAgfSwKICAgICAgICBqID0gIiIsCiAgICAgICAgVCA9IHsKICAgICAgY2RuOiAiaHR0cHM6Ly9ncmF2YXRhci5sb2xpLm5ldC9hdmF0YXIvIiwKICAgICAgZHM6IFsibXAiLCAiaWRlbnRpY29uIiwgIm1vbnN0ZXJpZCIsICJ3YXZhdGFyIiwgInJvYm9oYXNoIiwgInJldHJvIiwgIiJdLAogICAgICBwYXJhbXM6ICIiLAogICAgICBoaWRlOiAhMQogICAgfTsKCiAgICBvLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKCJ1bmRlZmluZWQiID09IHR5cGVvZiBkb2N1bWVudCkgdGhyb3cgbmV3IEVycm9yKCJTb3JyeSwgVmFsaW5lIGRvZXMgbm90IHN1cHBvcnQgU2VydmVyLXNpZGUgcmVuZGVyaW5nLiIpOwogICAgICB2YXIgdCA9IHRoaXM7CiAgICAgIHJldHVybiBlICYmIChlID0geVsiZGVmYXVsdCJdLmV4dGVuZChoLmRlZmF1bHRDb25maWcsIGUpLCB0LmkxOG4gPSAoMCwgZFsiZGVmYXVsdCJdKShlLmxhbmcgfHwgeVsiZGVmYXVsdCJdLmxhbmcsIGUubGFuZ01vZGUpLCB0LmNvbmZpZyA9IGUsIGZbImRlZmF1bHQiXS5tYXBzID0gISFlLmVtb2ppTWFwcyAmJiBlLmVtb2ppTWFwcyB8fCBmWyJkZWZhdWx0Il0ubWFwcywgZlsiZGVmYXVsdCJdLmNkbiA9ICEhZS5lbW9qaUNETiAmJiBlLmVtb2ppQ0ROIHx8IGZbImRlZmF1bHQiXS5jZG4sIHQuX2luaXQoKSksIHQ7CiAgICB9LCBvLnByb3RvdHlwZS5faW5pdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGUgPSB0aGlzOwoKICAgICAgdHJ5IHsKICAgICAgICB2YXIgdCA9IGUuY29uZmlnLAogICAgICAgICAgICBuID0gdC5hdmF0YXIsCiAgICAgICAgICAgIHIgPSB0LmF2YXRhckZvcmNlLAogICAgICAgICAgICBvID0gdC5hdmF0YXJfY2RuLAogICAgICAgICAgICBpID0gdC52aXNpdG9yLAogICAgICAgICAgICBhID0gdC5wYXRoLAogICAgICAgICAgICBzID0gdm9pZCAwID09PSBhID8gbG9jYXRpb24ucGF0aG5hbWUgOiBhLAogICAgICAgICAgICBsID0gdC5wYWdlU2l6ZSwKICAgICAgICAgICAgYyA9IHQucmVjb3JkSVA7CiAgICAgICAgZS5jb25maWcucGF0aCA9IHMucmVwbGFjZSgvaW5kZXhcLmh0bWw/JC8sICIiKTsKICAgICAgICB2YXIgdSA9IFQuZHMsCiAgICAgICAgICAgIGQgPSByID8gIiZxPSIgKyBoLlJhbmRvbVN0ciA6ICIiOwogICAgICAgIFQucGFyYW1zID0gIj9kPSIgKyAodS5pbmRleE9mKG4pID4gLTEgPyBuIDogIm1wIikgKyAiJnY9IiArIGguVkVSU0lPTiArIGQsIFQuaGlkZSA9ICJoaWRlIiA9PT0gbiwgVC5jZG4gPSAvXmh0dHBzP1w6XC9cLy8udGVzdChvKSA/IG8gOiBULmNkbiwgZS5jb25maWcucGFnZVNpemUgPSBpc05hTihsKSA/IDEwIDogbCA8IDEgPyAxMCA6IGwsIGMgJiYgKDAsIF8ucmVjb3JkSVBGbikoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBFLmlwID0gZTsKICAgICAgICB9KTsKICAgICAgICB2YXIgcCA9IGUuY29uZmlnLmVsIHx8IG51bGwsCiAgICAgICAgICAgIGYgPSAoMCwgeVsiZGVmYXVsdCJdKShwKTsKCiAgICAgICAgaWYgKHAgPSBwIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgPyBwIDogZltmLmxlbmd0aCAtIDFdIHx8IG51bGwpIHsKICAgICAgICAgIGUuJGVsID0gKDAsIHlbImRlZmF1bHQiXSkocCksIGUuJGVsLmFkZENsYXNzKCJ2IikuYXR0cigiZGF0YS1jbGFzcyIsICJ2IiksIFQuaGlkZSAmJiBlLiRlbC5hZGRDbGFzcygiaGlkZS1hdmF0YXIiKSwgZS5jb25maWcubWV0YSA9IChlLmNvbmZpZy5ndWVzdF9pbmZvIHx8IGUuY29uZmlnLm1ldGEgfHwgaC5kZWZhdWx0TWV0YSkuZmlsdGVyKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHJldHVybiBoLmRlZmF1bHRNZXRhLmluZGV4T2YoZSkgPiAtMTsKICAgICAgICAgIH0pLCBlLmNvbmZpZy5yZXF1aXJlZEZpZWxkcyA9IGUuY29uZmlnLnJlcXVpcmVkRmllbGRzLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICAgICAgICByZXR1cm4gaC5kZWZhdWx0TWV0YS5pbmRleE9mKGUpID4gLTE7CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciB2ID0gKDAgPT0gZS5jb25maWcubWV0YS5sZW5ndGggPyBoLmRlZmF1bHRNZXRhIDogZS5jb25maWcubWV0YSkubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHZhciBuID0gIm1haWwiID09IHQgPyAiZW1haWwiIDogInRleHQiOwogICAgICAgICAgICByZXR1cm4gaC5kZWZhdWx0TWV0YS5pbmRleE9mKHQpID4gLTEgPyAnPGlucHV0IG5hbWU9IicgKyB0ICsgJyIgcGxhY2Vob2xkZXI9IicgKyBlLmkxOG4udCh0KSArICciIGNsYXNzPSJ2JyArIHQgKyAnIHZpbnB1dCIgdHlwZT0iJyArIG4gKyAnIj4nIDogIiI7CiAgICAgICAgICB9KSwKICAgICAgICAgICAgICBnID0gJzxkaXYgY2xhc3M9InZwYW5lbCI+PGRpdiBjbGFzcz0idndyYXAiPjxwIGNsYXNzPSJjYW5jZWwtcmVwbHkgdGV4dC1yaWdodCIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiIHRpdGxlPSInICsgZS5pMThuLnQoImNhbmNlbFJlcGx5IikgKyAnIj48c3ZnIGNsYXNzPSJ2aWNvbiBjYW5jZWwtcmVwbHktYnRuIiB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgcC1pZD0iNDIyMCIgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIj48cGF0aCBkPSJNNzk2LjQ1NCA5ODVIMjI3LjU0NWMtNTAuMTgzIDAtOTcuNDgxLTE5LjY2Mi0xMzMuMTgzLTU1LjM2My0zNS43LTM1LjcwMS01NS4zNjItODMtNTUuMzYyLTEzMy4xODNWMjI3LjU0NWMwLTUwLjE4MyAxOS42NjItOTcuNDgxIDU1LjM2My0xMzMuMTgzIDM1LjcwMS0zNS43IDgzLTU1LjM2MiAxMzMuMTgyLTU1LjM2Mmg1NjguOTA5YzUwLjE4MyAwIDk3LjQ4MSAxOS42NjIgMTMzLjE4MyA1NS4zNjMgMzUuNzAxIDM1LjcwMiA1NS4zNjMgODMgNTUuMzYzIDEzMy4xODN2NTY4LjkwOWMwIDUwLjE4My0xOS42NjIgOTcuNDgxLTU1LjM2MyAxMzMuMTgzUzg0Ni42MzcgOTg1IDc5Ni40NTQgOTg1ek0yMjcuNTQ1IDkxQzE1Mi4yNTQgOTEgOTEgMTUyLjI1NCA5MSAyMjcuNTQ1djU2OC45MDlDOTEgODcxLjc0NiAxNTIuMjU0IDkzMyAyMjcuNTQ1IDkzM2g1NjguOTA5Qzg3MS43NDYgOTMzIDkzMyA4NzEuNzQ2IDkzMyA3OTYuNDU0VjIyNy41NDVDOTMzIDE1Mi4yNTQgODcxLjc0NiA5MSA3OTYuNDU0IDkxSDIyNy41NDV6IiBwLWlkPSI0MjIxIj48L3BhdGg+PHBhdGggZD0iTTU2OC41NjkgNTEybDE3MC4yNjctMTcwLjI2N2MxNS41NTYtMTUuNTU2IDE1LjU1Ni00MS4wMTIgMC01Ni41NjlzLTQxLjAxMi0xNS41NTYtNTYuNTY5IDBMNTEyIDQ1NS40MzEgMzQxLjczMyAyODUuMTY1Yy0xNS41NTYtMTUuNTU2LTQxLjAxMi0xNS41NTYtNTYuNTY5IDBzLTE1LjU1NiA0MS4wMTIgMCA1Ni41NjlMNDU1LjQzMSA1MTIgMjg1LjE2NSA2ODIuMjY3Yy0xNS41NTYgMTUuNTU2LTE1LjU1NiA0MS4wMTIgMCA1Ni41NjkgMTUuNTU2IDE1LjU1NiA0MS4wMTIgMTUuNTU2IDU2LjU2OSAwTDUxMiA1NjguNTY5bDE3MC4yNjcgMTcwLjI2N2MxNS41NTYgMTUuNTU2IDQxLjAxMiAxNS41NTYgNTYuNTY5IDAgMTUuNTU2LTE1LjU1NiAxNS41NTYtNDEuMDEyIDAtNTYuNTY5TDU2OC41NjkgNTEyeiIgcC1pZD0iNDIyMiIgPjwvcGF0aD48L3N2Zz48L3A+PGRpdiBjbGFzcz0idmhlYWRlciBpdGVtJyArIHYubGVuZ3RoICsgJyI+JyArIHYuam9pbigiIikgKyAnPC9kaXY+PGRpdiBjbGFzcz0idmVkaXQiPjx0ZXh0YXJlYSBpZD0idmVkaXRvciIgY2xhc3M9InZlZGl0b3IgdmlucHV0IiBwbGFjZWhvbGRlcj0iJyArIGUuY29uZmlnLnBsYWNlaG9sZGVyICsgJyI+PC90ZXh0YXJlYT48ZGl2IGNsYXNzPSJ2cm93Ij48ZGl2IGNsYXNzPSJ2Y29sIHZjb2wtNjAgc3RhdHVzLWJhciI+PC9kaXY+PGRpdiBjbGFzcz0idmNvbCB2Y29sLTQwIHZjdHJsIHRleHQtcmlnaHQiPjxzcGFuIHRpdGxlPSInICsgZS5pMThuLnQoImVtb2ppIikgKyAnIiAgY2xhc3M9InZpY29uIHZlbW9qaS1idG4iPjxzdmcgIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBwLWlkPSIxNjE3MiIgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiA+PHBhdGggZD0iTTUxMiAxMDI0YTUxMiA1MTIgMCAxIDEgNTEyLTUxMiA1MTIgNTEyIDAgMCAxLTUxMiA1MTJ6TTUxMiA1Ni44ODg4ODlhNDU1LjExMTExMSA0NTUuMTExMTExIDAgMSAwIDQ1NS4xMTExMTEgNDU1LjExMTExMSA0NTUuMTExMTExIDQ1NS4xMTExMTEgMCAwIDAtNDU1LjExMTExMS00NTUuMTExMTExek0zMTIuODg4ODg5IDUxMkE4NS4zMzMzMzMgODUuMzMzMzMzIDAgMSAxIDM5OC4yMjIyMjIgNDI2LjY2NjY2NyA4NS4zMzMzMzMgODUuMzMzMzMzIDAgMCAxIDMxMi44ODg4ODkgNTEyeiIgcC1pZD0iMTYxNzMiPjwvcGF0aD48cGF0aCBkPSJNNTEyIDc2OEExNDIuMjIyMjIyIDE0Mi4yMjIyMjIgMCAwIDEgMzY5Ljc3Nzc3OCA2MjUuNzc3Nzc4YTI4LjQ0NDQ0NCAyOC40NDQ0NDQgMCAwIDEgNTYuODg4ODg5IDAgODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMCAxNzAuNjY2NjY2IDAgMjguNDQ0NDQ0IDI4LjQ0NDQ0NCAwIDAgMSA1Ni44ODg4ODkgMEExNDIuMjIyMjIyIDE0Mi4yMjIyMjIgMCAwIDEgNTEyIDc2OHoiIHAtaWQ9IjE2MTc0Ij48L3BhdGg+PHBhdGggZD0iTTc4Mi4yMjIyMjIgMzkxLjk2NDQ0NGwtMTEzLjc3Nzc3OCA1OS43MzMzMzRhMjkuMDEzMzMzIDI5LjAxMzMzMyAwIDAgMS0zOC42ODQ0NDQtMTAuODA4ODg5IDI4LjQ0NDQ0NCAyOC40NDQ0NDQgMCAwIDEgMTAuMjQtMzguNjg0NDQ1bDExMy43Nzc3NzgtNTYuODg4ODg4YTI4LjQ0NDQ0NCAyOC40NDQ0NDQgMCAwIDEgMzguNjg0NDQ0IDEwLjI0IDI4LjQ0NDQ0NCAyOC40NDQ0NDQgMCAwIDEtMTAuMjQgMzYuNDA4ODg4eiIgcC1pZD0iMTYxNzUiPjwvcGF0aD48cGF0aCBkPSJNNjQwLjU2ODg4OSA0NTEuNjk3Nzc4bDExMy43Nzc3NzggNTYuODg4ODg5YTI3Ljg3NTU1NiAyNy44NzU1NTYgMCAwIDAgMzguNjg0NDQ0LTEwLjI0IDI3Ljg3NTU1NiAyNy44NzU1NTYgMCAwIDAtMTAuMjQtMzguNjg0NDQ1bC0xMTMuNzc3Nzc4LTU2Ljg4ODg4OWEyOC40NDQ0NDQgMjguNDQ0NDQ0IDAgMCAwLTM4LjY4NDQ0NCAxMC44MDg4ODkgMjguNDQ0NDQ0IDI4LjQ0NDQ0NCAwIDAgMCAxMC4yNCAzOC4xMTU1NTZ6IiBwLWlkPSIxNjE3NiI+PC9wYXRoPjwvc3ZnPjwvc3Bhbj48c3BhbiB0aXRsZT0iJyArIGUuaTE4bi50KCJwcmV2aWV3IikgKyAnIiBjbGFzcz0idmljb24gdnByZXZpZXctYnRuIj48c3ZnICB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgcC1pZD0iMTc2ODgiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PHBhdGggZD0iTTUwMi4zOTAxNTQgOTM1LjM4NDYxNWEyOS41Mzg0NjIgMjkuNTM4NDYyIDAgMSAxIDAgNTkuMDc2OTIzSDE0MS40MzAxNTRDNzkuOTExMzg1IDk5NC40NjE1MzggMjkuNTM4NDYyIDk0Ni4yNTQ3NjkgMjkuNTM4NDYyIDg4Ni4xNTM4NDZWMTM3Ljg0NjE1NEMyOS41Mzg0NjIgNzcuNzQ1MjMxIDc5Ljk1MDc2OSAyOS41Mzg0NjIgMTQxLjM5MDc2OSAyOS41Mzg0NjJoNzQxLjIxODQ2MmM2MS40NCAwIDExMS44NTIzMDggNDguMjA2NzY5IDExMS44NTIzMDcgMTA4LjMwNzY5MnYzMDAuMjY4MzA4YTI5LjUzODQ2MiAyOS41Mzg0NjIgMCAxIDEtNTkuMDc2OTIzIDBWMTM3Ljg0NjE1NGMwLTI2Ljg5OTY5Mi0yMy4zNTUwNzctNDkuMjMwNzY5LTUyLjc3NTM4NC00OS4yMzA3NjlIMTQxLjM5MDc2OWMtMjkuNDIwMzA4IDAtNTIuNzc1Mzg1IDIyLjMzMTA3Ny01Mi43NzUzODQgNDkuMjMwNzY5djc0OC4zMDc2OTJjMCAyNi44OTk2OTIgMjMuMzU1MDc3IDQ5LjIzMDc2OSA1Mi43NzUzODQgNDkuMjMwNzY5aDM2MC45OTkzODV6IiBwLWlkPSIxNzY4OSI+PC9wYXRoPjxwYXRoIGQ9Ik0xOTYuOTIzMDc3IDIxNi42MTUzODVtMjkuNTM4NDYxIDBsMzc0LjE1Mzg0NyAwcTI5LjUzODQ2MiAwIDI5LjUzODQ2MSAyOS41Mzg0NjFsMCAwcTAgMjkuNTM4NDYyLTI5LjUzODQ2MSAyOS41Mzg0NjJsLTM3NC4xNTM4NDcgMHEtMjkuNTM4NDYyIDAtMjkuNTM4NDYxLTI5LjUzODQ2MmwwIDBxMC0yOS41Mzg0NjIgMjkuNTM4NDYxLTI5LjUzODQ2MVoiIHAtaWQ9IjE3NjkwIj48L3BhdGg+PHBhdGggZD0iTTY0OS44NDYxNTQgODQ2Ljc2OTIzMWEyMTYuNjE1Mzg1IDIxNi42MTUzODUgMCAxIDAgMC00MzMuMjMwNzY5IDIxNi42MTUzODUgMjE2LjYxNTM4NSAwIDAgMCAwIDQzMy4yMzA3Njl6IG0wIDU5LjA3NjkyM2EyNzUuNjkyMzA4IDI3NS42OTIzMDggMCAxIDEgMC01NTEuMzg0NjE2IDI3NS42OTIzMDggMjc1LjY5MjMwOCAwIDAgMSAwIDU1MS4zODQ2MTZ6IiBwLWlkPSIxNzY5MSI+PC9wYXRoPjxwYXRoIGQ9Ik04MDcuMzk4MzgzIDgyOS40Nzk3NjhtMjAuODg2ODQ3LTIwLjg4Njg0NmwwIDBxMjAuODg2ODQ2LTIwLjg4Njg0NiA0MS43NzM2OTIgMGwxMjUuMzIxMDc5IDEyNS4zMjEwNzlxMjAuODg2ODQ2IDIwLjg4Njg0NiAwIDQxLjc3MzY5M2wwIDBxLTIwLjg4Njg0NiAyMC44ODY4NDYtNDEuNzczNjkzIDBsLTEyNS4zMjEwNzgtMTI1LjMyMTA3OXEtMjAuODg2ODQ2LTIwLjg4Njg0NiAwLTQxLjc3MzY5M1oiIHAtaWQ9IjE3NjkyIj48L3BhdGg+PC9zdmc+PC9zcGFuPjwvZGl2PjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9InZyb3ciPjxkaXYgY2xhc3M9InZjb2wgdmNvbC0zMCIgPjxhIGFsdD0iTWFya2Rvd24gaXMgc3VwcG9ydGVkIiBocmVmPSJodHRwczovL2d1aWRlcy5naXRodWIuY29tL2ZlYXR1cmVzL21hc3RlcmluZy1tYXJrZG93bi8iIGNsYXNzPSJ2aWNvbiIgdGFyZ2V0PSJfYmxhbmsiPjxzdmcgY2xhc3M9Im1hcmtkb3duIiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBhcmlhLWhpZGRlbj0idHJ1ZSI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTQuODUgM0gxLjE1Qy41MiAzIDAgMy41MiAwIDQuMTV2Ny42OUMwIDEyLjQ4LjUyIDEzIDEuMTUgMTNoMTMuNjljLjY0IDAgMS4xNS0uNTIgMS4xNS0xLjE1di03LjdDMTYgMy41MiAxNS40OCAzIDE0Ljg1IDN6TTkgMTFIN1Y4TDUuNSA5LjkyIDQgOHYzSDJWNWgybDEuNSAyTDcgNWgydjZ6bTIuOTkuNUw5LjUgOEgxMVY1aDJ2M2gxLjVsLTIuNTEgMy41eiI+PC9wYXRoPjwvc3ZnPjwvYT48L2Rpdj48ZGl2IGNsYXNzPSJ2Y29sIHZjb2wtNzAgdGV4dC1yaWdodCI+PGJ1dHRvbiB0eXBlPSJidXR0b24iICB0aXRsZT0iQ21kfEN0cmwrRW50ZXIiIGNsYXNzPSJ2c3VibWl0IHZidG4iPicgKyBlLmkxOG4udCgic3VibWl0IikgKyAnPC9idXR0b24+PC9kaXY+PC9kaXY+PGRpdiBjbGFzcz0idmVtb2ppcyIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPjwvZGl2PjxkaXYgY2xhc3M9InZpbnB1dCB2cHJldmlldyIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPjwvZGl2PjxkaXYgc3R5bGU9ImRpc3BsYXk6bm9uZTsiIGNsYXNzPSJ2bWFyayI+PC9kaXY+PC9kaXY+PC9kaXY+PGRpdiBjbGFzcz0idmNvdW50IiBzdHlsZT0iZGlzcGxheTpub25lOyI+PHNwYW4gY2xhc3M9InZudW0iPjA8L3NwYW4+ICcgKyBlLmkxOG4udCgiY29tbWVudHMiKSArICc8L2Rpdj48ZGl2IGNsYXNzPSJ2bG9hZC10b3AgdGV4dC1jZW50ZXIiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij48aSBjbGFzcz0idnNwaW5uZXIiIHN0eWxlPSJ3aWR0aDozMHB4O2hlaWdodDozMHB4OyI+PC9pPjwvZGl2PjxkaXYgY2xhc3M9InZjYXJkcyI+PC9kaXY+PGRpdiBjbGFzcz0idmxvYWQtYm90dG9tIHRleHQtY2VudGVyIiBzdHlsZT0iZGlzcGxheTpub25lOyI+PGkgY2xhc3M9InZzcGlubmVyIiBzdHlsZT0id2lkdGg6MzBweDtoZWlnaHQ6MzBweDsiPjwvaT48L2Rpdj48ZGl2IGNsYXNzPSJ2ZW1wdHkiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij48L2Rpdj48ZGl2IGNsYXNzPSJ2cGFnZSB0eHQtY2VudGVyIiBzdHlsZT0iZGlzcGxheTpub25lIj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9InZtb3JlIHZidG4iPicgKyBlLmkxOG4udCgibW9yZSIpICsgJzwvYnV0dG9uPjwvZGl2PjxkaXYgY2xhc3M9InZwb3dlciB0eHQtcmlnaHQiPlBvd2VyZWQgQnkgPGEgaHJlZj0iaHR0cHM6Ly92YWxpbmUuanMub3JnIiB0YXJnZXQ9Il9ibGFuayI+VmFsaW5lPC9hPjxicj52JyArIGguVkVSU0lPTiArICI8L2Rpdj4iOwogICAgICAgICAgZS4kZWwuaHRtbChnKSwgZS4kZWwuZmluZCgiLmNhbmNlbC1yZXBseSIpLm9uKCJjbGljayIsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIGUucmVzZXQoKTsKICAgICAgICAgIH0pOwogICAgICAgICAgdmFyIG0gPSBlLiRlbC5maW5kKCIudmVtcHR5Iik7CiAgICAgICAgICBlLiRub2RhdGEgPSB7CiAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uIHNob3codCkgewogICAgICAgICAgICAgIHJldHVybiBtLmh0bWwodCB8fCBlLmkxOG4udCgic29mYSIpKS5zaG93KCksIGU7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGhpZGU6IGZ1bmN0aW9uIGhpZGUoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG0uaGlkZSgpLCBlOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgdmFyIGIgPSBlLiRlbC5maW5kKCIudmxvYWQtYm90dG9tIiksCiAgICAgICAgICAgICAgdyA9IGUuJGVsLmZpbmQoIi52bG9hZC10b3AiKTsKICAgICAgICAgIGUuJGxvYWRpbmcgPSB7CiAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uIHNob3codCkgewogICAgICAgICAgICAgIHJldHVybiB0ICYmIHcuc2hvdygpIHx8IGIuc2hvdygpLCBlLiRub2RhdGEuaGlkZSgpLCBlOwogICAgICAgICAgICB9LAogICAgICAgICAgICBoaWRlOiBmdW5jdGlvbiBoaWRlKCkgewogICAgICAgICAgICAgIHJldHVybiB3LmhpZGUoKSwgYi5oaWRlKCksIDAgPT09IGUuJGVsLmZpbmQoIi52Y2FyZCIpLmxlbmd0aCAmJiBlLiRub2RhdGEuc2hvdygpLCBlOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgKDAsIGtbImRlZmF1bHQiXSkoZS5jb25maWcsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICB2YXIgbiA9ICgwLCB5WyJkZWZhdWx0Il0pKCIudmFsaW5lLWNvbW1lbnQtY291bnQiKSwKICAgICAgICAgICAgICByID0gMDsKICAgICAgICAgICFmdW5jdGlvbiB0KG4pIHsKICAgICAgICAgICAgdmFyIG8gPSBuW3IrK107CgogICAgICAgICAgICBpZiAobykgewogICAgICAgICAgICAgIHZhciBpID0gKDAsIHlbImRlZmF1bHQiXSkobykuYXR0cigiZGF0YS14aWQiKTsKICAgICAgICAgICAgICAhIWkgJiYgZS5RKGkpLmNvdW50KCkudGhlbihmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgby5pbm5lclRleHQgPSBlLCB0KG4pOwogICAgICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBvLmlubmVyVGV4dCA9IDA7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0obiksIGkgJiYgSS5hZGQoQVYuT2JqZWN0LmV4dGVuZCgiQ291bnRlciIpLCBlLmNvbmZpZy5wYXRoKSwgZS4kZWwgJiYgZS5iaW5kKCk7CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAoMCwgJFsiZGVmYXVsdCJdKShlLCB0LCAiaW5pdCIpOwogICAgICB9CiAgICB9OwoKICAgIHZhciBDID0gZnVuY3Rpb24gQyhlLCB0KSB7CiAgICAgIHZhciBuID0gbmV3IGUoKSwKICAgICAgICAgIHIgPSBuZXcgQVYuQUNMKCk7CiAgICAgIHIuc2V0UHVibGljUmVhZEFjY2VzcyghMCksIHIuc2V0UHVibGljV3JpdGVBY2Nlc3MoITApLCBuLnNldEFDTChyKSwgbi5zZXQoInVybCIsIHQudXJsKSwgbi5zZXQoInhpZCIsIHQueGlkKSwgbi5zZXQoInRpdGxlIiwgdC50aXRsZSksIG4uc2V0KCJ0aW1lIiwgMSksIG4uc2F2ZSgpLnRoZW4oZnVuY3Rpb24gKGUpIHsKICAgICAgICAoMCwgeVsiZGVmYXVsdCJdKSh0LmVsKS5maW5kKCIubGVhbmNsb3VkLXZpc2l0b3JzLWNvdW50IikudGV4dCgxKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGUpIHt9KTsKICAgIH0sCiAgICAgICAgSSA9IHsKICAgICAgYWRkOiBmdW5jdGlvbiBhZGQoZSwgdCkgewogICAgICAgIHZhciBuID0gdGhpcywKICAgICAgICAgICAgciA9ICgwLCB5WyJkZWZhdWx0Il0pKCIubGVhbmNsb3VkX3Zpc2l0b3JzLC5sZWFuY2xvdWQtdmlzaXRvcnMiKTsKCiAgICAgICAgaWYgKDEgPT09IHIubGVuZ3RoKSB7CiAgICAgICAgICB2YXIgbyA9IHJbMF0sCiAgICAgICAgICAgICAgaSA9IGRlY29kZVVSSSgoMCwgeVsiZGVmYXVsdCJdKShvKS5hdHRyKCJpZCIpKSwKICAgICAgICAgICAgICBhID0gKDAsIHlbImRlZmF1bHQiXSkobykuYXR0cigiZGF0YS1mbGFnLXRpdGxlIiksCiAgICAgICAgICAgICAgcyA9IGVuY29kZVVSSShpKSwKICAgICAgICAgICAgICBsID0gewogICAgICAgICAgICBlbDogbywKICAgICAgICAgICAgdXJsOiBpLAogICAgICAgICAgICB4aWQ6IHMsCiAgICAgICAgICAgIHRpdGxlOiBhCiAgICAgICAgICB9OwoKICAgICAgICAgIGlmIChkZWNvZGVVUkkoaSkgPT09IGRlY29kZVVSSSh0KSkgewogICAgICAgICAgICB2YXIgYyA9IG5ldyBBVi5RdWVyeShlKTsKICAgICAgICAgICAgYy5lcXVhbFRvKCJ1cmwiLCBpKSwgYy5maW5kKCkudGhlbihmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGlmICh0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHZhciBuID0gdFswXTsKICAgICAgICAgICAgICAgIG4uaW5jcmVtZW50KCJ0aW1lIiksIG4uc2F2ZSgpLnRoZW4oZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgKDAsIHlbImRlZmF1bHQiXSkobykuZmluZCgiLmxlYW5jbG91ZC12aXNpdG9ycy1jb3VudCIpLnRleHQoZS5nZXQoInRpbWUiKSk7CiAgICAgICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZSkge30pOwogICAgICAgICAgICAgIH0gZWxzZSBDKGUsIGwpOwogICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIDEwMSA9PSB0LmNvZGUgPyBDKGUsIGwpIDogKDAsICRbImRlZmF1bHQiXSkobiwgdCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIEkuc2hvdyhlLCByKTsKICAgICAgICB9IGVsc2UgSS5zaG93KGUsIHIpOwogICAgICB9LAogICAgICBzaG93OiBmdW5jdGlvbiBzaG93KGUsIHQpIHsKICAgICAgICB2YXIgbiA9IFtdOwoKICAgICAgICBpZiAodC5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB2YXIgdCA9ICgwLCB5WyJkZWZhdWx0Il0pKGUpLmZpbmQoIi5sZWFuY2xvdWQtdmlzaXRvcnMtY291bnQiKTsKICAgICAgICAgIHQgJiYgdC50ZXh0KCIwIiksIG4ucHVzaCgvXCUvLnRlc3QoKDAsIHlbImRlZmF1bHQiXSkoZSkuYXR0cigiaWQiKSkgPyBkZWNvZGVVUkkoKDAsIHlbImRlZmF1bHQiXSkoZSkuYXR0cigiaWQiKSkgOiAoMCwgeVsiZGVmYXVsdCJdKShlKS5hdHRyKCJpZCIpKTsKICAgICAgICB9KSwgbi5sZW5ndGgpIHsKICAgICAgICAgIHZhciByID0gbmV3IEFWLlF1ZXJ5KGUpOwogICAgICAgICAgci5jb250YWluZWRJbigidXJsIiwgbiksIHIuZmluZCgpLnRoZW4oZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgZS5sZW5ndGggPiAwICYmIHQuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGUuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgdmFyIG4gPSBlLmdldCgieGlkIikgfHwgZW5jb2RlVVJJKGUuZ2V0KCJ1cmwiKSksCiAgICAgICAgICAgICAgICAgICAgciA9IGUuZ2V0KCJ0aW1lIiksCiAgICAgICAgICAgICAgICAgICAgbyA9ICgwLCB5WyJkZWZhdWx0Il0pKHQpLAogICAgICAgICAgICAgICAgICAgIGkgPSBvLmF0dHIoImlkIik7CgogICAgICAgICAgICAgICAgaWYgKCgvXCUvLnRlc3QoaSkgPyBpIDogZW5jb2RlVVJJKGkpKSA9PSBuKSB7CiAgICAgICAgICAgICAgICAgIHZhciBhID0gby5maW5kKCIubGVhbmNsb3VkLXZpc2l0b3JzLWNvdW50Iik7CiAgICAgICAgICAgICAgICAgIGEgJiYgYS50ZXh0KHIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlKSB7fSk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIG8ucHJvdG90eXBlLlEgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICBuID0gYXJndW1lbnRzLmxlbmd0aCwKICAgICAgICAgIHIgPSB0LmNvbmZpZy5jbGF6ek5hbWU7CgogICAgICBpZiAoMSA9PSBuKSB7CiAgICAgICAgdmFyIG8gPSBuZXcgQVYuUXVlcnkocik7CiAgICAgICAgby5kb2VzTm90RXhpc3QoInJpZCIpOwogICAgICAgIHZhciBpID0gbmV3IEFWLlF1ZXJ5KHIpOwogICAgICAgIGkuZXF1YWxUbygicmlkIiwgIiIpOwogICAgICAgIHZhciBhID0gQVYuUXVlcnkub3IobywgaSk7CiAgICAgICAgcmV0dXJuICIqIiA9PT0gZSA/IGEuZXhpc3RzKCJ1cmwiKSA6IGEuZXF1YWxUbygidXJsIiwgZGVjb2RlVVJJKGUpKSwgYS5hZGREZXNjZW5kaW5nKCJjcmVhdGVkQXQiKSwgYS5hZGREZXNjZW5kaW5nKCJpbnNlcnRlZEF0IiksIGE7CiAgICAgIH0KCiAgICAgIHZhciBzID0gSlNPTi5zdHJpbmdpZnkoYXJndW1lbnRzWzFdKS5yZXBsYWNlKC8oXFt8XF0pL2csICIiKSwKICAgICAgICAgIGwgPSAic2VsZWN0ICogZnJvbSAiICsgciArICIgd2hlcmUgcmlkIGluICgiICsgcyArICIpIG9yZGVyIGJ5IC1jcmVhdGVkQXQsLWNyZWF0ZWRBdCI7CiAgICAgIHJldHVybiBBVi5RdWVyeS5kb0Nsb3VkUXVlcnkobCk7CiAgICB9LCBvLnByb3RvdHlwZS5pbnN0YWxsTG9jYWxlID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgdmFyIG4gPSB0aGlzOwogICAgICByZXR1cm4gbi5pMThuKGUsIHQpLCBuOwogICAgfSwgby5wcm90b3R5cGUuc2V0UGF0aCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5wYXRoID0gZSwgdGhpczsKICAgIH0sIG8ucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBlID0gdGhpcywKICAgICAgICAgIHQgPSBlLiRlbC5maW5kKCIudmVtb2ppcyIpLAogICAgICAgICAgbiA9IGUuJGVsLmZpbmQoIi52cHJldmlldyIpLAogICAgICAgICAgciA9IGUuJGVsLmZpbmQoIi52ZW1vamktYnRuIiksCiAgICAgICAgICBvID0gZS4kZWwuZmluZCgiLnZwcmV2aWV3LWJ0biIpLAogICAgICAgICAgaSA9IGUuJGVsLmZpbmQoIi52ZWRpdG9yIiksCiAgICAgICAgICBhID0gZlsiZGVmYXVsdCJdLm1hcHMsCiAgICAgICAgICBsID0gITEsCiAgICAgICAgICB1ID0gZnVuY3Rpb24gdShlKSB7CiAgICAgICAgdmFyIG4gPSBbXTsKCiAgICAgICAgZm9yICh2YXIgciBpbiBhKSB7CiAgICAgICAgICBhLmhhc093blByb3BlcnR5KHIpICYmICEhZlsiZGVmYXVsdCJdLmJ1aWxkKHIpICYmIG4ucHVzaCgnPGkgdGl0bGU9IicgKyByICsgJyIgPicgKyBmWyJkZWZhdWx0Il0uYnVpbGQocikgKyAiPC9pPiIpOwogICAgICAgIH0KCiAgICAgICAgdC5odG1sKG4uam9pbigiIikpLCBsID0gITAsIHQuZmluZCgiaSIpLm9uKCJjbGljayIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCksIHgoaVswXSwgIiA6IiArICgwLCB5WyJkZWZhdWx0Il0pKHRoaXMpLmF0dHIoInRpdGxlIikgKyAiOiIpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgZS4kZW1vamkgPSB7CiAgICAgICAgc2hvdzogZnVuY3Rpb24gc2hvdygpIHsKICAgICAgICAgIHJldHVybiAhbCAmJiB1KCksIGUuJHByZXZpZXcuaGlkZSgpLCB0LnNob3coKSwgci5hZGRDbGFzcygiYWN0aXZlZCIpLCBlLiRlbW9qaTsKICAgICAgICB9LAogICAgICAgIGhpZGU6IGZ1bmN0aW9uIGhpZGUoKSB7CiAgICAgICAgICByZXR1cm4gci5yZW1vdmVDbGFzcygiYWN0aXZlZCIpLCB0LmhpZGUoKSwgZS4kZW1vamk7CiAgICAgICAgfQogICAgICB9LCBlLiRwcmV2aWV3ID0gewogICAgICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7CiAgICAgICAgICByZXR1cm4gaiA/IChlLiRlbW9qaS5oaWRlKCksIG8uYWRkQ2xhc3MoImFjdGl2ZWQiKSwgbi5odG1sKGopLnNob3coKSwgTSgpKSA6IGUuJHByZXZpZXcuaGlkZSgpLCBlLiRwcmV2aWV3OwogICAgICAgIH0sCiAgICAgICAgaGlkZTogZnVuY3Rpb24gaGlkZSgpIHsKICAgICAgICAgIHJldHVybiBvLnJlbW92ZUNsYXNzKCJhY3RpdmVkIiksIG4uaGlkZSgpLmh0bWwoIiIpLCBlLiRwcmV2aWV3OwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHZhciBkID0gZnVuY3Rpb24gZCh0KSB7CiAgICAgICAgdmFyIHIgPSAoMCwgd1siZGVmYXVsdCJdKSh0LnZhbCgpIHx8ICIiKTsKICAgICAgICByIHx8IGUuJHByZXZpZXcuaGlkZSgpLCBqICE9IHIgJiYgKGogPSByLCBvLmhhc0NsYXNzKCJhY3RpdmVkIikgPiAtMSAmJiBqICE9IG4uaHRtbCgpICYmIG4uaHRtbChqKSwgKDAsIGNbImRlZmF1bHQiXSkodFswXSksIE0oKSk7CiAgICAgIH07CgogICAgICByLm9uKCJjbGljayIsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgci5oYXNDbGFzcygiYWN0aXZlZCIpID8gZS4kZW1vamkuaGlkZSgpIDogZS4kZW1vamkuc2hvdygpOwogICAgICB9KSwgby5vbigiY2xpY2siLCBmdW5jdGlvbiAodCkgewogICAgICAgIG8uaGFzQ2xhc3MoImFjdGl2ZWQiKSA/IGUuJHByZXZpZXcuaGlkZSgpIDogZS4kcHJldmlldy5zaG93KCk7CiAgICAgIH0pOwogICAgICB2YXIgcCA9IGUuY29uZmlnLm1ldGEsCiAgICAgICAgICB2ID0ge30sCiAgICAgICAgICBtID0gewogICAgICAgIHZlZGl0b3I6ICJjb21tZW50IgogICAgICB9OwogICAgICBwLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBtWyJ2IiArIGVdID0gZTsKICAgICAgfSk7CgogICAgICBmb3IgKHZhciBiIGluIG0pIHsKICAgICAgICBtLmhhc093blByb3BlcnR5KGIpICYmIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB0ID0gbVtiXSwKICAgICAgICAgICAgICBuID0gZS4kZWwuZmluZCgiLiIgKyBiKTsKICAgICAgICAgIHZbdF0gPSBuLCBuLm9uKCJpbnB1dCBjaGFuZ2UgYmx1ciBwcm9wZXJ0eWNoYW5nZSIsIGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgIGUuY29uZmlnLmVuYWJsZVFRICYmICJibHVyIiA9PT0gci50eXBlICYmICJuaWNrIiA9PT0gdCAmJiAoaXNOYU4obi52YWwoKSkgPyB5WyJkZWZhdWx0Il0uc3RvcmUuZ2V0KGguUVFDYWNoZUtleSkgJiYgeVsiZGVmYXVsdCJdLnN0b3JlLmdldChoLlFRQ2FjaGVLZXkpLm5pY2sgIT0gbi52YWwoKSAmJiAoeVsiZGVmYXVsdCJdLnN0b3JlLnJlbW92ZShoLlFRQ2FjaGVLZXkpLCBFLm5pY2sgPSBuLnZhbCgpLCBFLm1haWwgPSAiIiwgRS5RUUF2YXRhciA9ICIiKSA6ICgwLCBfLmZldGNoUVFGbikobi52YWwoKSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICB2YXIgdCA9IGUubmljayB8fCBuLnZhbCgpLAogICAgICAgICAgICAgICAgICByID0gZS5xcSArICJAcXEuY29tIjsKICAgICAgICAgICAgICAoMCwgeVsiZGVmYXVsdCJdKSgiLnZuaWNrIikudmFsKHQpLCAoMCwgeVsiZGVmYXVsdCJdKSgiLnZtYWlsIikudmFsKHIpLCBFLm5pY2sgPSB0LCBFLm1haWwgPSByLCBFLlFRQXZhdGFyID0gZS5waWM7CiAgICAgICAgICAgIH0pKSwgImNvbW1lbnQiID09PSB0ID8gZChuKSA6IEVbdF0gPSB5WyJkZWZhdWx0Il0uZXNjYXBlKG4udmFsKCkucmVwbGFjZSgvKF5ccyopfChccyokKS9nLCAiIikpLnN1YnN0cmluZygwLCA0MCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KCk7CiAgICAgIH0KCiAgICAgIHZhciB4ID0gZnVuY3Rpb24geChlLCB0KSB7CiAgICAgICAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikgewogICAgICAgICAgZS5mb2N1cygpOwogICAgICAgICAgZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dCA9IHQsIGUuZm9jdXMoKTsKICAgICAgICB9IGVsc2UgaWYgKGUuc2VsZWN0aW9uU3RhcnQgfHwgIjAiID09IGUuc2VsZWN0aW9uU3RhcnQpIHsKICAgICAgICAgIHZhciBuID0gZS5zZWxlY3Rpb25TdGFydCwKICAgICAgICAgICAgICByID0gZS5zZWxlY3Rpb25FbmQsCiAgICAgICAgICAgICAgbyA9IGUuc2Nyb2xsVG9wOwogICAgICAgICAgZS52YWx1ZSA9IGUudmFsdWUuc3Vic3RyaW5nKDAsIG4pICsgdCArIGUudmFsdWUuc3Vic3RyaW5nKHIsIGUudmFsdWUubGVuZ3RoKSwgZS5mb2N1cygpLCBlLnNlbGVjdGlvblN0YXJ0ID0gbiArIHQubGVuZ3RoLCBlLnNlbGVjdGlvbkVuZCA9IG4gKyB0Lmxlbmd0aCwgZS5zY3JvbGxUb3AgPSBvOwogICAgICAgIH0gZWxzZSBlLmZvY3VzKCksIGUudmFsdWUgKz0gdDsKCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAodCkgewogICAgICAgICAgZCgoMCwgeVsiZGVmYXVsdCJdKShlKSk7CiAgICAgICAgfSwgMTAwKTsKICAgICAgfSwKICAgICAgICAgIGsgPSB7CiAgICAgICAgbm86IDEsCiAgICAgICAgc2l6ZTogZS5jb25maWcucGFnZVNpemUsCiAgICAgICAgc2tpcDogZS5jb25maWcucGFnZVNpemUKICAgICAgfSwKICAgICAgICAgIEEgPSBlLiRlbC5maW5kKCIudnBhZ2UiKTsKCiAgICAgIEEub24oImNsaWNrIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICBBLmhpZGUoKSwgay5ubysrLCBPKCk7CiAgICAgIH0pOwoKICAgICAgdmFyIE8gPSBmdW5jdGlvbiBPKCkgewogICAgICAgIHZhciB0ID0gay5zaXplLAogICAgICAgICAgICBuID0gay5ubywKICAgICAgICAgICAgciA9IE51bWJlcihlLiRlbC5maW5kKCIudm51bSIpLnRleHQoKSk7CiAgICAgICAgZS4kbG9hZGluZy5zaG93KCk7CiAgICAgICAgdmFyIG8gPSBlLlEoZS5jb25maWcucGF0aCk7CiAgICAgICAgby5saW1pdCh0KSwgby5za2lwKChuIC0gMSkgKiB0KSwgby5maW5kKCkudGhlbihmdW5jdGlvbiAobykgewogICAgICAgICAgaWYgKGsuc2tpcCA9IGsuc2l6ZSwgbyAmJiBvLmxlbmd0aCkgewogICAgICAgICAgICB2YXIgaSA9IFtdOwogICAgICAgICAgICBvLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBpLnB1c2godC5pZCksIEModCwgZS4kZWwuZmluZCgiLnZjYXJkcyIpLCAhMCk7CiAgICAgICAgICAgIH0pLCBlLlEoZS5jb25maWcucGF0aCwgaSkudGhlbihmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIChlICYmIGUucmVzdWx0cyB8fCBbXSkuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgQyhlLCAoMCwgeVsiZGVmYXVsdCJdKSgnLnZxdW90ZVtkYXRhLXNlbGYtaWQ9IicgKyBlLmdldCgicmlkIikgKyAnIl0nKSk7CiAgICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGUpIHt9KTsKICAgICAgICAgICAgfSksIHQgKiBuIDwgciA/IEEuc2hvdygpIDogQS5oaWRlKCk7CiAgICAgICAgICB9IGVsc2UgZS4kbm9kYXRhLnNob3coKTsKCiAgICAgICAgICBlLiRsb2FkaW5nLmhpZGUoKTsKICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAodCkgewogICAgICAgICAgZS4kbG9hZGluZy5oaWRlKCksICgwLCAkWyJkZWZhdWx0Il0pKGUsIHQsICJxdWVyeSIpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgZS5RKGUuY29uZmlnLnBhdGgpLmNvdW50KCkudGhlbihmdW5jdGlvbiAodCkgewogICAgICAgIHQgPiAwID8gKGUuJGVsLmZpbmQoIi52Y291bnQiKS5zaG93KCkuZmluZCgiLnZudW0iKS50ZXh0KHQpLCBPKCkpIDogZS4kbG9hZGluZy5oaWRlKCk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgKDAsICRbImRlZmF1bHQiXSkoZSwgdCwgImNvdW50Iik7CiAgICAgIH0pOwoKICAgICAgdmFyIEMgPSBmdW5jdGlvbiBDKHQsIG4sIHIpIHsKICAgICAgICB2YXIgbyA9ICgwLCB5WyJkZWZhdWx0Il0pKCc8ZGl2IGNsYXNzPSJ2Y2FyZCIgaWQ9IicgKyB0LmlkICsgJyI+PC9kaXY+JyksCiAgICAgICAgICAgIGkgPSB0LmdldCgidWEiKSwKICAgICAgICAgICAgYSA9ICIiOwogICAgICAgIGkgJiYgIS9qYS8udGVzdChlLmNvbmZpZy5sYW5nKSAmJiAoaSA9IHlbImRlZmF1bHQiXS5kZXRlY3QoaSksIGEgPSAnPHNwYW4gY2xhc3M9InZzeXMiPicgKyBpLmJyb3dzZXIgKyAiICIgKyBpLnZlcnNpb24gKyAnPC9zcGFuPiA8c3BhbiBjbGFzcz0idnN5cyI+JyArIGkub3MgKyAiICIgKyBpLm9zVmVyc2lvbiArICI8L3NwYW4+IiksICIqIiA9PT0gZS5jb25maWcucGF0aCAmJiAoYSA9ICc8YSBocmVmPSInICsgdC5nZXQoInVybCIpICsgJyIgY2xhc3M9InZzeXMiPicgKyB0LmdldCgidXJsIikgKyAiPC9hPiIpOwogICAgICAgIHZhciBsID0gdC5nZXQoImxpbmsiKSA/IC9eaHR0cHM/XDpcL1wvLy50ZXN0KHQuZ2V0KCJsaW5rIikpID8gdC5nZXQoImxpbmsiKSA6ICJodHRwOi8vIiArIHQuZ2V0KCJsaW5rIikgOiAiIiwKICAgICAgICAgICAgYyA9IGwgPyAnPGEgY2xhc3M9InZuaWNrIiByZWw9Im5vZm9sbG93IiBocmVmPSInICsgbCArICciIHRhcmdldD0iX2JsYW5rIiA+JyArIHQuZ2V0KCJuaWNrIikgKyAiPC9hPiIgOiAnPHNwYW4gY2xhc3M9InZuaWNrIj4nICsgdC5nZXQoIm5pY2siKSArICI8L3NwYW4+IiwKICAgICAgICAgICAgdSA9IFQuaGlkZSA/ICIiIDogZS5jb25maWcuZW5hYmxlUVEgJiYgdC5nZXQoIlFRQXZhdGFyIikgPyAnPGltZyBjbGFzcz0idmltZyIgc3JjPSInICsgdC5nZXQoIlFRQXZhdGFyIikgKyAnIiByZWZlcnJlclBvbGljeT0ibm8tcmVmZXJyZXIiLz4nIDogJzxpbWcgY2xhc3M9InZpbWciIHNyYz0iJyArIChULmNkbiArICgwLCBzWyJkZWZhdWx0Il0pKHQuZ2V0KCJtYWlsIikpICsgVC5wYXJhbXMpICsgJyI+JywKICAgICAgICAgICAgZCA9IHUgKyAnPGRpdiBjbGFzcz0idmgiPjxkaXYgY2xhc3M9InZoZWFkIj4nICsgYyArICIgIiArIGEgKyAnPC9kaXY+PGRpdiBjbGFzcz0idm1ldGEiPjxzcGFuIGNsYXNzPSJ2dGltZSIgPicgKyAoMCwgZ1siZGVmYXVsdCJdKSh0LmdldCgiaW5zZXJ0ZWRBdCIpLCBlLmkxOG4pICsgJzwvc3Bhbj48c3BhbiBjbGFzcz0idmF0IiBkYXRhLXZtLWlkPSInICsgKHQuZ2V0KCJyaWQiKSB8fCB0LmlkKSArICciIGRhdGEtc2VsZi1pZD0iJyArIHQuaWQgKyAnIj4nICsgZS5pMThuLnQoInJlcGx5IikgKyAnPC9zcGFuPjwvZGl2PjxkaXYgY2xhc3M9InZjb250ZW50IiBkYXRhLWV4cGFuZD0iJyArIGUuaTE4bi50KCJleHBhbmQiKSArICciPicgKyAoMCwgU1siZGVmYXVsdCJdKSh0LmdldCgiY29tbWVudCIpKSArICc8L2Rpdj48ZGl2IGNsYXNzPSJ2cmVwbHktd3JhcHBlciIgZGF0YS1zZWxmLWlkPSInICsgdC5pZCArICciPjwvZGl2PjxkaXYgY2xhc3M9InZxdW90ZSIgZGF0YS1zZWxmLWlkPSInICsgdC5pZCArICciPjwvZGl2PjwvZGl2Pic7CiAgICAgICAgby5odG1sKGQpOwogICAgICAgIHZhciBwID0gby5maW5kKCIudmF0Iik7CiAgICAgICAgby5maW5kKCJhIikuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgZSAmJiAhKDAsIHlbImRlZmF1bHQiXSkoZSkuaGFzQ2xhc3MoImF0IikgJiYgKDAsIHlbImRlZmF1bHQiXSkoZSkuYXR0cih7CiAgICAgICAgICAgIHRhcmdldDogIl9ibGFuayIsCiAgICAgICAgICAgIHJlbDogIm5vZm9sbG93IgogICAgICAgICAgfSk7CiAgICAgICAgfSksIHIgPyBuLmFwcGVuZChvKSA6IG4ucHJlcGVuZChvKTsKICAgICAgICB2YXIgZiA9IG8uZmluZCgiLnZjb250ZW50Iik7CiAgICAgICAgZiAmJiBSKGYpLCBwICYmIFAocCwgdCksIE0oKTsKICAgICAgfSwKICAgICAgICAgIEkgPSB7fSwKICAgICAgICAgIFAgPSBmdW5jdGlvbiBQKHQsIG4pIHsKICAgICAgICB0Lm9uKCJjbGljayIsIGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICB2YXIgbyA9IHQuYXR0cigiZGF0YS12bS1pZCIpLAogICAgICAgICAgICAgIGkgPSB0LmF0dHIoImRhdGEtc2VsZi1pZCIpLAogICAgICAgICAgICAgIGEgPSBlLiRlbC5maW5kKCIudndyYXAiKSwKICAgICAgICAgICAgICBzID0gIkAiICsgeVsiZGVmYXVsdCJdLmVzY2FwZShuLmdldCgibmljayIpKTsKICAgICAgICAgICgwLCB5WyJkZWZhdWx0Il0pKCcudnJlcGx5LXdyYXBwZXJbZGF0YS1zZWxmLWlkPSInICsgaSArICciXScpLmFwcGVuZChhKS5maW5kKCIuY2FuY2VsLXJlcGx5Iikuc2hvdygpLCBJID0gewogICAgICAgICAgICBhdDogeVsiZGVmYXVsdCJdLmVzY2FwZShzKSArICIgIiwKICAgICAgICAgICAgcmlkOiBvLAogICAgICAgICAgICBwaWQ6IGksCiAgICAgICAgICAgIHJtYWlsOiBuLmdldCgibWFpbCIpCiAgICAgICAgICB9LCB2LmNvbW1lbnQuYXR0cih7CiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBzCiAgICAgICAgICB9KVswXS5mb2N1cygpOwogICAgICAgIH0pOwogICAgICB9LAogICAgICAgICAgTSA9IGZ1bmN0aW9uIE0oKSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICAiTWF0aEpheCIgaW4gd2luZG93ICYmICJ2ZXJzaW9uIiBpbiB3aW5kb3cuTWF0aEpheCAmJiAoL14zLiovLnRlc3Qod2luZG93Lk1hdGhKYXgudmVyc2lvbikgJiYgTWF0aEpheC50eXBlc2V0KCkgfHwgTWF0aEpheC5IdWIuUXVldWUoWyJUeXBlc2V0IiwgTWF0aEpheC5IdWIsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi52IildKSksICJyZW5kZXJNYXRoSW5FbGVtZW50IiBpbiB3aW5kb3cgJiYgcmVuZGVyTWF0aEluRWxlbWVudCgoMCwgeVsiZGVmYXVsdCJdKSgiLnYiKVswXSwgewogICAgICAgICAgICAgIGRlbGltaXRlcnM6IFt7CiAgICAgICAgICAgICAgICBsZWZ0OiAiJCQiLAogICAgICAgICAgICAgICAgcmlnaHQ6ICIkJCIsCiAgICAgICAgICAgICAgICBkaXNwbGF5OiAhMAogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGxlZnQ6ICIkIiwKICAgICAgICAgICAgICAgIHJpZ2h0OiAiJCIsCiAgICAgICAgICAgICAgICBkaXNwbGF5OiAhMQogICAgICAgICAgICAgIH1dCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBjYXRjaCAoZSkge30KICAgICAgICB9LCAxMDApOwogICAgICB9LAogICAgICAgICAgUiA9IGZ1bmN0aW9uIFIoZSkgewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgZVswXS5vZmZzZXRIZWlnaHQgPiAyMDAgJiYgKGUuYWRkQ2xhc3MoImV4cGFuZCIpLCBlLm9uKCJjbGljayIsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIGUucmVtb3ZlQ2xhc3MoImV4cGFuZCIpOwogICAgICAgICAgfSkpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgIWZ1bmN0aW9uICh0KSB7CiAgICAgICAgaWYgKHQgPSB5WyJkZWZhdWx0Il0uc3RvcmUuZ2V0KGguTWV0YUNhY2hlS2V5KSB8fCB0KSBmb3IgKHZhciBuIGluIHApIHsKICAgICAgICAgIHZhciByID0gcFtuXTsKICAgICAgICAgIGUuJGVsLmZpbmQoIi52IiArIHIpLnZhbCh5WyJkZWZhdWx0Il0udW5lc2NhcGUodFtyXSkpLCBFW3JdID0gdFtyXTsKICAgICAgICB9CiAgICAgICAgdmFyIG8gPSB5WyJkZWZhdWx0Il0uc3RvcmUuZ2V0KGguUVFDYWNoZUtleSk7CiAgICAgICAgRS5RUUF2YXRhciA9IGUuY29uZmlnLmVuYWJsZVFRICYmICEhbyAmJiBvLnBpYyB8fCAiIjsKICAgICAgfSgpLCBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIEUuY29tbWVudCA9ICIiLCB2LmNvbW1lbnQudmFsKCIiKSwgZCh2LmNvbW1lbnQpLCB2LmNvbW1lbnQuYXR0cigicGxhY2Vob2xkZXIiLCBlLmNvbmZpZy5wbGFjZWhvbGRlciksIEkgPSB7fSwgZS4kcHJldmlldy5oaWRlKCksIGUuJGVsLmZpbmQoIi52cGFuZWwiKS5hcHBlbmQoZS4kZWwuZmluZCgiLnZ3cmFwIikpLCBlLiRlbC5maW5kKCIuY2FuY2VsLXJlcGx5IikuaGlkZSgpLCBqID0gIiI7CiAgICAgIH07CgogICAgICB2YXIgeiA9IGUuJGVsLmZpbmQoIi52c3VibWl0IiksCiAgICAgICAgICBMID0gZnVuY3Rpb24gTCh0KSB7CiAgICAgICAgaWYgKGUuY29uZmlnLnJlcXVpcmVkRmllbGRzLmluZGV4T2YoIm5pY2siKSA+IC0xICYmIEUubmljay5sZW5ndGggPCAzKSByZXR1cm4gdi5uaWNrWzBdLmZvY3VzKCksIHZvaWQgZS4kZWwuZmluZCgiLnN0YXR1cy1iYXIiKS50ZXh0KCIiICsgZS5pMThuLnQoIm5pY2tGYWlsIikpLmVtcHR5KDNlMyk7CiAgICAgICAgaWYgKGUuY29uZmlnLnJlcXVpcmVkRmllbGRzLmluZGV4T2YoIm1haWwiKSA+IC0xICYmICEvW1x3LVwuXStAKFtcdy1dK1wuKStbYS16XXsyLDN9Ly50ZXN0KEUubWFpbCkpIHJldHVybiB2Lm1haWxbMF0uZm9jdXMoKSwgdm9pZCBlLiRlbC5maW5kKCIuc3RhdHVzLWJhciIpLnRleHQoIiIgKyBlLmkxOG4udCgibWFpbEZhaWwiKSkuZW1wdHkoM2UzKTsKICAgICAgICBpZiAoIiIgPT0gaikgcmV0dXJuIHZvaWQgdi5jb21tZW50WzBdLmZvY3VzKCk7CiAgICAgICAgRS5jb21tZW50ID0gaiwgRS5uaWNrID0gRS5uaWNrIHx8ICJBbm9ueW1vdXMiOwogICAgICAgIHZhciBuID0geVsiZGVmYXVsdCJdLnN0b3JlLmdldCgidmx4Iik7CgogICAgICAgIGlmIChuKSB7CiAgICAgICAgICBpZiAoRGF0ZS5ub3coKSAvIDFlMyAtIG4gLyAxZTMgPCAyMCkgcmV0dXJuIHZvaWQgZS4kZWwuZmluZCgiLnN0YXR1cy1iYXIiKS50ZXh0KGUuaTE4bi50KCJidXN5IikpLmVtcHR5KDNlMyk7CiAgICAgICAgfQoKICAgICAgICBVKCk7CiAgICAgIH0sCiAgICAgICAgICBGID0gZnVuY3Rpb24gRigpIHsKICAgICAgICB2YXIgZSA9IG5ldyBBVi5BQ0woKTsKICAgICAgICByZXR1cm4gZS5zZXRQdWJsaWNSZWFkQWNjZXNzKCEwKSwgZS5zZXRQdWJsaWNXcml0ZUFjY2VzcyghMSksIGU7CiAgICAgIH0sCiAgICAgICAgICBVID0gZnVuY3Rpb24gVSgpIHsKICAgICAgICB5WyJkZWZhdWx0Il0uc3RvcmUuc2V0KCJ2bHgiLCBEYXRlLm5vdygpKSwgei5hdHRyKHsKICAgICAgICAgIGRpc2FibGVkOiAhMAogICAgICAgIH0pLCBlLiRsb2FkaW5nLnNob3coITApOwogICAgICAgIHZhciB0ID0gQVYuT2JqZWN0LmV4dGVuZChlLmNvbmZpZy5jbGF6ek5hbWUgfHwgIkNvbW1lbnQiKSwKICAgICAgICAgICAgbiA9IG5ldyB0KCk7CgogICAgICAgIGlmIChFLnVybCA9IGRlY29kZVVSSShlLmNvbmZpZy5wYXRoKSwgRS5pbnNlcnRlZEF0ID0gbmV3IERhdGUoKSwgSS5yaWQpIHsKICAgICAgICAgIHZhciByID0gSS5waWQgfHwgSS5yaWQ7CiAgICAgICAgICBuLnNldCgicmlkIiwgSS5yaWQpLCBuLnNldCgicGlkIiwgciksIEUuY29tbWVudCA9IGoucmVwbGFjZSgiPHA+IiwgJzxwPjxhIGNsYXNzPSJhdCIgaHJlZj0iIycgKyByICsgJyI+JyArIEkuYXQgKyAiPC9hPiAsICIpOwogICAgICAgIH0KCiAgICAgICAgZm9yICh2YXIgbyBpbiBFKSB7CiAgICAgICAgICBpZiAoRS5oYXNPd25Qcm9wZXJ0eShvKSkgewogICAgICAgICAgICB2YXIgaSA9IEVbb107CiAgICAgICAgICAgIG4uc2V0KG8sIGkpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbi5zZXRBQ0woRigpKSwgbi5zYXZlKCkudGhlbihmdW5jdGlvbiAodCkgewogICAgICAgICAgIkFub255bW91cyIgIT0gRS5uaWNrICYmIHlbImRlZmF1bHQiXS5zdG9yZS5zZXQoaC5NZXRhQ2FjaGVLZXksIHsKICAgICAgICAgICAgbmljazogRS5uaWNrLAogICAgICAgICAgICBsaW5rOiBFLmxpbmssCiAgICAgICAgICAgIG1haWw6IEUubWFpbAogICAgICAgICAgfSk7CiAgICAgICAgICB2YXIgbiA9IGUuJGVsLmZpbmQoIi52bnVtIik7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgSS5yaWQgPyBDKHQsICgwLCB5WyJkZWZhdWx0Il0pKCcudnF1b3RlW2RhdGEtc2VsZi1pZD0iJyArIEkucmlkICsgJyJdJyksICEwKSA6IChOdW1iZXIobi50ZXh0KCkpID8gbi50ZXh0KE51bWJlcihuLnRleHQoKSkgKyAxKSA6IGUuJGVsLmZpbmQoIi52Y291bnQiKS5zaG93KCkuZmluZCgiLnZudW0iKS50ZXh0KE51bWJlcihuLnRleHQoKSkgKyAxKSwgQyh0LCBlLiRlbC5maW5kKCIudmNhcmRzIikpLCBrLnNraXArKyksIHoucmVtb3ZlQXR0cigiZGlzYWJsZWQiKSwgZS4kbG9hZGluZy5oaWRlKCksIGUucmVzZXQoKTsKICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgKDAsICRbImRlZmF1bHQiXSkoZSwgdCwgInNhdmUiKTsKICAgICAgICAgIH0KICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAodCkgewogICAgICAgICAgKDAsICRbImRlZmF1bHQiXSkoZSwgdCwgImNvbW1pdEV2dCIpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgei5vbigiY2xpY2siLCBMKSwgKDAsIHlbImRlZmF1bHQiXSkoZG9jdW1lbnQpLm9uKCJrZXlkb3duIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICBlID0gZXZlbnQgfHwgZTsKICAgICAgICB2YXIgdCA9IGUua2V5Q29kZSB8fCBlLndoaWNoIHx8IGUuY2hhckNvZGU7CiAgICAgICAgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiAxMyA9PT0gdCAmJiBMKCksIDkgPT09IHQpICYmICJ2ZWRpdG9yIiA9PSAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5pZCB8fCAiIikgJiYgKGUucHJldmVudERlZmF1bHQoKSwgeChpWzBdLCAiICAgICIpKTsKICAgICAgfSkub24oInBhc3RlIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgdCA9ICJjbGlwYm9hcmREYXRhIiBpbiBlID8gZS5jbGlwYm9hcmREYXRhIDogZS5vcmlnaW5hbEV2ZW50ICYmIGUub3JpZ2luYWxFdmVudC5jbGlwYm9hcmREYXRhIHx8IHdpbmRvdy5jbGlwYm9hcmREYXRhOwogICAgICAgIHQgJiYgQih0Lml0ZW1zLCAhMCk7CiAgICAgIH0pLCBpLm9uKCJkcmFnZW50ZXIgZHJhZ2xlYXZlIGRyYWdvdmVyIGRyb3AiLCBmdW5jdGlvbiAoZSkgewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCksIGUucHJldmVudERlZmF1bHQoKSwgImRyb3AiID09PSBlLnR5cGUgJiYgQihlLmRhdGFUcmFuc2Zlci5pdGVtcyk7CiAgICAgIH0pOwoKICAgICAgdmFyIEIgPSBmdW5jdGlvbiBCKGUsIHQpIHsKICAgICAgICBmb3IgKHZhciBuID0gW10sIHIgPSAwLCBvID0gZS5sZW5ndGg7IHIgPCBvOyByKyspIHsKICAgICAgICAgIHZhciBhID0gZVtyXTsKICAgICAgICAgIGlmICgic3RyaW5nIiA9PT0gYS5raW5kICYmIGEudHlwZS5tYXRjaCgiXnRleHQvaHRtbCIpKSAhdCAmJiBhLmdldEFzU3RyaW5nKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGUgJiYgeChpWzBdLCBlLnJlcGxhY2UoLzxbXj5dKz4vZywgIiIpKTsKICAgICAgICAgIH0pO2Vsc2UgaWYgKC0xICE9PSBhLnR5cGUuaW5kZXhPZigiaW1hZ2UiKSkgewogICAgICAgICAgICBuLnB1c2goYS5nZXRBc0ZpbGUoKSk7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgTihuKTsKICAgICAgfSwKICAgICAgICAgIE4gPSBmdW5jdGlvbiB0KG4sIHIpIHsKICAgICAgICByID0gciB8fCAwOwogICAgICAgIHZhciBvID0gbi5sZW5ndGg7CgogICAgICAgIGlmIChvID4gMCkgewogICAgICAgICAgdmFyIGEgPSBuW3JdOwogICAgICAgICAgei5hdHRyKHsKICAgICAgICAgICAgZGlzYWJsZWQ6ICEwCiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBzID0gIiFbVXBsb2FkaW5nICIgKyBhLm5hbWUgKyAiLi4uXSgpIjsKICAgICAgICAgIHgoaVswXSwgcyksIFEoYSwgZnVuY3Rpb24gKGwpIHsKICAgICAgICAgICAgNTAwICE9IGwuY29kZSA/IChpLnZhbChpLnZhbCgpLnJlcGxhY2UocywgIiFbIiArIGEubmFtZSArICJdKCIgKyBsLmRhdGEudXJsICsgIilcclxuIikpLCAoMCwgY1siZGVmYXVsdCJdKShpWzBdKSwgKytyIDwgbyA/IHQobiwgcikgOiB6LnJlbW92ZUF0dHIoImRpc2FibGVkIikpIDogKGkudmFsKGkudmFsKCkucmVwbGFjZShzLCAiIikpLCAoMCwgY1siZGVmYXVsdCJdKShpWzBdKSwgZS4kZWwuZmluZCgiLnN0YXR1cy1iYXIiKS50ZXh0KGwubXNnKS5lbXB0eSgzZTMpLCB6LnJlbW92ZUF0dHIoImRpc2FibGVkIikpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICAgICAgUSA9IGZ1bmN0aW9uIFEoZSwgdCkgewogICAgICAgIHZhciBuID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgbi5hcHBlbmQoImltYWdlIiwgZSksIHlbImRlZmF1bHQiXS5hamF4KHsKICAgICAgICAgIHR5cGU6ICJwb3N0IiwKICAgICAgICAgIHVybDogImh0dHBzOi8vcGljLmFsZXhoY2h1LmNvbS9hcGkvdXBsb2FkIiwKICAgICAgICAgIGRhdGE6IG4sCiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKGUpIHsKICAgICAgICAgICAgdCAmJiB0KGUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9OwogICAgfSwgZS5leHBvcnRzID0gaSwgZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBpOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdC5fX2VzTW9kdWxlID0gITA7CgogICAgdmFyIHIgPSBuKDApLAogICAgICAgIG8gPSBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogewogICAgICAgICJkZWZhdWx0IjogZQogICAgICB9OwogICAgfShyKSwKICAgICAgICBpID0gITE7CgogICAgdFsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgaWYgKCJBViIgaW4gd2luZG93KSB7CiAgICAgICAgdmFyIG4gPSB3aW5kb3cuQVYudmVyc2lvbiB8fCB3aW5kb3cuQVYuVkVSU0lPTjsKICAgICAgICBwYXJzZUludChuLnNwbGl0KCIuIilbMF0pID4gMiA/IGkgPSAhIUFWLmFwcGxpY2F0aW9uSWQgJiYgISFBVi5hcHBsaWNhdGlvbktleSA6IG9bImRlZmF1bHQiXS5kZWxldGVJbldpbigiQVYiLCAwKTsKICAgICAgfQoKICAgICAgaSA/IHQgJiYgdCgpIDogb1siZGVmYXVsdCJdLnNka0xvYWRlcigiLy9jZG4uanNkZWxpdnIubmV0L25wbS9sZWFuY2xvdWQtc3RvcmFnZUAzL2Rpc3QvYXYtbWluLmpzIiwgIkFWIiwgZnVuY3Rpb24gKG4pIHsKICAgICAgICB2YXIgciA9ICJodHRwczovLyIsCiAgICAgICAgICAgIG8gPSAiIiwKICAgICAgICAgICAgYSA9IGUuYXBwX2lkIHx8IGUuYXBwSWQsCiAgICAgICAgICAgIHMgPSBlLmFwcF9rZXkgfHwgZS5hcHBLZXk7CiAgICAgICAgaWYgKCFlLnNlcnZlclVSTHMpIHN3aXRjaCAoYS5zbGljZSgtOSkpIHsKICAgICAgICAgIGNhc2UgIi05Tmg5ajBWYSI6CiAgICAgICAgICAgIHIgKz0gInRhYi4iOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICItTWRZWGJNTUkiOgogICAgICAgICAgICByICs9ICJ1cy4iOwogICAgICAgIH0KICAgICAgICBvID0gZS5zZXJ2ZXJVUkxzIHx8IHIgKyAiYXZvc2Nsb3VkLmNvbSIsIEFWLmluaXQoewogICAgICAgICAgYXBwSWQ6IGEsCiAgICAgICAgICBhcHBLZXk6IHMsCiAgICAgICAgICBzZXJ2ZXJVUkxzOiBvCiAgICAgICAgfSksIGkgPSAhMCwgdCAmJiB0KCk7CiAgICAgIH0pOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIGZ1bmN0aW9uIHIoZSkgewogICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogewogICAgICAgICJkZWZhdWx0IjogZQogICAgICB9OwogICAgfQoKICAgIHQuX19lc01vZHVsZSA9ICEwOwogICAgdmFyIG8gPSBuKDM3KSwKICAgICAgICBpID0gcihvKSwKICAgICAgICBhID0gbig1NiksCiAgICAgICAgcyA9IHIoYSksCiAgICAgICAgbCA9IG4oNTcpLAogICAgICAgIGMgPSByKGwpLAogICAgICAgIHUgPSBuKDU0KSwKICAgICAgICBkID0gcih1KSwKICAgICAgICBwID0gbig1NSksCiAgICAgICAgZiA9IHIocCksCiAgICAgICAgaCA9IHsKICAgICAgemg6IHNbImRlZmF1bHQiXSwKICAgICAgInpoLWNuIjogc1siZGVmYXVsdCJdLAogICAgICAiemgtQ04iOiBzWyJkZWZhdWx0Il0sCiAgICAgICJ6aC1UVyI6IGNbImRlZmF1bHQiXSwKICAgICAgZW46IGRbImRlZmF1bHQiXSwKICAgICAgImVuLVVTIjogZFsiZGVmYXVsdCJdLAogICAgICBqYTogZlsiZGVmYXVsdCJdLAogICAgICAiamEtSlAiOiBmWyJkZWZhdWx0Il0KICAgIH07CgogICAgdFsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgcmV0dXJuICFoW2VdICYmIGUgJiYgdCAmJiAoaFtlXSA9IHQpLCBuZXcgaVsiZGVmYXVsdCJdKHsKICAgICAgICBwaHJhc2VzOiBoW2UgfHwgInpoIl0sCiAgICAgICAgbG9jYWxlOiBlCiAgICAgIH0pOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHQuX19lc01vZHVsZSA9ICEwLCB0WyJkZWZhdWx0Il0gPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICBpZiAoZS4kZWwgJiYgZS4kbG9hZGluZy5oaWRlKCkuJG5vZGF0YS5oaWRlKCksICJbb2JqZWN0IEVycm9yXSIgPT09IHt9LnRvU3RyaW5nLmNhbGwodCkpIHsKICAgICAgICB2YXIgbiA9IHQuY29kZSB8fCB0Lm1lc3NhZ2UgfHwgdC5lcnJvciB8fCAiIjsKICAgICAgICBpZiAoaXNOYU4obikpIGUuJGVsICYmIGUuJG5vZGF0YS5zaG93KCc8cHJlIHN0eWxlPSJ0ZXh0LWFsaWduOmxlZnQ7Ij4gJyArIEpTT04uc3RyaW5naWZ5KHQpICsgIjwvcHJlPiIpO2Vsc2UgewogICAgICAgICAgdmFyIHIgPSBlLmkxOG4udCgiY29kZS0iICsgbiksCiAgICAgICAgICAgICAgbyA9IChyID09ICJjb2RlLSIgKyBuID8gdm9pZCAwIDogcikgfHwgdC5tZXNzYWdlIHx8IHQuZXJyb3IgfHwgIiI7CiAgICAgICAgICAxMDEgPT0gbiB8fCAtMSA9PSBuID8gZS4kbm9kYXRhLnNob3coKSA6IGUuJGVsICYmIGUuJG5vZGF0YS5zaG93KCc8cHJlIHN0eWxlPSJ0ZXh0LWFsaWduOmxlZnQ7Ij5Db2RlICcgKyBuICsgIjogIiArIG8gKyAiPC9wcmU+Iik7CiAgICAgICAgfQogICAgICB9IGVsc2UgZS4kZWwgJiYgZS4kbm9kYXRhLnNob3coJzxwcmUgc3R5bGU9InRleHQtYWxpZ246bGVmdDsiPicgKyBKU09OLnN0cmluZ2lmeSh0KSArICI8L3ByZT4iKTsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICBmdW5jdGlvbiByKGUpIHsKICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsKICAgICAgICAiZGVmYXVsdCI6IGUKICAgICAgfTsKICAgIH0KCiAgICB0Ll9fZXNNb2R1bGUgPSAhMDsKICAgIHZhciBvID0gbigzNiksCiAgICAgICAgaSA9IHIobyksCiAgICAgICAgYSA9IG4oMCksCiAgICAgICAgcyA9IHIoYSksCiAgICAgICAgbCA9IG4oNiksCiAgICAgICAgYyA9IHIobCksCiAgICAgICAgdSA9IG4oMzMpLAogICAgICAgIGQgPSBuZXcgby5SZW5kZXJlcigpOwogICAgZC5jb2RlID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgcmV0dXJuICc8cHJlPjxjb2RlIGNsYXNzPSJobGpzIGxhbmd1YWdlLScgKyB0ICsgJyI+JyArICghdCB8fCAhaGxqcy5nZXRMYW5ndWFnZSh0KSA/IHNbImRlZmF1bHQiXS5lc2NhcGUoZSkgOiBobGpzLmhpZ2hsaWdodCh0LCBlKS52YWx1ZSkgKyAiPC9jb2RlPjwvcHJlPiI7CiAgICB9LCBpWyJkZWZhdWx0Il0uc2V0T3B0aW9ucyh7CiAgICAgIHJlbmRlcmVyOiAiaGxqcyIgaW4gd2luZG93ID8gZCA6IG5ldyBvLlJlbmRlcmVyKCksCiAgICAgIGhpZ2hsaWdodDogZnVuY3Rpb24gaGlnaGxpZ2h0KGUsIHQpIHsKICAgICAgICByZXR1cm4gImhsanMiIGluIHdpbmRvdyA/IHQgJiYgaGxqcy5nZXRMYW5ndWFnZSh0KSAmJiBobGpzLmhpZ2hsaWdodCh0LCBlLCAhMCkudmFsdWUgfHwgaGxqcy5oaWdobGlnaHRBdXRvKGUpLnZhbHVlIDogdShlKTsKICAgICAgfSwKICAgICAgZ2ZtOiAhMCwKICAgICAgdGFibGVzOiAhMCwKICAgICAgYnJlYWtzOiAhMCwKICAgICAgcGVkYW50aWM6ICExLAogICAgICBzYW5pdGl6ZTogITAsCiAgICAgIHNtYXJ0TGlzdHM6ICEwLAogICAgICBzbWFydHlwYW50czogITAsCiAgICAgIGhlYWRlclByZWZpOiAidi0iCiAgICB9KSwgdFsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGNbImRlZmF1bHQiXS5wYXJzZSgoMCwgaVsiZGVmYXVsdCJdKShlKSk7CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdC5fX2VzTW9kdWxlID0gITAsIHQucmVjb3JkSVBGbiA9IHQuZmV0Y2hRUUZuID0gdm9pZCAwOwoKICAgIHZhciByID0gbigwKSwKICAgICAgICBvID0gZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsKICAgICAgICAiZGVmYXVsdCI6IGUKICAgICAgfTsKICAgIH0ociksCiAgICAgICAgaSA9IG4oMiksCiAgICAgICAgYSA9IGZ1bmN0aW9uIGEoZSwgdCkgewogICAgICB2YXIgbiA9IG9bImRlZmF1bHQiXS5zdG9yZS5nZXQoaS5RUUNhY2hlS2V5KTsKICAgICAgbiAmJiBuLnFxID09IGUgPyB0ICYmIHQobikgOiBvWyJkZWZhdWx0Il0uYWpheCh7CiAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgIHVybDogIi8vdmFsaW5lLmFwaS5pb2xpdS5jbi9nZXRxcWluZm8iLAogICAgICAgIGRhdGE6IHsKICAgICAgICAgIHFxOiBlCiAgICAgICAgfSwKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKGUpIHsKICAgICAgICAgIGUuZXJybXNnIHx8IChvWyJkZWZhdWx0Il0uc3RvcmUuc2V0KGkuUVFDYWNoZUtleSwgZSksIHQgJiYgdChlKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAgICAgcyA9IGZ1bmN0aW9uIHMoZSkgewogICAgICBvWyJkZWZhdWx0Il0uc2RrTG9hZGVyKCIvL2FwaS5pcC5zYi9qc29uaXA/Y2FsbGJhY2s9Z2V0SVAiLCAiZ2V0SVAiKSwgd2luZG93LmdldElQID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICBlICYmIGUodC5pcCksIG9bImRlZmF1bHQiXS5kZWxldGVJbldpbigiZ2V0SVAiKTsKICAgICAgfTsKICAgIH07CgogICAgdC5mZXRjaFFRRm4gPSBhLCB0LnJlY29yZElQRm4gPSBzOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBmdW5jdGlvbiByKGUsIHQpIHsKICAgICAgaWYgKCFlKSByZXR1cm4gIiI7CgogICAgICB0cnkgewogICAgICAgIHZhciBuID0gaShlKS5nZXRUaW1lKCksCiAgICAgICAgICAgIHIgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKICAgICAgICAgICAgYSA9IHIgLSBuLAogICAgICAgICAgICBzID0gTWF0aC5mbG9vcihhIC8gODY0ZTUpOwoKICAgICAgICBpZiAoMCA9PT0gcykgewogICAgICAgICAgdmFyIGwgPSBhICUgODY0ZTUsCiAgICAgICAgICAgICAgYyA9IE1hdGguZmxvb3IobCAvIDM2ZTUpOwoKICAgICAgICAgIGlmICgwID09PSBjKSB7CiAgICAgICAgICAgIHZhciB1ID0gbCAlIDM2ZTUsCiAgICAgICAgICAgICAgICBkID0gTWF0aC5mbG9vcih1IC8gNmU0KTsKCiAgICAgICAgICAgIGlmICgwID09PSBkKSB7CiAgICAgICAgICAgICAgdmFyIHAgPSB1ICUgNmU0OwogICAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHAgLyAxZTMpICsgIiAiICsgdC50KCJzZWNvbmRzIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBkICsgIiAiICsgdC50KCJtaW51dGVzIik7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGMgKyAiICIgKyB0LnQoImhvdXJzIik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcyA8IDAgPyB0LnQoIm5vdyIpIDogcyA8IDggPyBzICsgIiAiICsgdC50KCJkYXlzIikgOiBvKGUpOwogICAgICB9IGNhdGNoIChlKSB7fQogICAgfSwKICAgICAgICBvID0gZnVuY3Rpb24gbyhlKSB7CiAgICAgIHZhciB0ID0gYShlLmdldERhdGUoKSwgMiksCiAgICAgICAgICBuID0gYShlLmdldE1vbnRoKCkgKyAxLCAyKTsKICAgICAgcmV0dXJuIGEoZS5nZXRGdWxsWWVhcigpLCAyKSArICItIiArIG4gKyAiLSIgKyB0OwogICAgfSwKICAgICAgICBpID0gZnVuY3Rpb24gZSh0KSB7CiAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgRGF0ZSA/IHQgOiAhaXNOYU4odCkgfHwgL15cZCskLy50ZXN0KHQpID8gbmV3IERhdGUocGFyc2VJbnQodCkpIDogL0dNVC8udGVzdCh0IHx8ICIiKSA/IGUobmV3IERhdGUodCkuZ2V0VGltZSgpKSA6ICh0ID0gKHQgfHwgIiIpLnJlcGxhY2UoLyheXHMqKXwoXHMqJCkvZywgIiIpLnJlcGxhY2UoL1wuXGQrLywgIiIpLnJlcGxhY2UoLy0vLCAiLyIpLnJlcGxhY2UoLy0vLCAiLyIpLnJlcGxhY2UoLyhcZClUKFxkKS8sICIkMSAkMiIpLnJlcGxhY2UoL1ovLCAiIFVUQyIpLnJlcGxhY2UoLyhbKy1dXGRcZCk6PyhcZFxkKS8sICIgJDEkMiIpLCBuZXcgRGF0ZSh0KSk7CiAgICB9LAogICAgICAgIGEgPSBmdW5jdGlvbiBhKGUsIHQpIHsKICAgICAgZm9yICh2YXIgbiA9IGUudG9TdHJpbmcoKTsgbi5sZW5ndGggPCB0OykgewogICAgICAgIG4gPSAiMCIgKyBuOwogICAgICB9CgogICAgICByZXR1cm4gbjsKICAgIH07CgogICAgZS5leHBvcnRzID0gcjsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHQuX19lc01vZHVsZSA9ICEwOwoKICAgIHZhciByID0gbig1MSksCiAgICAgICAgbyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7CiAgICAgICAgImRlZmF1bHQiOiBlCiAgICAgIH07CiAgICB9KHIpOwoKICAgIHRbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiAoMCwgb1siZGVmYXVsdCJdKShlLCB7CiAgICAgICAgb25UYWdBdHRyOiBmdW5jdGlvbiBvblRhZ0F0dHIoZSwgdCwgbiwgcikgewogICAgICAgICAgcmV0dXJuIGkoZSwgdCwgbiwgcik7CiAgICAgICAgfSwKICAgICAgICBvbklnbm9yZVRhZ0F0dHI6IGZ1bmN0aW9uIG9uSWdub3JlVGFnQXR0cihlLCB0LCBuLCByKSB7CiAgICAgICAgICByZXR1cm4gaShlLCB0LCBuLCByKTsKICAgICAgICB9CiAgICAgIH0pLnJlcGxhY2UoL1w8XC8/ZGl2XD4vZ2ksICIiKTsKICAgIH07CgogICAgdmFyIGkgPSBmdW5jdGlvbiBpKGUsIHQsIG4sIHIpIHsKICAgICAgaWYgKC9jb2RlfHByZXxzcGFuL2dpLnRlc3QoZSkpIHsKICAgICAgICBpZiAoInN0eWxlIiA9PSB0KSByZXR1cm4gdCArICc9IicgKyAoL15jb2xvci9naS50ZXN0KG4pID8gbiA6ICIiKS5yZXBsYWNlKC8oY29sb3I6WyMwLTlhLWZBLUZdezEsNn07PykuKy9naSwgIiQxIikgKyAnIic7CiAgICAgICAgaWYgKCJjbGFzcyIgPT0gdCkgcmV0dXJuIHQgKyAiPSciICsgb1siZGVmYXVsdCJdLmVzY2FwZUF0dHJWYWx1ZShuKSArICInIjsKICAgICAgfQoKICAgICAgaWYgKCJpbWciID09PSBlICYmIFsic3JjIiwgImNsYXNzIl0uaW5kZXhPZih0KSA+IC0xKSByZXR1cm4gdCArICc9IicgKyBvWyJkZWZhdWx0Il0uZXNjYXBlQXR0clZhbHVlKG4pICsgJyIgcmVmZXJyZXJQb2xpY3k9Im5vLXJlZmVycmVyIiAnOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgdmFyIHI7CiAgICAhZnVuY3Rpb24gKG8pIHsKICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgZnVuY3Rpb24gaShlLCB0KSB7CiAgICAgICAgdmFyIG4gPSAoNjU1MzUgJiBlKSArICg2NTUzNSAmIHQpOwogICAgICAgIHJldHVybiAoZSA+PiAxNikgKyAodCA+PiAxNikgKyAobiA+PiAxNikgPDwgMTYgfCA2NTUzNSAmIG47CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGEoZSwgdCkgewogICAgICAgIHJldHVybiBlIDw8IHQgfCBlID4+PiAzMiAtIHQ7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHMoZSwgdCwgbiwgciwgbywgcykgewogICAgICAgIHJldHVybiBpKGEoaShpKHQsIGUpLCBpKHIsIHMpKSwgbyksIG4pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBsKGUsIHQsIG4sIHIsIG8sIGksIGEpIHsKICAgICAgICByZXR1cm4gcyh0ICYgbiB8IH50ICYgciwgZSwgdCwgbywgaSwgYSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGMoZSwgdCwgbiwgciwgbywgaSwgYSkgewogICAgICAgIHJldHVybiBzKHQgJiByIHwgbiAmIH5yLCBlLCB0LCBvLCBpLCBhKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gdShlLCB0LCBuLCByLCBvLCBpLCBhKSB7CiAgICAgICAgcmV0dXJuIHModCBeIG4gXiByLCBlLCB0LCBvLCBpLCBhKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZChlLCB0LCBuLCByLCBvLCBpLCBhKSB7CiAgICAgICAgcmV0dXJuIHMobiBeICh0IHwgfnIpLCBlLCB0LCBvLCBpLCBhKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gcChlLCB0KSB7CiAgICAgICAgZVt0ID4+IDVdIHw9IDEyOCA8PCB0ICUgMzIsIGVbMTQgKyAodCArIDY0ID4+PiA5IDw8IDQpXSA9IHQ7CiAgICAgICAgdmFyIG4sCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIG8sCiAgICAgICAgICAgIGEsCiAgICAgICAgICAgIHMsCiAgICAgICAgICAgIHAgPSAxNzMyNTg0MTkzLAogICAgICAgICAgICBmID0gLTI3MTczMzg3OSwKICAgICAgICAgICAgaCA9IC0xNzMyNTg0MTk0LAogICAgICAgICAgICB2ID0gMjcxNzMzODc4OwoKICAgICAgICBmb3IgKG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4gKz0gMTYpIHsKICAgICAgICAgIHIgPSBwLCBvID0gZiwgYSA9IGgsIHMgPSB2LCBwID0gbChwLCBmLCBoLCB2LCBlW25dLCA3LCAtNjgwODc2OTM2KSwgdiA9IGwodiwgcCwgZiwgaCwgZVtuICsgMV0sIDEyLCAtMzg5NTY0NTg2KSwgaCA9IGwoaCwgdiwgcCwgZiwgZVtuICsgMl0sIDE3LCA2MDYxMDU4MTkpLCBmID0gbChmLCBoLCB2LCBwLCBlW24gKyAzXSwgMjIsIC0xMDQ0NTI1MzMwKSwgcCA9IGwocCwgZiwgaCwgdiwgZVtuICsgNF0sIDcsIC0xNzY0MTg4OTcpLCB2ID0gbCh2LCBwLCBmLCBoLCBlW24gKyA1XSwgMTIsIDEyMDAwODA0MjYpLCBoID0gbChoLCB2LCBwLCBmLCBlW24gKyA2XSwgMTcsIC0xNDczMjMxMzQxKSwgZiA9IGwoZiwgaCwgdiwgcCwgZVtuICsgN10sIDIyLCAtNDU3MDU5ODMpLCBwID0gbChwLCBmLCBoLCB2LCBlW24gKyA4XSwgNywgMTc3MDAzNTQxNiksIHYgPSBsKHYsIHAsIGYsIGgsIGVbbiArIDldLCAxMiwgLTE5NTg0MTQ0MTcpLCBoID0gbChoLCB2LCBwLCBmLCBlW24gKyAxMF0sIDE3LCAtNDIwNjMpLCBmID0gbChmLCBoLCB2LCBwLCBlW24gKyAxMV0sIDIyLCAtMTk5MDQwNDE2MiksIHAgPSBsKHAsIGYsIGgsIHYsIGVbbiArIDEyXSwgNywgMTgwNDYwMzY4MiksIHYgPSBsKHYsIHAsIGYsIGgsIGVbbiArIDEzXSwgMTIsIC00MDM0MTEwMSksIGggPSBsKGgsIHYsIHAsIGYsIGVbbiArIDE0XSwgMTcsIC0xNTAyMDAyMjkwKSwgZiA9IGwoZiwgaCwgdiwgcCwgZVtuICsgMTVdLCAyMiwgMTIzNjUzNTMyOSksIHAgPSBjKHAsIGYsIGgsIHYsIGVbbiArIDFdLCA1LCAtMTY1Nzk2NTEwKSwgdiA9IGModiwgcCwgZiwgaCwgZVtuICsgNl0sIDksIC0xMDY5NTAxNjMyKSwgaCA9IGMoaCwgdiwgcCwgZiwgZVtuICsgMTFdLCAxNCwgNjQzNzE3NzEzKSwgZiA9IGMoZiwgaCwgdiwgcCwgZVtuXSwgMjAsIC0zNzM4OTczMDIpLCBwID0gYyhwLCBmLCBoLCB2LCBlW24gKyA1XSwgNSwgLTcwMTU1ODY5MSksIHYgPSBjKHYsIHAsIGYsIGgsIGVbbiArIDEwXSwgOSwgMzgwMTYwODMpLCBoID0gYyhoLCB2LCBwLCBmLCBlW24gKyAxNV0sIDE0LCAtNjYwNDc4MzM1KSwgZiA9IGMoZiwgaCwgdiwgcCwgZVtuICsgNF0sIDIwLCAtNDA1NTM3ODQ4KSwgcCA9IGMocCwgZiwgaCwgdiwgZVtuICsgOV0sIDUsIDU2ODQ0NjQzOCksIHYgPSBjKHYsIHAsIGYsIGgsIGVbbiArIDE0XSwgOSwgLTEwMTk4MDM2OTApLCBoID0gYyhoLCB2LCBwLCBmLCBlW24gKyAzXSwgMTQsIC0xODczNjM5NjEpLCBmID0gYyhmLCBoLCB2LCBwLCBlW24gKyA4XSwgMjAsIDExNjM1MzE1MDEpLCBwID0gYyhwLCBmLCBoLCB2LCBlW24gKyAxM10sIDUsIC0xNDQ0NjgxNDY3KSwgdiA9IGModiwgcCwgZiwgaCwgZVtuICsgMl0sIDksIC01MTQwMzc4NCksIGggPSBjKGgsIHYsIHAsIGYsIGVbbiArIDddLCAxNCwgMTczNTMyODQ3MyksIGYgPSBjKGYsIGgsIHYsIHAsIGVbbiArIDEyXSwgMjAsIC0xOTI2NjA3NzM0KSwgcCA9IHUocCwgZiwgaCwgdiwgZVtuICsgNV0sIDQsIC0zNzg1NTgpLCB2ID0gdSh2LCBwLCBmLCBoLCBlW24gKyA4XSwgMTEsIC0yMDIyNTc0NDYzKSwgaCA9IHUoaCwgdiwgcCwgZiwgZVtuICsgMTFdLCAxNiwgMTgzOTAzMDU2MiksIGYgPSB1KGYsIGgsIHYsIHAsIGVbbiArIDE0XSwgMjMsIC0zNTMwOTU1NiksIHAgPSB1KHAsIGYsIGgsIHYsIGVbbiArIDFdLCA0LCAtMTUzMDk5MjA2MCksIHYgPSB1KHYsIHAsIGYsIGgsIGVbbiArIDRdLCAxMSwgMTI3Mjg5MzM1MyksIGggPSB1KGgsIHYsIHAsIGYsIGVbbiArIDddLCAxNiwgLTE1NTQ5NzYzMiksIGYgPSB1KGYsIGgsIHYsIHAsIGVbbiArIDEwXSwgMjMsIC0xMDk0NzMwNjQwKSwgcCA9IHUocCwgZiwgaCwgdiwgZVtuICsgMTNdLCA0LCA2ODEyNzkxNzQpLCB2ID0gdSh2LCBwLCBmLCBoLCBlW25dLCAxMSwgLTM1ODUzNzIyMiksIGggPSB1KGgsIHYsIHAsIGYsIGVbbiArIDNdLCAxNiwgLTcyMjUyMTk3OSksIGYgPSB1KGYsIGgsIHYsIHAsIGVbbiArIDZdLCAyMywgNzYwMjkxODkpLCBwID0gdShwLCBmLCBoLCB2LCBlW24gKyA5XSwgNCwgLTY0MDM2NDQ4NyksIHYgPSB1KHYsIHAsIGYsIGgsIGVbbiArIDEyXSwgMTEsIC00MjE4MTU4MzUpLCBoID0gdShoLCB2LCBwLCBmLCBlW24gKyAxNV0sIDE2LCA1MzA3NDI1MjApLCBmID0gdShmLCBoLCB2LCBwLCBlW24gKyAyXSwgMjMsIC05OTUzMzg2NTEpLCBwID0gZChwLCBmLCBoLCB2LCBlW25dLCA2LCAtMTk4NjMwODQ0KSwgdiA9IGQodiwgcCwgZiwgaCwgZVtuICsgN10sIDEwLCAxMTI2ODkxNDE1KSwgaCA9IGQoaCwgdiwgcCwgZiwgZVtuICsgMTRdLCAxNSwgLTE0MTYzNTQ5MDUpLCBmID0gZChmLCBoLCB2LCBwLCBlW24gKyA1XSwgMjEsIC01NzQzNDA1NSksIHAgPSBkKHAsIGYsIGgsIHYsIGVbbiArIDEyXSwgNiwgMTcwMDQ4NTU3MSksIHYgPSBkKHYsIHAsIGYsIGgsIGVbbiArIDNdLCAxMCwgLTE4OTQ5ODY2MDYpLCBoID0gZChoLCB2LCBwLCBmLCBlW24gKyAxMF0sIDE1LCAtMTA1MTUyMyksIGYgPSBkKGYsIGgsIHYsIHAsIGVbbiArIDFdLCAyMSwgLTIwNTQ5MjI3OTkpLCBwID0gZChwLCBmLCBoLCB2LCBlW24gKyA4XSwgNiwgMTg3MzMxMzM1OSksIHYgPSBkKHYsIHAsIGYsIGgsIGVbbiArIDE1XSwgMTAsIC0zMDYxMTc0NCksIGggPSBkKGgsIHYsIHAsIGYsIGVbbiArIDZdLCAxNSwgLTE1NjAxOTgzODApLCBmID0gZChmLCBoLCB2LCBwLCBlW24gKyAxM10sIDIxLCAxMzA5MTUxNjQ5KSwgcCA9IGQocCwgZiwgaCwgdiwgZVtuICsgNF0sIDYsIC0xNDU1MjMwNzApLCB2ID0gZCh2LCBwLCBmLCBoLCBlW24gKyAxMV0sIDEwLCAtMTEyMDIxMDM3OSksIGggPSBkKGgsIHYsIHAsIGYsIGVbbiArIDJdLCAxNSwgNzE4Nzg3MjU5KSwgZiA9IGQoZiwgaCwgdiwgcCwgZVtuICsgOV0sIDIxLCAtMzQzNDg1NTUxKSwgcCA9IGkocCwgciksIGYgPSBpKGYsIG8pLCBoID0gaShoLCBhKSwgdiA9IGkodiwgcyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gW3AsIGYsIGgsIHZdOwogICAgICB9CgogICAgICBmdW5jdGlvbiBmKGUpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgbiA9ICIiLAogICAgICAgICAgICByID0gMzIgKiBlLmxlbmd0aDsKCiAgICAgICAgZm9yICh0ID0gMDsgdCA8IHI7IHQgKz0gOCkgewogICAgICAgICAgbiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGVbdCA+PiA1XSA+Pj4gdCAlIDMyICYgMjU1KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBuOwogICAgICB9CgogICAgICBmdW5jdGlvbiBoKGUpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgbiA9IFtdOwoKICAgICAgICBmb3IgKG5bKGUubGVuZ3RoID4+IDIpIC0gMV0gPSB2b2lkIDAsIHQgPSAwOyB0IDwgbi5sZW5ndGg7IHQgKz0gMSkgewogICAgICAgICAgblt0XSA9IDA7CiAgICAgICAgfQoKICAgICAgICB2YXIgciA9IDggKiBlLmxlbmd0aDsKCiAgICAgICAgZm9yICh0ID0gMDsgdCA8IHI7IHQgKz0gOCkgewogICAgICAgICAgblt0ID4+IDVdIHw9ICgyNTUgJiBlLmNoYXJDb2RlQXQodCAvIDgpKSA8PCB0ICUgMzI7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbjsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gdihlKSB7CiAgICAgICAgcmV0dXJuIGYocChoKGUpLCA4ICogZS5sZW5ndGgpKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZyhlLCB0KSB7CiAgICAgICAgdmFyIG4sCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIG8gPSBoKGUpLAogICAgICAgICAgICBpID0gW10sCiAgICAgICAgICAgIGEgPSBbXTsKCiAgICAgICAgZm9yIChpWzE1XSA9IGFbMTVdID0gdm9pZCAwLCBvLmxlbmd0aCA+IDE2ICYmIChvID0gcChvLCA4ICogZS5sZW5ndGgpKSwgbiA9IDA7IG4gPCAxNjsgbiArPSAxKSB7CiAgICAgICAgICBpW25dID0gOTA5NTIyNDg2IF4gb1tuXSwgYVtuXSA9IDE1NDk1NTY4MjggXiBvW25dOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHIgPSBwKGkuY29uY2F0KGgodCkpLCA1MTIgKyA4ICogdC5sZW5ndGgpLCBmKHAoYS5jb25jYXQociksIDY0MCkpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBtKGUpIHsKICAgICAgICB2YXIgdCwKICAgICAgICAgICAgbiwKICAgICAgICAgICAgciA9ICIwMTIzNDU2Nzg5YWJjZGVmIiwKICAgICAgICAgICAgbyA9ICIiOwoKICAgICAgICBmb3IgKG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4gKz0gMSkgewogICAgICAgICAgdCA9IGUuY2hhckNvZGVBdChuKSwgbyArPSByLmNoYXJBdCh0ID4+PiA0ICYgMTUpICsgci5jaGFyQXQoMTUgJiB0KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBvOwogICAgICB9CgogICAgICBmdW5jdGlvbiB5KGUpIHsKICAgICAgICByZXR1cm4gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGUpKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gYihlKSB7CiAgICAgICAgcmV0dXJuIHYoeShlKSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHcoZSkgewogICAgICAgIHJldHVybiBtKGIoZSkpOwogICAgICB9CgogICAgICBmdW5jdGlvbiB4KGUsIHQpIHsKICAgICAgICByZXR1cm4gZyh5KGUpLCB5KHQpKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gayhlLCB0KSB7CiAgICAgICAgcmV0dXJuIG0oeChlLCB0KSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIF8oZSwgdCwgbikgewogICAgICAgIHJldHVybiB0ID8gbiA/IHgodCwgZSkgOiBrKHQsIGUpIDogbiA/IGIoZSkgOiB3KGUpOwogICAgICB9CgogICAgICB2b2lkIDAgIT09IChyID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfOwogICAgICB9LmNhbGwodCwgbiwgdCwgZSkpICYmIChlLmV4cG9ydHMgPSByKTsKICAgIH0oKTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHQuX19lc01vZHVsZSA9ICEwOwoKICAgIHZhciByID0gZnVuY3Rpb24gcihlKSB7CiAgICAgIGUgPSBlIHx8IG5hdmlnYXRvci51c2VyQWdlbnQ7CiAgICAgIHZhciB0ID0ge30sCiAgICAgICAgICBuID0gewogICAgICAgIFRyaWRlbnQ6IGUuaW5kZXhPZigiVHJpZGVudCIpID4gLTEgfHwgZS5pbmRleE9mKCJORVQgQ0xSIikgPiAtMSwKICAgICAgICBQcmVzdG86IGUuaW5kZXhPZigiUHJlc3RvIikgPiAtMSwKICAgICAgICBXZWJLaXQ6IGUuaW5kZXhPZigiQXBwbGVXZWJLaXQiKSA+IC0xLAogICAgICAgIEdlY2tvOiBlLmluZGV4T2YoIkdlY2tvLyIpID4gLTEsCiAgICAgICAgU2FmYXJpOiBlLmluZGV4T2YoIlNhZmFyaSIpID4gLTEsCiAgICAgICAgRWRnZTogZS5pbmRleE9mKCJFZGdlIikgPiAtMSB8fCBlLmluZGV4T2YoIkVkZyIpID4gLTEsCiAgICAgICAgQ2hyb21lOiBlLmluZGV4T2YoIkNocm9tZSIpID4gLTEgfHwgZS5pbmRleE9mKCJDcmlPUyIpID4gLTEsCiAgICAgICAgSUU6IGUuaW5kZXhPZigiTVNJRSIpID4gLTEgfHwgZS5pbmRleE9mKCJUcmlkZW50IikgPiAtMSwKICAgICAgICBGaXJlZm94OiBlLmluZGV4T2YoIkZpcmVmb3giKSA+IC0xIHx8IGUuaW5kZXhPZigiRnhpT1MiKSA+IC0xLAogICAgICAgICJGaXJlZm94IEZvY3VzIjogZS5pbmRleE9mKCJGb2N1cyIpID4gLTEsCiAgICAgICAgQ2hyb21pdW06IGUuaW5kZXhPZigiQ2hyb21pdW0iKSA+IC0xLAogICAgICAgIE9wZXJhOiBlLmluZGV4T2YoIk9wZXJhIikgPiAtMSB8fCBlLmluZGV4T2YoIk9QUiIpID4gLTEsCiAgICAgICAgVml2YWxkaTogZS5pbmRleE9mKCJWaXZhbGRpIikgPiAtMSwKICAgICAgICBZYW5kZXg6IGUuaW5kZXhPZigiWWFCcm93c2VyIikgPiAtMSwKICAgICAgICBLaW5kbGU6IGUuaW5kZXhPZigiS2luZGxlIikgPiAtMSB8fCBlLmluZGV4T2YoIlNpbGsvIikgPiAtMSwKICAgICAgICAzNjA6IGUuaW5kZXhPZigiMzYwRUUiKSA+IC0xIHx8IGUuaW5kZXhPZigiMzYwU0UiKSA+IC0xLAogICAgICAgIFVDOiBlLmluZGV4T2YoIlVDIikgPiAtMSB8fCBlLmluZGV4T2YoIiBVQnJvd3NlciIpID4gLTEsCiAgICAgICAgUVFCcm93c2VyOiBlLmluZGV4T2YoIlFRQnJvd3NlciIpID4gLTEsCiAgICAgICAgUVE6IGUuaW5kZXhPZigiUVEvIikgPiAtMSwKICAgICAgICBCYWlkdTogZS5pbmRleE9mKCJCYWlkdSIpID4gLTEgfHwgZS5pbmRleE9mKCJCSURVQnJvd3NlciIpID4gLTEsCiAgICAgICAgTWF4dGhvbjogZS5pbmRleE9mKCJNYXh0aG9uIikgPiAtMSwKICAgICAgICBTb2dvdTogZS5pbmRleE9mKCJNZXRhU3IiKSA+IC0xIHx8IGUuaW5kZXhPZigiU29nb3UiKSA+IC0xLAogICAgICAgIExCQlJPV1NFUjogZS5pbmRleE9mKCJMQkJST1dTRVIiKSA+IC0xLAogICAgICAgICIyMzQ1RXhwbG9yZXIiOiBlLmluZGV4T2YoIjIzNDVFeHBsb3JlciIpID4gLTEsCiAgICAgICAgVGhlV29ybGQ6IGUuaW5kZXhPZigiVGhlV29ybGQiKSA+IC0xLAogICAgICAgIFhpYW9NaTogZS5pbmRleE9mKCJNaXVpQnJvd3NlciIpID4gLTEsCiAgICAgICAgUXVhcms6IGUuaW5kZXhPZigiUXVhcmsiKSA+IC0xLAogICAgICAgIFFpeXU6IGUuaW5kZXhPZigiUWl5dSIpID4gLTEsCiAgICAgICAgV2VjaGF0OiBlLmluZGV4T2YoIk1pY3JvTWVzc2VuZ2VyIikgPiAtMSwKICAgICAgICBUYW9iYW86IGUuaW5kZXhPZigiQWxpQXBwKFRCIikgPiAtMSwKICAgICAgICBBbGlwYXk6IGUuaW5kZXhPZigiQWxpQXBwKEFQIikgPiAtMSwKICAgICAgICBXZWlibzogZS5pbmRleE9mKCJXZWlibyIpID4gLTEsCiAgICAgICAgRG91YmFuOiBlLmluZGV4T2YoImNvbS5kb3ViYW4uZnJvZG8iKSA+IC0xLAogICAgICAgIFN1bmluZzogZS5pbmRleE9mKCJTTkVCVVktQVBQIikgPiAtMSwKICAgICAgICBpUWlZaTogZS5pbmRleE9mKCJJcWl5aUFwcCIpID4gLTEsCiAgICAgICAgV2luZG93czogZS5pbmRleE9mKCJXaW5kb3dzIikgPiAtMSwKICAgICAgICBMaW51eDogZS5pbmRleE9mKCJMaW51eCIpID4gLTEgfHwgZS5pbmRleE9mKCJYMTEiKSA+IC0xLAogICAgICAgIG1hY09TOiBlLmluZGV4T2YoIk1hY2ludG9zaCIpID4gLTEsCiAgICAgICAgQW5kcm9pZDogZS5pbmRleE9mKCJBbmRyb2lkIikgPiAtMSB8fCBlLmluZGV4T2YoIkFkciIpID4gLTEsCiAgICAgICAgVWJ1bnR1OiBlLmluZGV4T2YoIlVidW50dSIpID4gLTEsCiAgICAgICAgRnJlZUJTRDogZS5pbmRleE9mKCJGcmVlQlNEIikgPiAtMSwKICAgICAgICBEZWJpYW46IGUuaW5kZXhPZigiRGViaWFuIikgPiAtMSwKICAgICAgICAiV2luZG93cyBQaG9uZSI6IGUuaW5kZXhPZigiSUVNb2JpbGUiKSA+IC0xIHx8IGUuaW5kZXhPZigiV2luZG93cyBQaG9uZSIpID4gLTEsCiAgICAgICAgQmxhY2tCZXJyeTogZS5pbmRleE9mKCJCbGFja0JlcnJ5IikgPiAtMSB8fCBlLmluZGV4T2YoIlJJTSIpID4gLTEgfHwgZS5pbmRleE9mKCJCQjEwIikgPiAtMSwKICAgICAgICBNZWVHbzogZS5pbmRleE9mKCJNZWVHbyIpID4gLTEsCiAgICAgICAgU3ltYmlhbjogZS5pbmRleE9mKCJTeW1iaWFuIikgPiAtMSwKICAgICAgICBpT1M6IGUuaW5kZXhPZigibGlrZSBNYWMgT1MgWCIpID4gLTEsCiAgICAgICAgIkNocm9tZSBPUyI6IGUuaW5kZXhPZigiQ3JPUyIpID4gLTEsCiAgICAgICAgV2ViT1M6IGUuaW5kZXhPZigiaHB3T1MiKSA+IC0xLAogICAgICAgIE1vYmlsZTogZS5pbmRleE9mKCJNb2JpIikgPiAtMSB8fCBlLmluZGV4T2YoImlQaCIpID4gLTEgfHwgZS5pbmRleE9mKCI0ODAiKSA+IC0xLAogICAgICAgIFRhYmxldDogZS5pbmRleE9mKCJUYWJsZXQiKSA+IC0xIHx8IGUuaW5kZXhPZigiUGFkIikgPiAtMSB8fCBlLmluZGV4T2YoIk5leHVzIDciKSA+IC0xCiAgICAgIH07CiAgICAgIG4uTW9iaWxlICYmIChuLk1vYmlsZSA9ICEoZS5pbmRleE9mKCJpUGFkIikgPiAtMSkpOwogICAgICB2YXIgciA9IHsKICAgICAgICBicm93c2VyOiBbIlNhZmFyaSIsICJDaHJvbWUiLCAiRWRnZSIsICJJRSIsICJGaXJlZm94IiwgIkZpcmVmb3ggRm9jdXMiLCAiQ2hyb21pdW0iLCAiT3BlcmEiLCAiVml2YWxkaSIsICJZYW5kZXgiLCAiS2luZGxlIiwgIjM2MCIsICJVQyIsICJRUUJyb3dzZXIiLCAiUVEiLCAiQmFpZHUiLCAiTWF4dGhvbiIsICJTb2dvdSIsICJMQkJST1dTRVIiLCAiMjM0NUV4cGxvcmVyIiwgIlRoZVdvcmxkIiwgIlhpYW9NaSIsICJRdWFyayIsICJRaXl1IiwgIldlY2hhdCIsICJUYW9iYW8iLCAiQWxpcGF5IiwgIldlaWJvIiwgIkRvdWJhbiIsICJTdW5pbmciLCAiaVFpWWkiXSwKICAgICAgICBvczogWyJXaW5kb3dzIiwgIkxpbnV4IiwgIk1hYyBPUyIsICJtYWNPUyIsICJBbmRyb2lkIiwgIlVidW50dSIsICJGcmVlQlNEIiwgIkRlYmlhbiIsICJpT1MiLCAiV2luZG93cyBQaG9uZSIsICJCbGFja0JlcnJ5IiwgIk1lZUdvIiwgIlN5bWJpYW4iLCAiQ2hyb21lIE9TIiwgIldlYk9TIl0KICAgICAgfTsKCiAgICAgIGZvciAodmFyIG8gaW4gcikgewogICAgICAgIGlmIChyLmhhc093blByb3BlcnR5KG8pKSBmb3IgKHZhciBpID0gMCwgYSA9IHJbb10ubGVuZ3RoOyBpIDwgYTsgaSsrKSB7CiAgICAgICAgICB2YXIgcyA9IHJbb11baV07CiAgICAgICAgICBuW3NdICYmICh0W29dID0gcyk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgbCA9IHsKICAgICAgICBXaW5kb3dzOiBmdW5jdGlvbiBXaW5kb3dzKCkgewogICAgICAgICAgdmFyIHQgPSBlLnJlcGxhY2UoL14uKldpbmRvd3MgTlQgKFtcZC5dKykuKiQvLCAiJDEiKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIDYuNDogIjEwIiwKICAgICAgICAgICAgNi4zOiAiOC4xIiwKICAgICAgICAgICAgNi4yOiAiOCIsCiAgICAgICAgICAgIDYuMTogIjciLAogICAgICAgICAgICAiNi4wIjogIlZpc3RhIiwKICAgICAgICAgICAgNS4yOiAiWFAiLAogICAgICAgICAgICA1LjE6ICJYUCIsCiAgICAgICAgICAgICI1LjAiOiAiMjAwMCIKICAgICAgICAgIH1bdF0gfHwgdDsKICAgICAgICB9LAogICAgICAgIEFuZHJvaWQ6IGUucmVwbGFjZSgvXi4qQW5kcm9pZCAoW1xkLl0rKTsuKiQvLCAiJDEiKSwKICAgICAgICBpT1M6IGUucmVwbGFjZSgvXi4qT1MgKFtcZF9dKykgbGlrZS4qJC8sICIkMSIpLnJlcGxhY2UoL18vZywgIi4iKSwKICAgICAgICBEZWJpYW46IGUucmVwbGFjZSgvXi4qRGViaWFuXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgICJXaW5kb3dzIFBob25lIjogZS5yZXBsYWNlKC9eLipXaW5kb3dzIFBob25lKCBPUyk/IChbXGQuXSspOy4qJC8sICIkMiIpLAogICAgICAgIG1hY09TOiBlLnJlcGxhY2UoL14uKk1hYyBPUyBYIChbXGRfXSspLiokLywgIiQxIikucmVwbGFjZSgvXy9nLCAiLiIpLAogICAgICAgIFdlYk9TOiBlLnJlcGxhY2UoL14uKmhwd09TXC8oW1xkLl0rKTsuKiQvLCAiJDEiKSwKICAgICAgICBCbGFja0JlcnJ5OiBlLnJlcGxhY2UoL14uKkJCKFtcZC5dKyk7KiQvLCAiJDEiKQogICAgICB9OwogICAgICB0Lm9zVmVyc2lvbiA9ICIiOwogICAgICB2YXIgYyA9IGxbdC5vc107CiAgICAgIGMgJiYgKHQub3NWZXJzaW9uID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgYyA/IGMoKSA6IGMgPT0gZSA/ICIiIDogYyk7CiAgICAgIHZhciB1ID0gewogICAgICAgIFNhZmFyaTogZS5yZXBsYWNlKC9eLipWZXJzaW9uXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIENocm9tZTogZS5yZXBsYWNlKC9eLipDaHJvbWVcLyhbXGQuXSspLiokLywgIiQxIikucmVwbGFjZSgvXi4qQ3JpT1NcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgSUU6IGUucmVwbGFjZSgvXi4qTVNJRSAoW1xkLl0rKS4qJC8sICIkMSIpLnJlcGxhY2UoL14uKnJ2OihbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgRWRnZTogZS5yZXBsYWNlKC9eLipFZGdlP1wvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBGaXJlZm94OiBlLnJlcGxhY2UoL14uKkZpcmVmb3hcLyhbXGQuXSspLiokLywgIiQxIikucmVwbGFjZSgvXi4qRnhpT1NcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgIkZpcmVmb3ggRm9jdXMiOiBlLnJlcGxhY2UoL14uKkZvY3VzXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIENocm9taXVtOiBlLnJlcGxhY2UoL14uKkNocm9taXVtXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIE9wZXJhOiBlLnJlcGxhY2UoL14uKk9wZXJhXC8oW1xkLl0rKS4qJC8sICIkMSIpLnJlcGxhY2UoL14uKk9QUlwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBWaXZhbGRpOiBlLnJlcGxhY2UoL14uKlZpdmFsZGlcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgWWFuZGV4OiBlLnJlcGxhY2UoL14uKllhQnJvd3NlclwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBLaW5kbGU6IGUucmVwbGFjZSgvXi4qVmVyc2lvblwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBNYXh0aG9uOiBlLnJlcGxhY2UoL14uKk1heHRob25cLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgUVFCcm93c2VyOiBlLnJlcGxhY2UoL14uKlFRQnJvd3NlclwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBRUTogZS5yZXBsYWNlKC9eLipRUVwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBCYWlkdTogZS5yZXBsYWNlKC9eLipCSURVQnJvd3Nlcltcc1wvXShbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgVUM6IGUucmVwbGFjZSgvXi4qVUM/QnJvd3NlclwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBTb2dvdTogZS5yZXBsYWNlKC9eLipTRSAoW1xkLlhdKykuKiQvLCAiJDEiKS5yZXBsYWNlKC9eLipTb2dvdU1vYmlsZUJyb3dzZXJcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgIjIzNDVFeHBsb3JlciI6IGUucmVwbGFjZSgvXi4qMjM0NUV4cGxvcmVyXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFRoZVdvcmxkOiBlLnJlcGxhY2UoL14uKlRoZVdvcmxkIChbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgWGlhb01pOiBlLnJlcGxhY2UoL14uKk1pdWlCcm93c2VyXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFF1YXJrOiBlLnJlcGxhY2UoL14uKlF1YXJrXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFFpeXU6IGUucmVwbGFjZSgvXi4qUWl5dVwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBXZWNoYXQ6IGUucmVwbGFjZSgvXi4qTWljcm9NZXNzZW5nZXJcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgVGFvYmFvOiBlLnJlcGxhY2UoL14uKkFsaUFwcFwoVEJcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgQWxpcGF5OiBlLnJlcGxhY2UoL14uKkFsaUFwcFwoQVBcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgV2VpYm86IGUucmVwbGFjZSgvXi4qd2VpYm9fXyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgRG91YmFuOiBlLnJlcGxhY2UoL14uKmNvbS5kb3ViYW4uZnJvZG9cLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgU3VuaW5nOiBlLnJlcGxhY2UoL14uKlNORUJVWS1BUFAoW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIGlRaVlpOiBlLnJlcGxhY2UoL14uKklxaXlpVmVyc2lvblwvKFtcZC5dKykuKiQvLCAiJDEiKQogICAgICB9OwogICAgICB0LnZlcnNpb24gPSAiIjsKICAgICAgdmFyIGQgPSB1W3QuYnJvd3Nlcl07CiAgICAgIHJldHVybiBkICYmICh0LnZlcnNpb24gPSAiZnVuY3Rpb24iID09IHR5cGVvZiBkID8gZCgpIDogZCA9PSBlID8gIiIgOiBkKSwgdm9pZCAwID09IHQuYnJvd3NlciAmJiAodC5icm93c2VyID0gIlVua25vdyBBcHAiKSwgdDsKICAgIH07CgogICAgdFsiZGVmYXVsdCJdID0gcjsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgdmFyIHIsIG87CiAgICAhZnVuY3Rpb24gKG4sIGkpIHsKICAgICAgdmFyIGkgPSBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgICAgIGZ1bmN0aW9uIHIobywgaSwgYSkgewogICAgICAgICAgcmV0dXJuIGEgPSBPYmplY3QuY3JlYXRlKHIuZm4pLCBvICYmIGEucHVzaC5hcHBseShhLCBvW3RdID8gW29dIDogIiIgKyBvID09PSBvID8gLzwvLnRlc3QobykgPyAoKGkgPSBlLmNyZWF0ZUVsZW1lbnQoaSkpLmlubmVySFRNTCA9IG8sIGkuY2hpbGRyZW4pIDogaSA/IChpID0gcihpKVswXSkgPyBpW25dKG8pIDogYSA6IGVbbl0obykgOiBvKSwgYTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByLmZuID0gW10sIHIub25lID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIHJldHVybiByKGUsIHQpWzBdIHx8IG51bGw7CiAgICAgICAgfSwgcjsKICAgICAgfShkb2N1bWVudCwgImFkZEV2ZW50TGlzdGVuZXIiLCAicXVlcnlTZWxlY3RvckFsbCIpOwoKICAgICAgciA9IFtdLCB2b2lkIDAgIT09IChvID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBpOwogICAgICB9LmFwcGx5KHQsIHIpKSAmJiAoZS5leHBvcnRzID0gbyk7CiAgICB9KCk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIGZ1bmN0aW9uIHIoZSkgewogICAgICByZXR1cm4gdm9pZCAwID09PSBlIHx8IG51bGwgPT09IGU7CiAgICB9CgogICAgZnVuY3Rpb24gbyhlKSB7CiAgICAgIHZhciB0ID0ge307CgogICAgICBmb3IgKHZhciBuIGluIGUpIHsKICAgICAgICB0W25dID0gZVtuXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHQ7CiAgICB9CgogICAgZnVuY3Rpb24gaShlKSB7CiAgICAgIGUgPSBvKGUgfHwge30pLCBlLndoaXRlTGlzdCA9IGUud2hpdGVMaXN0IHx8IGEud2hpdGVMaXN0LCBlLm9uQXR0ciA9IGUub25BdHRyIHx8IGEub25BdHRyLCBlLm9uSWdub3JlQXR0ciA9IGUub25JZ25vcmVBdHRyIHx8IGEub25JZ25vcmVBdHRyLCBlLnNhZmVBdHRyVmFsdWUgPSBlLnNhZmVBdHRyVmFsdWUgfHwgYS5zYWZlQXR0clZhbHVlLCB0aGlzLm9wdGlvbnMgPSBlOwogICAgfQoKICAgIHZhciBhID0gbig3KSwKICAgICAgICBzID0gbigzMCk7CiAgICBuKDgpOwogICAgaS5wcm90b3R5cGUucHJvY2VzcyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChlID0gZSB8fCAiIiwgIShlID0gZS50b1N0cmluZygpKSkgcmV0dXJuICIiOwogICAgICB2YXIgdCA9IHRoaXMsCiAgICAgICAgICBuID0gdC5vcHRpb25zLAogICAgICAgICAgbyA9IG4ud2hpdGVMaXN0LAogICAgICAgICAgaSA9IG4ub25BdHRyLAogICAgICAgICAgYSA9IG4ub25JZ25vcmVBdHRyLAogICAgICAgICAgbCA9IG4uc2FmZUF0dHJWYWx1ZTsKICAgICAgcmV0dXJuIHMoZSwgZnVuY3Rpb24gKGUsIHQsIG4sIHMsIGMpIHsKICAgICAgICB2YXIgdSA9IG9bbl0sCiAgICAgICAgICAgIGQgPSAhMTsKCiAgICAgICAgaWYgKCEwID09PSB1ID8gZCA9IHUgOiAiZnVuY3Rpb24iID09IHR5cGVvZiB1ID8gZCA9IHUocykgOiB1IGluc3RhbmNlb2YgUmVnRXhwICYmIChkID0gdS50ZXN0KHMpKSwgITAgIT09IGQgJiYgKGQgPSAhMSksIHMgPSBsKG4sIHMpKSB7CiAgICAgICAgICB2YXIgcCA9IHsKICAgICAgICAgICAgcG9zaXRpb246IHQsCiAgICAgICAgICAgIHNvdXJjZVBvc2l0aW9uOiBlLAogICAgICAgICAgICBzb3VyY2U6IGMsCiAgICAgICAgICAgIGlzV2hpdGU6IGQKICAgICAgICAgIH07CgogICAgICAgICAgaWYgKGQpIHsKICAgICAgICAgICAgdmFyIGYgPSBpKG4sIHMsIHApOwogICAgICAgICAgICByZXR1cm4gcihmKSA/IG4gKyAiOiIgKyBzIDogZjsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZiA9IGEobiwgcywgcCk7CiAgICAgICAgICByZXR1cm4gcihmKSA/IHZvaWQgMCA6IGY7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sIGUuZXhwb3J0cyA9IGk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIGZ1bmN0aW9uIHIoZSwgdCkgewogICAgICBmdW5jdGlvbiBuKCkgewogICAgICAgIGlmICghaSkgewogICAgICAgICAgdmFyIG4gPSBvLnRyaW0oZS5zbGljZShhLCBzKSksCiAgICAgICAgICAgICAgciA9IG4uaW5kZXhPZigiOiIpOwoKICAgICAgICAgIGlmICgtMSAhPT0gcikgewogICAgICAgICAgICB2YXIgYyA9IG8udHJpbShuLnNsaWNlKDAsIHIpKSwKICAgICAgICAgICAgICAgIHUgPSBvLnRyaW0obi5zbGljZShyICsgMSkpOwoKICAgICAgICAgICAgaWYgKGMpIHsKICAgICAgICAgICAgICB2YXIgZCA9IHQoYSwgbC5sZW5ndGgsIGMsIHUsIG4pOwogICAgICAgICAgICAgIGQgJiYgKGwgKz0gZCArICI7ICIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBhID0gcyArIDE7CiAgICAgIH0KCiAgICAgIGUgPSBvLnRyaW1SaWdodChlKSwgIjsiICE9PSBlW2UubGVuZ3RoIC0gMV0gJiYgKGUgKz0gIjsiKTsKCiAgICAgIGZvciAodmFyIHIgPSBlLmxlbmd0aCwgaSA9ICExLCBhID0gMCwgcyA9IDAsIGwgPSAiIjsgcyA8IHI7IHMrKykgewogICAgICAgIHZhciBjID0gZVtzXTsKCiAgICAgICAgaWYgKCIvIiA9PT0gYyAmJiAiKiIgPT09IGVbcyArIDFdKSB7CiAgICAgICAgICB2YXIgdSA9IGUuaW5kZXhPZigiKi8iLCBzICsgMik7CiAgICAgICAgICBpZiAoLTEgPT09IHUpIGJyZWFrOwogICAgICAgICAgcyA9IHUgKyAxLCBhID0gcyArIDEsIGkgPSAhMTsKICAgICAgICB9IGVsc2UgIigiID09PSBjID8gaSA9ICEwIDogIikiID09PSBjID8gaSA9ICExIDogIjsiID09PSBjID8gaSB8fCBuKCkgOiAiXG4iID09PSBjICYmIG4oKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG8udHJpbShsKTsKICAgIH0KCiAgICB2YXIgbyA9IG4oOCk7CiAgICBlLmV4cG9ydHMgPSByOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBuKDM1KSwKICAgICAgICBvID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZywKICAgICAgICBpID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSwKICAgICAgICBhID0gZnVuY3Rpb24gYShlLCB0LCBuKSB7CiAgICAgIGZvciAodmFyIHIgPSAwLCBvID0gZS5sZW5ndGg7IHIgPCBvOyByKyspIHsKICAgICAgICBpLmNhbGwoZSwgcikgJiYgKG51bGwgPT0gbiA/IHQoZVtyXSwgciwgZSkgOiB0LmNhbGwobiwgZVtyXSwgciwgZSkpOwogICAgICB9CiAgICB9LAogICAgICAgIHMgPSBmdW5jdGlvbiBzKGUsIHQsIG4pIHsKICAgICAgZm9yICh2YXIgciA9IDAsIG8gPSBlLmxlbmd0aDsgciA8IG87IHIrKykgewogICAgICAgIG51bGwgPT0gbiA/IHQoZS5jaGFyQXQociksIHIsIGUpIDogdC5jYWxsKG4sIGUuY2hhckF0KHIpLCByLCBlKTsKICAgICAgfQogICAgfSwKICAgICAgICBsID0gZnVuY3Rpb24gbChlLCB0LCBuKSB7CiAgICAgIGZvciAodmFyIHIgaW4gZSkgewogICAgICAgIGkuY2FsbChlLCByKSAmJiAobnVsbCA9PSBuID8gdChlW3JdLCByLCBlKSA6IHQuY2FsbChuLCBlW3JdLCByLCBlKSk7CiAgICAgIH0KICAgIH0sCiAgICAgICAgYyA9IGZ1bmN0aW9uIGMoZSwgdCwgbikgewogICAgICBpZiAoIXIodCkpIHRocm93IG5ldyBUeXBlRXJyb3IoIml0ZXJhdG9yIG11c3QgYmUgYSBmdW5jdGlvbiIpOwogICAgICB2YXIgaTsKICAgICAgYXJndW1lbnRzLmxlbmd0aCA+PSAzICYmIChpID0gbiksICJbb2JqZWN0IEFycmF5XSIgPT09IG8uY2FsbChlKSA/IGEoZSwgdCwgaSkgOiAic3RyaW5nIiA9PSB0eXBlb2YgZSA/IHMoZSwgdCwgaSkgOiBsKGUsIHQsIGkpOwogICAgfTsKCiAgICBlLmV4cG9ydHMgPSBjOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UsCiAgICAgICAgbyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CgogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHQgPSB0aGlzOwogICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgdCB8fCAiW29iamVjdCBGdW5jdGlvbl0iICE9PSBvLmNhbGwodCkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kIGNhbGxlZCBvbiBpbmNvbXBhdGlibGUgIiArIHQpOwoKICAgICAgZm9yICh2YXIgbiwgaSA9IHIuY2FsbChhcmd1bWVudHMsIDEpLCBhID0gZnVuY3Rpb24gYSgpIHsKICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIG4pIHsKICAgICAgICAgIHZhciBvID0gdC5hcHBseSh0aGlzLCBpLmNvbmNhdChyLmNhbGwoYXJndW1lbnRzKSkpOwogICAgICAgICAgcmV0dXJuIE9iamVjdChvKSA9PT0gbyA/IG8gOiB0aGlzOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHQuYXBwbHkoZSwgaS5jb25jYXQoci5jYWxsKGFyZ3VtZW50cykpKTsKICAgICAgfSwgcyA9IE1hdGgubWF4KDAsIHQubGVuZ3RoIC0gaS5sZW5ndGgpLCBsID0gW10sIGMgPSAwOyBjIDwgczsgYysrKSB7CiAgICAgICAgbC5wdXNoKCIkIiArIGMpOwogICAgICB9CgogICAgICBpZiAobiA9IEZ1bmN0aW9uKCJiaW5kZXIiLCAicmV0dXJuIGZ1bmN0aW9uICgiICsgbC5qb2luKCIsIikgKyAiKXsgcmV0dXJuIGJpbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7IH0iKShhKSwgdC5wcm90b3R5cGUpIHsKICAgICAgICB2YXIgdSA9IGZ1bmN0aW9uIHUoKSB7fTsKCiAgICAgICAgdS5wcm90b3R5cGUgPSB0LnByb3RvdHlwZSwgbi5wcm90b3R5cGUgPSBuZXcgdSgpLCB1LnByb3RvdHlwZSA9IG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgIWZ1bmN0aW9uICh0LCBuKSB7CiAgICAgIGUuZXhwb3J0cyA9IG4oKTsKICAgIH0oMCwgZnVuY3Rpb24gKCkgewogICAgICAidXNlIHN0cmljdCI7CgogICAgICBmdW5jdGlvbiBlKGUpIHsKICAgICAgICByZXR1cm4gJzxzcGFuIHN0eWxlPSJjb2xvcjogc2xhdGVncmF5Ij4nICsgZSArICI8L3NwYW4+IjsKICAgICAgfQoKICAgICAgdmFyIHQgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiB0ID0gewogICAgICAgICAgZXhwb3J0czoge30KICAgICAgICB9LCBlKHQsIHQuZXhwb3J0cyksIHQuZXhwb3J0czsKICAgICAgfShmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0gZS5leHBvcnRzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoIig/OiIgKyB0LmxpbmUoKS5zb3VyY2UgKyAiKXwoPzoiICsgdC5ibG9jaygpLnNvdXJjZSArICIpIiwgImdtIik7CiAgICAgICAgfTsKCiAgICAgICAgdC5saW5lID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIC8oPzpefFxzKVwvXC8oLis/KSQvZ207CiAgICAgICAgfSwgdC5ibG9jayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiAvXC9cKihbXFNcc10qPylcKlwvL2dtOwogICAgICAgIH07CiAgICAgIH0pLAogICAgICAgICAgbiA9IFsiMjNBQzY5IiwgIjkxQzEzMiIsICJGMTk3MjYiLCAiRTg1NTJEIiwgIjFBQUI4RSIsICJFMTE0N0YiLCAiMjk4MEMxIiwgIjFCQTFFNiIsICI5RkEwQTAiLCAiRjE5NzI2IiwgIkUzMEIyMCIsICJFMzBCMjAiLCAiQTMzMzhCIl07CgogICAgICByZXR1cm4gZnVuY3Rpb24gKHIsIG8pIHsKICAgICAgICB2b2lkIDAgPT09IG8gJiYgKG8gPSB7fSk7CiAgICAgICAgdmFyIGkgPSBvLmNvbG9yczsKICAgICAgICB2b2lkIDAgPT09IGkgJiYgKGkgPSBuKTsKICAgICAgICB2YXIgYSA9IDAsCiAgICAgICAgICAgIHMgPSB7fSwKICAgICAgICAgICAgbCA9IC9bXHU0RTAwLVx1OUZGRlx1MzQwMC1cdTRkYmZcdWY5MDAtXHVmYWZmXHUzMDQwLVx1MzA5Zlx1YWMwMC1cdWQ3YWZcdTA0MDAtXHUwNEZGXSt8XHcrLywKICAgICAgICAgICAgYyA9IC88LywKICAgICAgICAgICAgdSA9IG5ldyBSZWdFeHAoIigiICsgbC5zb3VyY2UgKyAifCIgKyBjLnNvdXJjZSArICIpfCgiICsgdCgpLnNvdXJjZSArICIpIiwgImdtaSIpOwogICAgICAgIHJldHVybiByLnJlcGxhY2UodSwgZnVuY3Rpb24gKHQsIG4sIHIpIHsKICAgICAgICAgIGlmIChyKSByZXR1cm4gZShyKTsKICAgICAgICAgIGlmICgiPCIgPT09IG4pIHJldHVybiAiJmx0OyI7CiAgICAgICAgICB2YXIgbzsKICAgICAgICAgIHNbbl0gPyBvID0gc1tuXSA6IChvID0gaVthXSwgc1tuXSA9IG8pOwogICAgICAgICAgdmFyIGwgPSAnPHNwYW4gc3R5bGU9ImNvbG9yOiAjJyArIG8gKyAnIj4nICsgbiArICI8L3NwYW4+IjsKICAgICAgICAgIHJldHVybiBhID0gKythICUgaS5sZW5ndGgsIGw7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICB9KTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gbig0KTsKICAgIGUuZXhwb3J0cyA9IHIuY2FsbChGdW5jdGlvbi5jYWxsLCBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5KTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gRnVuY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nLAogICAgICAgIG8gPSAvXlxzKmNsYXNzXGIvLAogICAgICAgIGkgPSBmdW5jdGlvbiBpKGUpIHsKICAgICAgdHJ5IHsKICAgICAgICB2YXIgdCA9IHIuY2FsbChlKTsKICAgICAgICByZXR1cm4gby50ZXN0KHQpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuICExOwogICAgICB9CiAgICB9LAogICAgICAgIGEgPSBmdW5jdGlvbiBhKGUpIHsKICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gIWkoZSkgJiYgKHIuY2FsbChlKSwgITApOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuICExOwogICAgICB9CiAgICB9LAogICAgICAgIHMgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLAogICAgICAgIGwgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gX3R5cGVvZihTeW1ib2wudG9TdHJpbmdUYWcpOwoKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmICghZSkgcmV0dXJuICExOwogICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgZSAmJiAib2JqZWN0IiAhPSBfdHlwZW9mKGUpKSByZXR1cm4gITE7CiAgICAgIGlmICgiZnVuY3Rpb24iID09IHR5cGVvZiBlICYmICFlLnByb3RvdHlwZSkgcmV0dXJuICEwOwogICAgICBpZiAobCkgcmV0dXJuIGEoZSk7CiAgICAgIGlmIChpKGUpKSByZXR1cm4gITE7CiAgICAgIHZhciB0ID0gcy5jYWxsKGUpOwogICAgICByZXR1cm4gIltvYmplY3QgRnVuY3Rpb25dIiA9PT0gdCB8fCAiW29iamVjdCBHZW5lcmF0b3JGdW5jdGlvbl0iID09PSB0OwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgKGZ1bmN0aW9uICh0KSB7CiAgICAgICFmdW5jdGlvbiAodCkgewogICAgICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgICB0aGlzLnRva2VucyA9IFtdLCB0aGlzLnRva2Vucy5saW5rcyA9IHt9LCB0aGlzLm9wdGlvbnMgPSBlIHx8IGguZGVmYXVsdHMsIHRoaXMucnVsZXMgPSB2Lm5vcm1hbCwgdGhpcy5vcHRpb25zLnBlZGFudGljID8gdGhpcy5ydWxlcyA9IHYucGVkYW50aWMgOiB0aGlzLm9wdGlvbnMuZ2ZtICYmICh0aGlzLm9wdGlvbnMudGFibGVzID8gdGhpcy5ydWxlcyA9IHYudGFibGVzIDogdGhpcy5ydWxlcyA9IHYuZ2ZtKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHIoZSwgdCkgewogICAgICAgICAgaWYgKHRoaXMub3B0aW9ucyA9IHQgfHwgaC5kZWZhdWx0cywgdGhpcy5saW5rcyA9IGUsIHRoaXMucnVsZXMgPSBnLm5vcm1hbCwgdGhpcy5yZW5kZXJlciA9IHRoaXMub3B0aW9ucy5yZW5kZXJlciB8fCBuZXcgbygpLCB0aGlzLnJlbmRlcmVyLm9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsICF0aGlzLmxpbmtzKSB0aHJvdyBuZXcgRXJyb3IoIlRva2VucyBhcnJheSByZXF1aXJlcyBhIGBsaW5rc2AgcHJvcGVydHkuIik7CiAgICAgICAgICB0aGlzLm9wdGlvbnMucGVkYW50aWMgPyB0aGlzLnJ1bGVzID0gZy5wZWRhbnRpYyA6IHRoaXMub3B0aW9ucy5nZm0gJiYgKHRoaXMub3B0aW9ucy5icmVha3MgPyB0aGlzLnJ1bGVzID0gZy5icmVha3MgOiB0aGlzLnJ1bGVzID0gZy5nZm0pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gbyhlKSB7CiAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBlIHx8IGguZGVmYXVsdHM7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpKCkge30KCiAgICAgICAgZnVuY3Rpb24gYShlKSB7CiAgICAgICAgICB0aGlzLnRva2VucyA9IFtdLCB0aGlzLnRva2VuID0gbnVsbCwgdGhpcy5vcHRpb25zID0gZSB8fCBoLmRlZmF1bHRzLCB0aGlzLm9wdGlvbnMucmVuZGVyZXIgPSB0aGlzLm9wdGlvbnMucmVuZGVyZXIgfHwgbmV3IG8oKSwgdGhpcy5yZW5kZXJlciA9IHRoaXMub3B0aW9ucy5yZW5kZXJlciwgdGhpcy5yZW5kZXJlci5vcHRpb25zID0gdGhpcy5vcHRpb25zOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcyhlLCB0KSB7CiAgICAgICAgICByZXR1cm4gZS5yZXBsYWNlKHQgPyAvJi9nIDogLyYoPyEjP1x3KzspL2csICImYW1wOyIpLnJlcGxhY2UoLzwvZywgIiZsdDsiKS5yZXBsYWNlKC8+L2csICImZ3Q7IikucmVwbGFjZSgvIi9nLCAiJnF1b3Q7IikucmVwbGFjZSgvJy9nLCAiJiMzOTsiKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGwoZSkgewogICAgICAgICAgcmV0dXJuIGUucmVwbGFjZSgvJigjKD86XGQrKXwoPzojeFswLTlBLUZhLWZdKyl8KD86XHcrKSk7Py9naSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQgPSB0LnRvTG93ZXJDYXNlKCksICJjb2xvbiIgPT09IHQgPyAiOiIgOiAiIyIgPT09IHQuY2hhckF0KDApID8gIngiID09PSB0LmNoYXJBdCgxKSA/IFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQodC5zdWJzdHJpbmcoMiksIDE2KSkgOiBTdHJpbmcuZnJvbUNoYXJDb2RlKCt0LnN1YnN0cmluZygxKSkgOiAiIjsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gYyhlLCB0KSB7CiAgICAgICAgICByZXR1cm4gZSA9IGUuc291cmNlIHx8IGUsIHQgPSB0IHx8ICIiLCB7CiAgICAgICAgICAgIHJlcGxhY2U6IGZ1bmN0aW9uIHJlcGxhY2UodCwgbikgewogICAgICAgICAgICAgIHJldHVybiBuID0gbi5zb3VyY2UgfHwgbiwgbiA9IG4ucmVwbGFjZSgvKF58W15cW10pXF4vZywgIiQxIiksIGUgPSBlLnJlcGxhY2UodCwgbiksIHRoaXM7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGdldFJlZ2V4OiBmdW5jdGlvbiBnZXRSZWdleCgpIHsKICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlZ0V4cChlLCB0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHUoZSwgdCkgewogICAgICAgICAgcmV0dXJuIG1bIiAiICsgZV0gfHwgKC9eW146XSs6XC8qW14vXSokLy50ZXN0KGUpID8gbVsiICIgKyBlXSA9IGUgKyAiLyIgOiBtWyIgIiArIGVdID0gZS5yZXBsYWNlKC9bXi9dKiQvLCAiIikpLCBlID0gbVsiICIgKyBlXSwgIi8vIiA9PT0gdC5zbGljZSgwLCAyKSA/IGUucmVwbGFjZSgvOltcc1xTXSovLCAiOiIpICsgdCA6ICIvIiA9PT0gdC5jaGFyQXQoMCkgPyBlLnJlcGxhY2UoLyg6XC8qW14vXSopW1xzXFNdKi8sICIkMSIpICsgdCA6IGUgKyB0OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZCgpIHt9CgogICAgICAgIGZ1bmN0aW9uIHAoZSkgewogICAgICAgICAgZm9yICh2YXIgdCwgbiwgciA9IDE7IHIgPCBhcmd1bWVudHMubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgdCA9IGFyZ3VtZW50c1tyXTsKCiAgICAgICAgICAgIGZvciAobiBpbiB0KSB7CiAgICAgICAgICAgICAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIG4pICYmIChlW25dID0gdFtuXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gZTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGYoZSwgdCkgewogICAgICAgICAgdmFyIG4gPSBlLnJlcGxhY2UoLyhbXlxcXSlcfC9nLCAiJDEgfCIpLnNwbGl0KC8gK1x8ICovKSwKICAgICAgICAgICAgICByID0gMDsKICAgICAgICAgIGlmIChuLmxlbmd0aCA+IHQpIG4uc3BsaWNlKHQpO2Vsc2UgZm9yICg7IG4ubGVuZ3RoIDwgdDspIHsKICAgICAgICAgICAgbi5wdXNoKCIiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKDsgciA8IG4ubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgbltyXSA9IG5bcl0ucmVwbGFjZSgvXFxcfC9nLCAifCIpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaChlLCB0LCByKSB7CiAgICAgICAgICBpZiAodm9pZCAwID09PSBlIHx8IG51bGwgPT09IGUpIHRocm93IG5ldyBFcnJvcigibWFya2VkKCk6IGlucHV0IHBhcmFtZXRlciBpcyB1bmRlZmluZWQgb3IgbnVsbCIpOwogICAgICAgICAgaWYgKCJzdHJpbmciICE9IHR5cGVvZiBlKSB0aHJvdyBuZXcgRXJyb3IoIm1hcmtlZCgpOiBpbnB1dCBwYXJhbWV0ZXIgaXMgb2YgdHlwZSAiICsgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpICsgIiwgc3RyaW5nIGV4cGVjdGVkIik7CgogICAgICAgICAgaWYgKHIgfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdCkgewogICAgICAgICAgICByIHx8IChyID0gdCwgdCA9IG51bGwpLCB0ID0gcCh7fSwgaC5kZWZhdWx0cywgdCB8fCB7fSk7CiAgICAgICAgICAgIHZhciBvLAogICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgIGwgPSB0LmhpZ2hsaWdodCwKICAgICAgICAgICAgICAgIGMgPSAwOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBvID0gbi5sZXgoZSwgdCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICByZXR1cm4gcihlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaSA9IG8ubGVuZ3RoOwoKICAgICAgICAgICAgdmFyIHUgPSBmdW5jdGlvbiB1KGUpIHsKICAgICAgICAgICAgICBpZiAoZSkgcmV0dXJuIHQuaGlnaGxpZ2h0ID0gbCwgcihlKTsKICAgICAgICAgICAgICB2YXIgbjsKCiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIG4gPSBhLnBhcnNlKG8sIHQpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgIGUgPSB0OwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIHQuaGlnaGxpZ2h0ID0gbCwgZSA/IHIoZSkgOiByKG51bGwsIG4pOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaWYgKCFsIHx8IGwubGVuZ3RoIDwgMykgcmV0dXJuIHUoKTsKICAgICAgICAgICAgaWYgKGRlbGV0ZSB0LmhpZ2hsaWdodCwgIWkpIHJldHVybiB1KCk7CgogICAgICAgICAgICBmb3IgKDsgYyA8IG8ubGVuZ3RoOyBjKyspIHsKICAgICAgICAgICAgICAhZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICJjb2RlIiAhPT0gZS50eXBlID8gLS1pIHx8IHUoKSA6IGwoZS50ZXh0LCBlLmxhbmcsIGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0ID8gdSh0KSA6IG51bGwgPT0gbiB8fCBuID09PSBlLnRleHQgPyAtLWkgfHwgdSgpIDogKGUudGV4dCA9IG4sIGUuZXNjYXBlZCA9ICEwLCB2b2lkICgtLWkgfHwgdSgpKSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KG9bY10pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHQgJiYgKHQgPSBwKHt9LCBoLmRlZmF1bHRzLCB0KSksIGEucGFyc2Uobi5sZXgoZSwgdCksIHQpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBpZiAoZS5tZXNzYWdlICs9ICJcblBsZWFzZSByZXBvcnQgdGhpcyB0byBodHRwczovL2dpdGh1Yi5jb20vbWFya2VkanMvbWFya2VkLiIsICh0IHx8IGguZGVmYXVsdHMpLnNpbGVudCkgcmV0dXJuICI8cD5BbiBlcnJvciBvY2N1cnJlZDo8L3A+PHByZT4iICsgcyhlLm1lc3NhZ2UgKyAiIiwgITApICsgIjwvcHJlPiI7CiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgdiA9IHsKICAgICAgICAgIG5ld2xpbmU6IC9eXG4rLywKICAgICAgICAgIGNvZGU6IC9eKCB7NH1bXlxuXStcbiopKy8sCiAgICAgICAgICBmZW5jZXM6IGQsCiAgICAgICAgICBocjogL14gezAsM30oKD86LSAqKXszLH18KD86XyAqKXszLH18KD86XCogKil7Myx9KSg/OlxuK3wkKS8sCiAgICAgICAgICBoZWFkaW5nOiAvXiAqKCN7MSw2fSkgKihbXlxuXSs/KSAqKD86IysgKik/KD86XG4rfCQpLywKICAgICAgICAgIG5wdGFibGU6IGQsCiAgICAgICAgICBibG9ja3F1b3RlOiAvXiggezAsM30+ID8ocGFyYWdyYXBofFteXG5dKikoPzpcbnwkKSkrLywKICAgICAgICAgIGxpc3Q6IC9eKCAqKShidWxsKSBbXHNcU10rPyg/OmhyfGRlZnxcbnsyLH0oPyEgKSg/IVwxYnVsbCApXG4qfFxzKiQpLywKICAgICAgICAgIGh0bWw6ICJeIHswLDN9KD86PChzY3JpcHR8cHJlfHN0eWxlKVtcXHM+XVtcXHNcXFNdKj8oPzo8L1xcMT5bXlxcbl0qXFxuK3wkKXxjb21tZW50W15cXG5dKihcXG4rfCQpfDxcXD9bXFxzXFxTXSo/XFw/Plxcbip8PCFbQS1aXVtcXHNcXFNdKj8+XFxuKnw8IVxcW0NEQVRBXFxbW1xcc1xcU10qP1xcXVxcXT5cXG4qfDwvPyh0YWcpKD86ICt8XFxufC8/PilbXFxzXFxTXSo/KD86XFxuezIsfXwkKXw8KD8hc2NyaXB0fHByZXxzdHlsZSkoW2Etel1bXFx3LV0qKSg/OmF0dHJpYnV0ZSkqPyAqLz8+KD89XFxoKlxcbilbXFxzXFxTXSo/KD86XFxuezIsfXwkKXw8Lyg/IXNjcmlwdHxwcmV8c3R5bGUpW2Etel1bXFx3LV0qXFxzKj4oPz1cXGgqXFxuKVtcXHNcXFNdKj8oPzpcXG57Mix9fCQpKSIsCiAgICAgICAgICBkZWY6IC9eIHswLDN9XFsobGFiZWwpXF06ICpcbj8gKjw/KFteXHM+XSspPj8oPzooPzogK1xuPyAqfCAqXG4gKikodGl0bGUpKT8gKig/OlxuK3wkKS8sCiAgICAgICAgICB0YWJsZTogZCwKICAgICAgICAgIGxoZWFkaW5nOiAvXihbXlxuXSspXG4gKig9fC0pezIsfSAqKD86XG4rfCQpLywKICAgICAgICAgIHBhcmFncmFwaDogL14oW15cbl0rKD86XG4oPyFocnxoZWFkaW5nfGxoZWFkaW5nfCB7MCwzfT58PFwvPyg/OnRhZykoPzogK3xcbnxcLz8+KXw8KD86c2NyaXB0fHByZXxzdHlsZXwhLS0pKVteXG5dKykqKS8sCiAgICAgICAgICB0ZXh0OiAvXlteXG5dKy8KICAgICAgICB9OwogICAgICAgIHYuX2xhYmVsID0gLyg/IVxzKlxdKSg/OlxcW1xbXF1dfFteXFtcXV0pKy8sIHYuX3RpdGxlID0gLyg/OiIoPzpcXCI/fFteIlxcXSkqInwnW14nXG5dKig/OlxuW14nXG5dKykqXG4/J3xcKFteKCldKlwpKS8sIHYuZGVmID0gYyh2LmRlZikucmVwbGFjZSgibGFiZWwiLCB2Ll9sYWJlbCkucmVwbGFjZSgidGl0bGUiLCB2Ll90aXRsZSkuZ2V0UmVnZXgoKSwgdi5idWxsZXQgPSAvKD86WyorLV18XGQrXC4pLywgdi5pdGVtID0gL14oICopKGJ1bGwpIFteXG5dKig/OlxuKD8hXDFidWxsIClbXlxuXSopKi8sIHYuaXRlbSA9IGModi5pdGVtLCAiZ20iKS5yZXBsYWNlKC9idWxsL2csIHYuYnVsbGV0KS5nZXRSZWdleCgpLCB2Lmxpc3QgPSBjKHYubGlzdCkucmVwbGFjZSgvYnVsbC9nLCB2LmJ1bGxldCkucmVwbGFjZSgiaHIiLCAiXFxuKyg/PVxcMT8oPzooPzotICopezMsfXwoPzpfICopezMsfXwoPzpcXCogKil7Myx9KSg/Olxcbit8JCkpIikucmVwbGFjZSgiZGVmIiwgIlxcbisoPz0iICsgdi5kZWYuc291cmNlICsgIikiKS5nZXRSZWdleCgpLCB2Ll90YWcgPSAiYWRkcmVzc3xhcnRpY2xlfGFzaWRlfGJhc2V8YmFzZWZvbnR8YmxvY2txdW90ZXxib2R5fGNhcHRpb258Y2VudGVyfGNvbHxjb2xncm91cHxkZHxkZXRhaWxzfGRpYWxvZ3xkaXJ8ZGl2fGRsfGR0fGZpZWxkc2V0fGZpZ2NhcHRpb258ZmlndXJlfGZvb3Rlcnxmb3JtfGZyYW1lfGZyYW1lc2V0fGhbMS02XXxoZWFkfGhlYWRlcnxocnxodG1sfGlmcmFtZXxsZWdlbmR8bGl8bGlua3xtYWlufG1lbnV8bWVudWl0ZW18bWV0YXxuYXZ8bm9mcmFtZXN8b2x8b3B0Z3JvdXB8b3B0aW9ufHB8cGFyYW18c2VjdGlvbnxzb3VyY2V8c3VtbWFyeXx0YWJsZXx0Ym9keXx0ZHx0Zm9vdHx0aHx0aGVhZHx0aXRsZXx0cnx0cmFja3x1bCIsIHYuX2NvbW1lbnQgPSAvPCEtLSg/IS0/PilbXHNcU10qPy0tPi8sIHYuaHRtbCA9IGModi5odG1sLCAiaSIpLnJlcGxhY2UoImNvbW1lbnQiLCB2Ll9jb21tZW50KS5yZXBsYWNlKCJ0YWciLCB2Ll90YWcpLnJlcGxhY2UoImF0dHJpYnV0ZSIsIC8gK1thLXpBLVo6X11bXHcuOi1dKig/OiAqPSAqIlteIlxuXSoifCAqPSAqJ1teJ1xuXSonfCAqPSAqW15ccyInPTw+YF0rKT8vKS5nZXRSZWdleCgpLCB2LnBhcmFncmFwaCA9IGModi5wYXJhZ3JhcGgpLnJlcGxhY2UoImhyIiwgdi5ocikucmVwbGFjZSgiaGVhZGluZyIsIHYuaGVhZGluZykucmVwbGFjZSgibGhlYWRpbmciLCB2LmxoZWFkaW5nKS5yZXBsYWNlKCJ0YWciLCB2Ll90YWcpLmdldFJlZ2V4KCksIHYuYmxvY2txdW90ZSA9IGModi5ibG9ja3F1b3RlKS5yZXBsYWNlKCJwYXJhZ3JhcGgiLCB2LnBhcmFncmFwaCkuZ2V0UmVnZXgoKSwgdi5ub3JtYWwgPSBwKHt9LCB2KSwgdi5nZm0gPSBwKHt9LCB2Lm5vcm1hbCwgewogICAgICAgICAgZmVuY2VzOiAvXiAqKGB7Myx9fH57Myx9KVsgXC5dKihcUyspPyAqXG4oW1xzXFNdKj8pXG4/ICpcMSAqKD86XG4rfCQpLywKICAgICAgICAgIHBhcmFncmFwaDogL14vLAogICAgICAgICAgaGVhZGluZzogL14gKigjezEsNn0pICsoW15cbl0rPykgKiMqICooPzpcbit8JCkvCiAgICAgICAgfSksIHYuZ2ZtLnBhcmFncmFwaCA9IGModi5wYXJhZ3JhcGgpLnJlcGxhY2UoIig/ISIsICIoPyEiICsgdi5nZm0uZmVuY2VzLnNvdXJjZS5yZXBsYWNlKCJcXDEiLCAiXFwyIikgKyAifCIgKyB2Lmxpc3Quc291cmNlLnJlcGxhY2UoIlxcMSIsICJcXDMiKSArICJ8IikuZ2V0UmVnZXgoKSwgdi50YWJsZXMgPSBwKHt9LCB2LmdmbSwgewogICAgICAgICAgbnB0YWJsZTogL14gKihbXnxcbiBdLipcfC4qKVxuICooWy06XSsgKlx8Wy18IDpdKikoPzpcbigoPzouKltePlxuIF0uKig/OlxufCQpKSopXG4qfCQpLywKICAgICAgICAgIHRhYmxlOiAvXiAqXHwoLispXG4gKlx8PyggKlstOl0rWy18IDpdKikoPzpcbigoPzogKltePlxuIF0uKig/OlxufCQpKSopXG4qfCQpLwogICAgICAgIH0pLCB2LnBlZGFudGljID0gcCh7fSwgdi5ub3JtYWwsIHsKICAgICAgICAgIGh0bWw6IGMoIl4gKig/OmNvbW1lbnQgKig/OlxcbnxcXHMqJCl8PCh0YWcpW1xcc1xcU10rPzwvXFwxPiAqKD86XFxuezIsfXxcXHMqJCl8PHRhZyg/OlwiW15cIl0qXCJ8J1teJ10qJ3xcXHNbXidcIi8+XFxzXSopKj8vPz4gKig/OlxcbnsyLH18XFxzKiQpKSIpLnJlcGxhY2UoImNvbW1lbnQiLCB2Ll9jb21tZW50KS5yZXBsYWNlKC90YWcvZywgIig/ISg/OmF8ZW18c3Ryb25nfHNtYWxsfHN8Y2l0ZXxxfGRmbnxhYmJyfGRhdGF8dGltZXxjb2RlfHZhcnxzYW1wfGtiZHxzdWJ8c3VwfGl8Ynx1fG1hcmt8cnVieXxydHxycHxiZGl8YmRvfHNwYW58YnJ8d2JyfGluc3xkZWx8aW1nKVxcYilcXHcrKD8hOnxbXlxcd1xcc0BdKkApXFxiIikuZ2V0UmVnZXgoKSwKICAgICAgICAgIGRlZjogL14gKlxbKFteXF1dKylcXTogKjw/KFteXHM+XSspPj8oPzogKyhbIihdW15cbl0rWyIpXSkpPyAqKD86XG4rfCQpLwogICAgICAgIH0pLCBuLnJ1bGVzID0gdiwgbi5sZXggPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgcmV0dXJuIG5ldyBuKHQpLmxleChlKTsKICAgICAgICB9LCBuLnByb3RvdHlwZS5sZXggPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUgPSBlLnJlcGxhY2UoL1xyXG58XHIvZywgIlxuIikucmVwbGFjZSgvXHQvZywgIiAgICAiKS5yZXBsYWNlKC9cdTAwYTAvZywgIiAiKS5yZXBsYWNlKC9cdTI0MjQvZywgIlxuIiksIHRoaXMudG9rZW4oZSwgITApOwogICAgICAgIH0sIG4ucHJvdG90eXBlLnRva2VuID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIGUgPSBlLnJlcGxhY2UoL14gKyQvZ20sICIiKTsKCiAgICAgICAgICBmb3IgKHZhciBuLCByLCBvLCBpLCBhLCBzLCBsLCBjLCB1LCBkLCBwLCBoLCBnOyBlOykgewogICAgICAgICAgICBpZiAoKG8gPSB0aGlzLnJ1bGVzLm5ld2xpbmUuZXhlYyhlKSkgJiYgKGUgPSBlLnN1YnN0cmluZyhvWzBdLmxlbmd0aCksIG9bMF0ubGVuZ3RoID4gMSAmJiB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB0eXBlOiAic3BhY2UiCiAgICAgICAgICAgIH0pKSwgbyA9IHRoaXMucnVsZXMuY29kZS5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCBvID0gb1swXS5yZXBsYWNlKC9eIHs0fS9nbSwgIiIpLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB0eXBlOiAiY29kZSIsCiAgICAgICAgICAgICAgdGV4dDogdGhpcy5vcHRpb25zLnBlZGFudGljID8gbyA6IG8ucmVwbGFjZSgvXG4rJC8sICIiKQogICAgICAgICAgICB9KTtlbHNlIGlmIChvID0gdGhpcy5ydWxlcy5mZW5jZXMuZXhlYyhlKSkgZSA9IGUuc3Vic3RyaW5nKG9bMF0ubGVuZ3RoKSwgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgdHlwZTogImNvZGUiLAogICAgICAgICAgICAgIGxhbmc6IG9bMl0sCiAgICAgICAgICAgICAgdGV4dDogb1szXSB8fCAiIgogICAgICAgICAgICB9KTtlbHNlIGlmIChvID0gdGhpcy5ydWxlcy5oZWFkaW5nLmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhvWzBdLmxlbmd0aCksIHRoaXMudG9rZW5zLnB1c2goewogICAgICAgICAgICAgIHR5cGU6ICJoZWFkaW5nIiwKICAgICAgICAgICAgICBkZXB0aDogb1sxXS5sZW5ndGgsCiAgICAgICAgICAgICAgdGV4dDogb1syXQogICAgICAgICAgICB9KTtlbHNlIGlmICh0ICYmIChvID0gdGhpcy5ydWxlcy5ucHRhYmxlLmV4ZWMoZSkpICYmIChzID0gewogICAgICAgICAgICAgIHR5cGU6ICJ0YWJsZSIsCiAgICAgICAgICAgICAgaGVhZGVyOiBmKG9bMV0ucmVwbGFjZSgvXiAqfCAqXHwgKiQvZywgIiIpKSwKICAgICAgICAgICAgICBhbGlnbjogb1syXS5yZXBsYWNlKC9eICp8XHwgKiQvZywgIiIpLnNwbGl0KC8gKlx8ICovKSwKICAgICAgICAgICAgICBjZWxsczogb1szXSA/IG9bM10ucmVwbGFjZSgvXG4kLywgIiIpLnNwbGl0KCJcbiIpIDogW10KICAgICAgICAgICAgfSwgcy5oZWFkZXIubGVuZ3RoID09PSBzLmFsaWduLmxlbmd0aCkpIHsKICAgICAgICAgICAgICBmb3IgKGUgPSBlLnN1YnN0cmluZyhvWzBdLmxlbmd0aCksIGMgPSAwOyBjIDwgcy5hbGlnbi5sZW5ndGg7IGMrKykgewogICAgICAgICAgICAgICAgL14gKi0rOiAqJC8udGVzdChzLmFsaWduW2NdKSA/IHMuYWxpZ25bY10gPSAicmlnaHQiIDogL14gKjotKzogKiQvLnRlc3Qocy5hbGlnbltjXSkgPyBzLmFsaWduW2NdID0gImNlbnRlciIgOiAvXiAqOi0rICokLy50ZXN0KHMuYWxpZ25bY10pID8gcy5hbGlnbltjXSA9ICJsZWZ0IiA6IHMuYWxpZ25bY10gPSBudWxsOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZm9yIChjID0gMDsgYyA8IHMuY2VsbHMubGVuZ3RoOyBjKyspIHsKICAgICAgICAgICAgICAgIHMuY2VsbHNbY10gPSBmKHMuY2VsbHNbY10sIHMuaGVhZGVyLmxlbmd0aCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aGlzLnRva2Vucy5wdXNoKHMpOwogICAgICAgICAgICB9IGVsc2UgaWYgKG8gPSB0aGlzLnJ1bGVzLmhyLmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhvWzBdLmxlbmd0aCksIHRoaXMudG9rZW5zLnB1c2goewogICAgICAgICAgICAgIHR5cGU6ICJociIKICAgICAgICAgICAgfSk7ZWxzZSBpZiAobyA9IHRoaXMucnVsZXMuYmxvY2txdW90ZS5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB0eXBlOiAiYmxvY2txdW90ZV9zdGFydCIKICAgICAgICAgICAgfSksIG8gPSBvWzBdLnJlcGxhY2UoL14gKj4gPy9nbSwgIiIpLCB0aGlzLnRva2VuKG8sIHQpLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB0eXBlOiAiYmxvY2txdW90ZV9lbmQiCiAgICAgICAgICAgIH0pO2Vsc2UgaWYgKG8gPSB0aGlzLnJ1bGVzLmxpc3QuZXhlYyhlKSkgewogICAgICAgICAgICAgIGZvciAoZSA9IGUuc3Vic3RyaW5nKG9bMF0ubGVuZ3RoKSwgaSA9IG9bMl0sIHAgPSBpLmxlbmd0aCA+IDEsIHRoaXMudG9rZW5zLnB1c2goewogICAgICAgICAgICAgICAgdHlwZTogImxpc3Rfc3RhcnQiLAogICAgICAgICAgICAgICAgb3JkZXJlZDogcCwKICAgICAgICAgICAgICAgIHN0YXJ0OiBwID8gK2kgOiAiIgogICAgICAgICAgICAgIH0pLCBvID0gb1swXS5tYXRjaCh0aGlzLnJ1bGVzLml0ZW0pLCBuID0gITEsIGQgPSBvLmxlbmd0aCwgYyA9IDA7IGMgPCBkOyBjKyspIHsKICAgICAgICAgICAgICAgIHMgPSBvW2NdLCBsID0gcy5sZW5ndGgsIHMgPSBzLnJlcGxhY2UoL14gKihbKistXXxcZCtcLikgKy8sICIiKSwgfnMuaW5kZXhPZigiXG4gIikgJiYgKGwgLT0gcy5sZW5ndGgsIHMgPSB0aGlzLm9wdGlvbnMucGVkYW50aWMgPyBzLnJlcGxhY2UoL14gezEsNH0vZ20sICIiKSA6IHMucmVwbGFjZShuZXcgUmVnRXhwKCJeIHsxLCIgKyBsICsgIn0iLCAiZ20iKSwgIiIpKSwgdGhpcy5vcHRpb25zLnNtYXJ0TGlzdHMgJiYgYyAhPT0gZCAtIDEgJiYgKGEgPSB2LmJ1bGxldC5leGVjKG9bYyArIDFdKVswXSwgaSA9PT0gYSB8fCBpLmxlbmd0aCA+IDEgJiYgYS5sZW5ndGggPiAxIHx8IChlID0gby5zbGljZShjICsgMSkuam9pbigiXG4iKSArIGUsIGMgPSBkIC0gMSkpLCByID0gbiB8fCAvXG5cbig/IVxzKiQpLy50ZXN0KHMpLCBjICE9PSBkIC0gMSAmJiAobiA9ICJcbiIgPT09IHMuY2hhckF0KHMubGVuZ3RoIC0gMSksIHIgfHwgKHIgPSBuKSksIGggPSAvXlxbWyB4WF1cXSAvLnRlc3QocyksIGcgPSB2b2lkIDAsIGggJiYgKGcgPSAiICIgIT09IHNbMV0sIHMgPSBzLnJlcGxhY2UoL15cW1sgeFhdXF0gKy8sICIiKSksIHRoaXMudG9rZW5zLnB1c2goewogICAgICAgICAgICAgICAgICB0eXBlOiByID8gImxvb3NlX2l0ZW1fc3RhcnQiIDogImxpc3RfaXRlbV9zdGFydCIsCiAgICAgICAgICAgICAgICAgIHRhc2s6IGgsCiAgICAgICAgICAgICAgICAgIGNoZWNrZWQ6IGcKICAgICAgICAgICAgICAgIH0pLCB0aGlzLnRva2VuKHMsICExKSwgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgICAgIHR5cGU6ICJsaXN0X2l0ZW1fZW5kIgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJsaXN0X2VuZCIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChvID0gdGhpcy5ydWxlcy5odG1sLmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhvWzBdLmxlbmd0aCksIHRoaXMudG9rZW5zLnB1c2goewogICAgICAgICAgICAgIHR5cGU6IHRoaXMub3B0aW9ucy5zYW5pdGl6ZSA/ICJwYXJhZ3JhcGgiIDogImh0bWwiLAogICAgICAgICAgICAgIHByZTogIXRoaXMub3B0aW9ucy5zYW5pdGl6ZXIgJiYgKCJwcmUiID09PSBvWzFdIHx8ICJzY3JpcHQiID09PSBvWzFdIHx8ICJzdHlsZSIgPT09IG9bMV0pLAogICAgICAgICAgICAgIHRleHQ6IG9bMF0KICAgICAgICAgICAgfSk7ZWxzZSBpZiAodCAmJiAobyA9IHRoaXMucnVsZXMuZGVmLmV4ZWMoZSkpKSBlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCBvWzNdICYmIChvWzNdID0gb1szXS5zdWJzdHJpbmcoMSwgb1szXS5sZW5ndGggLSAxKSksIHUgPSBvWzFdLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXHMrL2csICIgIiksIHRoaXMudG9rZW5zLmxpbmtzW3VdIHx8ICh0aGlzLnRva2Vucy5saW5rc1t1XSA9IHsKICAgICAgICAgICAgICBocmVmOiBvWzJdLAogICAgICAgICAgICAgIHRpdGxlOiBvWzNdCiAgICAgICAgICAgIH0pO2Vsc2UgaWYgKHQgJiYgKG8gPSB0aGlzLnJ1bGVzLnRhYmxlLmV4ZWMoZSkpICYmIChzID0gewogICAgICAgICAgICAgIHR5cGU6ICJ0YWJsZSIsCiAgICAgICAgICAgICAgaGVhZGVyOiBmKG9bMV0ucmVwbGFjZSgvXiAqfCAqXHwgKiQvZywgIiIpKSwKICAgICAgICAgICAgICBhbGlnbjogb1syXS5yZXBsYWNlKC9eICp8XHwgKiQvZywgIiIpLnNwbGl0KC8gKlx8ICovKSwKICAgICAgICAgICAgICBjZWxsczogb1szXSA/IG9bM10ucmVwbGFjZSgvKD86ICpcfCAqKT9cbiQvLCAiIikuc3BsaXQoIlxuIikgOiBbXQogICAgICAgICAgICB9LCBzLmhlYWRlci5sZW5ndGggPT09IHMuYWxpZ24ubGVuZ3RoKSkgewogICAgICAgICAgICAgIGZvciAoZSA9IGUuc3Vic3RyaW5nKG9bMF0ubGVuZ3RoKSwgYyA9IDA7IGMgPCBzLmFsaWduLmxlbmd0aDsgYysrKSB7CiAgICAgICAgICAgICAgICAvXiAqLSs6ICokLy50ZXN0KHMuYWxpZ25bY10pID8gcy5hbGlnbltjXSA9ICJyaWdodCIgOiAvXiAqOi0rOiAqJC8udGVzdChzLmFsaWduW2NdKSA/IHMuYWxpZ25bY10gPSAiY2VudGVyIiA6IC9eICo6LSsgKiQvLnRlc3Qocy5hbGlnbltjXSkgPyBzLmFsaWduW2NdID0gImxlZnQiIDogcy5hbGlnbltjXSA9IG51bGw7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3IgKGMgPSAwOyBjIDwgcy5jZWxscy5sZW5ndGg7IGMrKykgewogICAgICAgICAgICAgICAgcy5jZWxsc1tjXSA9IGYocy5jZWxsc1tjXS5yZXBsYWNlKC9eICpcfCAqfCAqXHwgKiQvZywgIiIpLCBzLmhlYWRlci5sZW5ndGgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy50b2tlbnMucHVzaChzKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChvID0gdGhpcy5ydWxlcy5saGVhZGluZy5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB0eXBlOiAiaGVhZGluZyIsCiAgICAgICAgICAgICAgZGVwdGg6ICI9IiA9PT0gb1syXSA/IDEgOiAyLAogICAgICAgICAgICAgIHRleHQ6IG9bMV0KICAgICAgICAgICAgfSk7ZWxzZSBpZiAodCAmJiAobyA9IHRoaXMucnVsZXMucGFyYWdyYXBoLmV4ZWMoZSkpKSBlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB0eXBlOiAicGFyYWdyYXBoIiwKICAgICAgICAgICAgICB0ZXh0OiAiXG4iID09PSBvWzFdLmNoYXJBdChvWzFdLmxlbmd0aCAtIDEpID8gb1sxXS5zbGljZSgwLCAtMSkgOiBvWzFdCiAgICAgICAgICAgIH0pO2Vsc2UgaWYgKG8gPSB0aGlzLnJ1bGVzLnRleHQuZXhlYyhlKSkgZSA9IGUuc3Vic3RyaW5nKG9bMF0ubGVuZ3RoKSwgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAgICAgICAgIHRleHQ6IG9bMF0KICAgICAgICAgICAgfSk7ZWxzZSBpZiAoZSkgdGhyb3cgbmV3IEVycm9yKCJJbmZpbml0ZSBsb29wIG9uIGJ5dGU6ICIgKyBlLmNoYXJDb2RlQXQoMCkpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB0aGlzLnRva2VuczsKICAgICAgICB9OwogICAgICAgIHZhciBnID0gewogICAgICAgICAgZXNjYXBlOiAvXlxcKFshIiMkJSYnKCkqKyxcLS4vOjs8PT4/QFxbXF1cXF5fYHt8fX5dKS8sCiAgICAgICAgICBhdXRvbGluazogL148KHNjaGVtZTpbXlxzXHgwMC1ceDFmPD5dKnxlbWFpbCk+LywKICAgICAgICAgIHVybDogZCwKICAgICAgICAgIHRhZzogIl5jb21tZW50fF48L1thLXpBLVpdW1xcdzotXSpcXHMqPnxePFthLXpBLVpdW1xcdy1dKig/OmF0dHJpYnV0ZSkqP1xccyovPz58XjxcXD9bXFxzXFxTXSo/XFw/PnxePCFbYS16QS1aXStcXHNbXFxzXFxTXSo/PnxePCFcXFtDREFUQVxcW1tcXHNcXFNdKj9cXF1cXF0+IiwKICAgICAgICAgIGxpbms6IC9eIT9cWyhsYWJlbClcXVwoaHJlZig/OlxzKyh0aXRsZSkpP1xzKlwpLywKICAgICAgICAgIHJlZmxpbms6IC9eIT9cWyhsYWJlbClcXVxbKD8hXHMqXF0pKCg/OlxcW1xbXF1dP3xbXlxbXF1cXF0pKylcXS8sCiAgICAgICAgICBub2xpbms6IC9eIT9cWyg/IVxzKlxdKSgoPzpcW1teXFtcXV0qXF18XFxbXFtcXV18W15cW1xdXSkqKVxdKD86XFtcXSk/LywKICAgICAgICAgIHN0cm9uZzogL15fXyhbXlxzXVtcc1xTXSo/W15cc10pX18oPyFfKXxeXCpcKihbXlxzXVtcc1xTXSo/W15cc10pXCpcKig/IVwqKXxeX18oW15cc10pX18oPyFfKXxeXCpcKihbXlxzXSlcKlwqKD8hXCopLywKICAgICAgICAgIGVtOiAvXl8oW15cc11bXHNcU10qP1teXHNfXSlfKD8hXyl8Xl8oW15cc19dW1xzXFNdKj9bXlxzXSlfKD8hXyl8XlwqKFteXHNdW1xzXFNdKj9bXlxzKl0pXCooPyFcKil8XlwqKFteXHMqXVtcc1xTXSo/W15cc10pXCooPyFcKil8Xl8oW15cc19dKV8oPyFfKXxeXCooW15ccypdKVwqKD8hXCopLywKICAgICAgICAgIGNvZGU6IC9eKGArKVxzKihbXHNcU10qP1teYF0/KVxzKlwxKD8hYCkvLAogICAgICAgICAgYnI6IC9eIHsyLH1cbig/IVxzKiQpLywKICAgICAgICAgIGRlbDogZCwKICAgICAgICAgIHRleHQ6IC9eW1xzXFNdKz8oPz1bXFw8IVxbYCpdfFxiX3wgezIsfVxufCQpLwogICAgICAgIH07CiAgICAgICAgZy5fZXNjYXBlcyA9IC9cXChbISIjJCUmJygpKissXC0uLzo7PD0+P0BcW1xdXFxeX2B7fH1+XSkvZywgZy5fc2NoZW1lID0gL1thLXpBLVpdW2EtekEtWjAtOSsuLV17MSwzMX0vLCBnLl9lbWFpbCA9IC9bYS16QS1aMC05LiEjJCUmJyorLz0/Xl9ge3x9fi1dKyhAKVthLXpBLVowLTldKD86W2EtekEtWjAtOS1dezAsNjF9W2EtekEtWjAtOV0pPyg/OlwuW2EtekEtWjAtOV0oPzpbYS16QS1aMC05LV17MCw2MX1bYS16QS1aMC05XSk/KSsoPyFbLV9dKS8sIGcuYXV0b2xpbmsgPSBjKGcuYXV0b2xpbmspLnJlcGxhY2UoInNjaGVtZSIsIGcuX3NjaGVtZSkucmVwbGFjZSgiZW1haWwiLCBnLl9lbWFpbCkuZ2V0UmVnZXgoKSwgZy5fYXR0cmlidXRlID0gL1xzK1thLXpBLVo6X11bXHcuOi1dKig/OlxzKj1ccyoiW14iXSoifFxzKj1ccyonW14nXSonfFxzKj1ccypbXlxzIic9PD5gXSspPy8sIGcudGFnID0gYyhnLnRhZykucmVwbGFjZSgiY29tbWVudCIsIHYuX2NvbW1lbnQpLnJlcGxhY2UoImF0dHJpYnV0ZSIsIGcuX2F0dHJpYnV0ZSkuZ2V0UmVnZXgoKSwgZy5fbGFiZWwgPSAvKD86XFtbXlxbXF1dKlxdfFxcW1xbXF1dP3xgW15gXSpgfFteXFtcXVxcXSkqPy8sIGcuX2hyZWYgPSAvXHMqKDwoPzpcXFs8Pl0/fFteXHM8PlxcXSkqPnwoPzpcXFsoKV0/fFwoW15cc1x4MDAtXHgxZigpXFxdKlwpfFteXHNceDAwLVx4MWYoKVxcXSkqPykvLCBnLl90aXRsZSA9IC8iKD86XFwiP3xbXiJcXF0pKiJ8Jyg/OlxcJz98W14nXFxdKSonfFwoKD86XFxcKT98W14pXFxdKSpcKS8sIGcubGluayA9IGMoZy5saW5rKS5yZXBsYWNlKCJsYWJlbCIsIGcuX2xhYmVsKS5yZXBsYWNlKCJocmVmIiwgZy5faHJlZikucmVwbGFjZSgidGl0bGUiLCBnLl90aXRsZSkuZ2V0UmVnZXgoKSwgZy5yZWZsaW5rID0gYyhnLnJlZmxpbmspLnJlcGxhY2UoImxhYmVsIiwgZy5fbGFiZWwpLmdldFJlZ2V4KCksIGcubm9ybWFsID0gcCh7fSwgZyksIGcucGVkYW50aWMgPSBwKHt9LCBnLm5vcm1hbCwgewogICAgICAgICAgc3Ryb25nOiAvXl9fKD89XFMpKFtcc1xTXSo/XFMpX18oPyFfKXxeXCpcKig/PVxTKShbXHNcU10qP1xTKVwqXCooPyFcKikvLAogICAgICAgICAgZW06IC9eXyg/PVxTKShbXHNcU10qP1xTKV8oPyFfKXxeXCooPz1cUykoW1xzXFNdKj9cUylcKig/IVwqKS8sCiAgICAgICAgICBsaW5rOiBjKC9eIT9cWyhsYWJlbClcXVwoKC4qPylcKS8pLnJlcGxhY2UoImxhYmVsIiwgZy5fbGFiZWwpLmdldFJlZ2V4KCksCiAgICAgICAgICByZWZsaW5rOiBjKC9eIT9cWyhsYWJlbClcXVxzKlxbKFteXF1dKilcXS8pLnJlcGxhY2UoImxhYmVsIiwgZy5fbGFiZWwpLmdldFJlZ2V4KCkKICAgICAgICB9KSwgZy5nZm0gPSBwKHt9LCBnLm5vcm1hbCwgewogICAgICAgICAgZXNjYXBlOiBjKGcuZXNjYXBlKS5yZXBsYWNlKCJdKSIsICJ+fF0pIikuZ2V0UmVnZXgoKSwKICAgICAgICAgIHVybDogYygvXigoPzpmdHB8aHR0cHM/KTpcL1wvfHd3d1wuKSg/OlthLXpBLVowLTlcLV0rXC4/KStbXlxzPF0qfF5lbWFpbC8pLnJlcGxhY2UoImVtYWlsIiwgZy5fZW1haWwpLmdldFJlZ2V4KCksCiAgICAgICAgICBfYmFja3BlZGFsOiAvKD86W14/IS4sOjsqX34oKSZdK3xcKFteKV0qXCl8Jig/IVthLXpBLVowLTldKzskKXxbPyEuLDo7Kl9+KV0rKD8hJCkpKy8sCiAgICAgICAgICBkZWw6IC9efn4oPz1cUykoW1xzXFNdKj9cUyl+fi8sCiAgICAgICAgICB0ZXh0OiBjKGcudGV4dCkucmVwbGFjZSgiXXwiLCAifl18IikucmVwbGFjZSgifCIsICJ8aHR0cHM/Oi8vfGZ0cDovL3x3d3dcXC58W2EtekEtWjAtOS4hIyQlJicqKy89P15fYHtcXHx9fi1dK0B8IikuZ2V0UmVnZXgoKQogICAgICAgIH0pLCBnLmJyZWFrcyA9IHAoe30sIGcuZ2ZtLCB7CiAgICAgICAgICBicjogYyhnLmJyKS5yZXBsYWNlKCJ7Mix9IiwgIioiKS5nZXRSZWdleCgpLAogICAgICAgICAgdGV4dDogYyhnLmdmbS50ZXh0KS5yZXBsYWNlKCJ7Mix9IiwgIioiKS5nZXRSZWdleCgpCiAgICAgICAgfSksIHIucnVsZXMgPSBnLCByLm91dHB1dCA9IGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAgICAgICByZXR1cm4gbmV3IHIodCwgbikub3V0cHV0KGUpOwogICAgICAgIH0sIHIucHJvdG90eXBlLm91dHB1dCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBmb3IgKHZhciB0LCBuLCBvLCBpLCBhLCBsID0gIiI7IGU7KSB7CiAgICAgICAgICAgIGlmIChhID0gdGhpcy5ydWxlcy5lc2NhcGUuZXhlYyhlKSkgZSA9IGUuc3Vic3RyaW5nKGFbMF0ubGVuZ3RoKSwgbCArPSBhWzFdO2Vsc2UgaWYgKGEgPSB0aGlzLnJ1bGVzLmF1dG9saW5rLmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhhWzBdLmxlbmd0aCksICJAIiA9PT0gYVsyXSA/IChuID0gcyh0aGlzLm1hbmdsZShhWzFdKSksIG8gPSAibWFpbHRvOiIgKyBuKSA6IChuID0gcyhhWzFdKSwgbyA9IG4pLCBsICs9IHRoaXMucmVuZGVyZXIubGluayhvLCBudWxsLCBuKTtlbHNlIGlmICh0aGlzLmluTGluayB8fCAhKGEgPSB0aGlzLnJ1bGVzLnVybC5leGVjKGUpKSkgewogICAgICAgICAgICAgIGlmIChhID0gdGhpcy5ydWxlcy50YWcuZXhlYyhlKSkgIXRoaXMuaW5MaW5rICYmIC9ePGEgL2kudGVzdChhWzBdKSA/IHRoaXMuaW5MaW5rID0gITAgOiB0aGlzLmluTGluayAmJiAvXjxcL2E+L2kudGVzdChhWzBdKSAmJiAodGhpcy5pbkxpbmsgPSAhMSksIGUgPSBlLnN1YnN0cmluZyhhWzBdLmxlbmd0aCksIGwgKz0gdGhpcy5vcHRpb25zLnNhbml0aXplID8gdGhpcy5vcHRpb25zLnNhbml0aXplciA/IHRoaXMub3B0aW9ucy5zYW5pdGl6ZXIoYVswXSkgOiBzKGFbMF0pIDogYVswXTtlbHNlIGlmIChhID0gdGhpcy5ydWxlcy5saW5rLmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhhWzBdLmxlbmd0aCksIHRoaXMuaW5MaW5rID0gITAsIG8gPSBhWzJdLCB0aGlzLm9wdGlvbnMucGVkYW50aWMgPyAodCA9IC9eKFteJyJdKlteXHNdKVxzKyhbJyJdKSguKilcMi8uZXhlYyhvKSwgdCA/IChvID0gdFsxXSwgaSA9IHRbM10pIDogaSA9ICIiKSA6IGkgPSBhWzNdID8gYVszXS5zbGljZSgxLCAtMSkgOiAiIiwgbyA9IG8udHJpbSgpLnJlcGxhY2UoL148KFtcc1xTXSopPiQvLCAiJDEiKSwgbCArPSB0aGlzLm91dHB1dExpbmsoYSwgewogICAgICAgICAgICAgICAgaHJlZjogci5lc2NhcGVzKG8pLAogICAgICAgICAgICAgICAgdGl0bGU6IHIuZXNjYXBlcyhpKQogICAgICAgICAgICAgIH0pLCB0aGlzLmluTGluayA9ICExO2Vsc2UgaWYgKChhID0gdGhpcy5ydWxlcy5yZWZsaW5rLmV4ZWMoZSkpIHx8IChhID0gdGhpcy5ydWxlcy5ub2xpbmsuZXhlYyhlKSkpIHsKICAgICAgICAgICAgICAgIGlmIChlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCB0ID0gKGFbMl0gfHwgYVsxXSkucmVwbGFjZSgvXHMrL2csICIgIiksICEodCA9IHRoaXMubGlua3NbdC50b0xvd2VyQ2FzZSgpXSkgfHwgIXQuaHJlZikgewogICAgICAgICAgICAgICAgICBsICs9IGFbMF0uY2hhckF0KDApLCBlID0gYVswXS5zdWJzdHJpbmcoMSkgKyBlOwogICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLmluTGluayA9ICEwLCBsICs9IHRoaXMub3V0cHV0TGluayhhLCB0KSwgdGhpcy5pbkxpbmsgPSAhMTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEgPSB0aGlzLnJ1bGVzLnN0cm9uZy5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCBsICs9IHRoaXMucmVuZGVyZXIuc3Ryb25nKHRoaXMub3V0cHV0KGFbNF0gfHwgYVszXSB8fCBhWzJdIHx8IGFbMV0pKTtlbHNlIGlmIChhID0gdGhpcy5ydWxlcy5lbS5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCBsICs9IHRoaXMucmVuZGVyZXIuZW0odGhpcy5vdXRwdXQoYVs2XSB8fCBhWzVdIHx8IGFbNF0gfHwgYVszXSB8fCBhWzJdIHx8IGFbMV0pKTtlbHNlIGlmIChhID0gdGhpcy5ydWxlcy5jb2RlLmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhhWzBdLmxlbmd0aCksIGwgKz0gdGhpcy5yZW5kZXJlci5jb2Rlc3BhbihzKGFbMl0udHJpbSgpLCAhMCkpO2Vsc2UgaWYgKGEgPSB0aGlzLnJ1bGVzLmJyLmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhhWzBdLmxlbmd0aCksIGwgKz0gdGhpcy5yZW5kZXJlci5icigpO2Vsc2UgaWYgKGEgPSB0aGlzLnJ1bGVzLmRlbC5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCBsICs9IHRoaXMucmVuZGVyZXIuZGVsKHRoaXMub3V0cHV0KGFbMV0pKTtlbHNlIGlmIChhID0gdGhpcy5ydWxlcy50ZXh0LmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhhWzBdLmxlbmd0aCksIGwgKz0gdGhpcy5yZW5kZXJlci50ZXh0KHModGhpcy5zbWFydHlwYW50cyhhWzBdKSkpO2Vsc2UgaWYgKGUpIHRocm93IG5ldyBFcnJvcigiSW5maW5pdGUgbG9vcCBvbiBieXRlOiAiICsgZS5jaGFyQ29kZUF0KDApKTsKICAgICAgICAgICAgfSBlbHNlIGFbMF0gPSB0aGlzLnJ1bGVzLl9iYWNrcGVkYWwuZXhlYyhhWzBdKVswXSwgZSA9IGUuc3Vic3RyaW5nKGFbMF0ubGVuZ3RoKSwgIkAiID09PSBhWzJdID8gKG4gPSBzKGFbMF0pLCBvID0gIm1haWx0bzoiICsgbikgOiAobiA9IHMoYVswXSksIG8gPSAid3d3LiIgPT09IGFbMV0gPyAiaHR0cDovLyIgKyBuIDogbiksIGwgKz0gdGhpcy5yZW5kZXJlci5saW5rKG8sIG51bGwsIG4pOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBsOwogICAgICAgIH0sIHIuZXNjYXBlcyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZSA/IGUucmVwbGFjZShyLnJ1bGVzLl9lc2NhcGVzLCAiJDEiKSA6IGU7CiAgICAgICAgfSwgci5wcm90b3R5cGUub3V0cHV0TGluayA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgICB2YXIgbiA9IHQuaHJlZiwKICAgICAgICAgICAgICByID0gdC50aXRsZSA/IHModC50aXRsZSkgOiBudWxsOwogICAgICAgICAgcmV0dXJuICIhIiAhPT0gZVswXS5jaGFyQXQoMCkgPyB0aGlzLnJlbmRlcmVyLmxpbmsobiwgciwgdGhpcy5vdXRwdXQoZVsxXSkpIDogdGhpcy5yZW5kZXJlci5pbWFnZShuLCByLCBzKGVbMV0pKTsKICAgICAgICB9LCByLnByb3RvdHlwZS5zbWFydHlwYW50cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLnNtYXJ0eXBhbnRzID8gZS5yZXBsYWNlKC8tLS0vZywgIuKAlCIpLnJlcGxhY2UoLy0tL2csICLigJMiKS5yZXBsYWNlKC8oXnxbLVx1MjAxNC8oXFt7IlxzXSknL2csICIkMeKAmCIpLnJlcGxhY2UoLycvZywgIuKAmSIpLnJlcGxhY2UoLyhefFstXHUyMDE0LyhcW3tcdTIwMThcc10pIi9nLCAiJDHigJwiKS5yZXBsYWNlKC8iL2csICLigJ0iKS5yZXBsYWNlKC9cLnszfS9nLCAi4oCmIikgOiBlOwogICAgICAgIH0sIHIucHJvdG90eXBlLm1hbmdsZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5tYW5nbGUpIHJldHVybiBlOwoKICAgICAgICAgIGZvciAodmFyIHQsIG4gPSAiIiwgciA9IGUubGVuZ3RoLCBvID0gMDsgbyA8IHI7IG8rKykgewogICAgICAgICAgICB0ID0gZS5jaGFyQ29kZUF0KG8pLCBNYXRoLnJhbmRvbSgpID4gLjUgJiYgKHQgPSAieCIgKyB0LnRvU3RyaW5nKDE2KSksIG4gKz0gIiYjIiArIHQgKyAiOyI7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIG47CiAgICAgICAgfSwgby5wcm90b3R5cGUuY29kZSA9IGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhpZ2hsaWdodCkgewogICAgICAgICAgICB2YXIgciA9IHRoaXMub3B0aW9ucy5oaWdobGlnaHQoZSwgdCk7CiAgICAgICAgICAgIG51bGwgIT0gciAmJiByICE9PSBlICYmIChuID0gITAsIGUgPSByKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdCA/ICc8cHJlPjxjb2RlIGNsYXNzPSInICsgdGhpcy5vcHRpb25zLmxhbmdQcmVmaXggKyBzKHQsICEwKSArICciPicgKyAobiA/IGUgOiBzKGUsICEwKSkgKyAiPC9jb2RlPjwvcHJlPlxuIiA6ICI8cHJlPjxjb2RlPiIgKyAobiA/IGUgOiBzKGUsICEwKSkgKyAiPC9jb2RlPjwvcHJlPiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUuYmxvY2txdW90ZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gIjxibG9ja3F1b3RlPlxuIiArIGUgKyAiPC9ibG9ja3F1b3RlPlxuIjsKICAgICAgICB9LCBvLnByb3RvdHlwZS5odG1sID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBlOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmhlYWRpbmcgPSBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5oZWFkZXJJZHMgPyAiPGgiICsgdCArICcgaWQ9IicgKyB0aGlzLm9wdGlvbnMuaGVhZGVyUHJlZml4ICsgbi50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teXHddKy9nLCAiLSIpICsgJyI+JyArIGUgKyAiPC9oIiArIHQgKyAiPlxuIiA6ICI8aCIgKyB0ICsgIj4iICsgZSArICI8L2giICsgdCArICI+XG4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmhyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy54aHRtbCA/ICI8aHIvPlxuIiA6ICI8aHI+XG4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmxpc3QgPSBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgICAgICAgdmFyIHIgPSB0ID8gIm9sIiA6ICJ1bCI7CiAgICAgICAgICByZXR1cm4gIjwiICsgciArICh0ICYmIDEgIT09IG4gPyAnIHN0YXJ0PSInICsgbiArICciJyA6ICIiKSArICI+XG4iICsgZSArICI8LyIgKyByICsgIj5cbiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUubGlzdGl0ZW0gPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuICI8bGk+IiArIGUgKyAiPC9saT5cbiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUuY2hlY2tib3ggPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuICI8aW5wdXQgIiArIChlID8gJ2NoZWNrZWQ9IiIgJyA6ICIiKSArICdkaXNhYmxlZD0iIiB0eXBlPSJjaGVja2JveCInICsgKHRoaXMub3B0aW9ucy54aHRtbCA/ICIgLyIgOiAiIikgKyAiPiAiOwogICAgICAgIH0sIG8ucHJvdG90eXBlLnBhcmFncmFwaCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gIjxwPiIgKyBlICsgIjwvcD5cbiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUudGFibGUgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgcmV0dXJuIHQgJiYgKHQgPSAiPHRib2R5PiIgKyB0ICsgIjwvdGJvZHk+IiksICI8dGFibGU+XG48dGhlYWQ+XG4iICsgZSArICI8L3RoZWFkPlxuIiArIHQgKyAiPC90YWJsZT5cbiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUudGFibGVyb3cgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuICI8dHI+XG4iICsgZSArICI8L3RyPlxuIjsKICAgICAgICB9LCBvLnByb3RvdHlwZS50YWJsZWNlbGwgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgdmFyIG4gPSB0LmhlYWRlciA/ICJ0aCIgOiAidGQiOwogICAgICAgICAgcmV0dXJuICh0LmFsaWduID8gIjwiICsgbiArICcgYWxpZ249IicgKyB0LmFsaWduICsgJyI+JyA6ICI8IiArIG4gKyAiPiIpICsgZSArICI8LyIgKyBuICsgIj5cbiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUuc3Ryb25nID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiAiPHN0cm9uZz4iICsgZSArICI8L3N0cm9uZz4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmVtID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiAiPGVtPiIgKyBlICsgIjwvZW0+IjsKICAgICAgICB9LCBvLnByb3RvdHlwZS5jb2Rlc3BhbiA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gIjxjb2RlPiIgKyBlICsgIjwvY29kZT4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmJyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy54aHRtbCA/ICI8YnIvPiIgOiAiPGJyPiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUuZGVsID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiAiPGRlbD4iICsgZSArICI8L2RlbD4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmxpbmsgPSBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zYW5pdGl6ZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHZhciByID0gZGVjb2RlVVJJQ29tcG9uZW50KGwoZSkpLnJlcGxhY2UoL1teXHc6XS9nLCAiIikudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIHJldHVybiBuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoMCA9PT0gci5pbmRleE9mKCJqYXZhc2NyaXB0OiIpIHx8IDAgPT09IHIuaW5kZXhPZigidmJzY3JpcHQ6IikgfHwgMCA9PT0gci5pbmRleE9mKCJkYXRhOiIpKSByZXR1cm4gbjsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLm9wdGlvbnMuYmFzZVVybCAmJiAheS50ZXN0KGUpICYmIChlID0gdSh0aGlzLm9wdGlvbnMuYmFzZVVybCwgZSkpOwoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGUgPSBlbmNvZGVVUkkoZSkucmVwbGFjZSgvJTI1L2csICIlIik7CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIHJldHVybiBuOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBvID0gJzxhIGhyZWY9IicgKyBzKGUpICsgJyInOwogICAgICAgICAgcmV0dXJuIHQgJiYgKG8gKz0gJyB0aXRsZT0iJyArIHQgKyAnIicpLCBvICs9ICI+IiArIG4gKyAiPC9hPiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUuaW1hZ2UgPSBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgICAgICAgdGhpcy5vcHRpb25zLmJhc2VVcmwgJiYgIXkudGVzdChlKSAmJiAoZSA9IHUodGhpcy5vcHRpb25zLmJhc2VVcmwsIGUpKTsKICAgICAgICAgIHZhciByID0gJzxpbWcgc3JjPSInICsgZSArICciIGFsdD0iJyArIG4gKyAnIic7CiAgICAgICAgICByZXR1cm4gdCAmJiAociArPSAnIHRpdGxlPSInICsgdCArICciJyksIHIgKz0gdGhpcy5vcHRpb25zLnhodG1sID8gIi8+IiA6ICI+IjsKICAgICAgICB9LCBvLnByb3RvdHlwZS50ZXh0ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBlOwogICAgICAgIH0sIGkucHJvdG90eXBlLnN0cm9uZyA9IGkucHJvdG90eXBlLmVtID0gaS5wcm90b3R5cGUuY29kZXNwYW4gPSBpLnByb3RvdHlwZS5kZWwgPSBpLnByb3RvdHlwZS50ZXh0ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBlOwogICAgICAgIH0sIGkucHJvdG90eXBlLmxpbmsgPSBpLnByb3RvdHlwZS5pbWFnZSA9IGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAgICAgICByZXR1cm4gIiIgKyBuOwogICAgICAgIH0sIGkucHJvdG90eXBlLmJyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIH0sIGEucGFyc2UgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgcmV0dXJuIG5ldyBhKHQpLnBhcnNlKGUpOwogICAgICAgIH0sIGEucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHRoaXMuaW5saW5lID0gbmV3IHIoZS5saW5rcywgdGhpcy5vcHRpb25zKSwgdGhpcy5pbmxpbmVUZXh0ID0gbmV3IHIoZS5saW5rcywgcCh7fSwgdGhpcy5vcHRpb25zLCB7CiAgICAgICAgICAgIHJlbmRlcmVyOiBuZXcgaSgpCiAgICAgICAgICB9KSksIHRoaXMudG9rZW5zID0gZS5yZXZlcnNlKCk7CgogICAgICAgICAgZm9yICh2YXIgdCA9ICIiOyB0aGlzLm5leHQoKTspIHsKICAgICAgICAgICAgdCArPSB0aGlzLnRvaygpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB0OwogICAgICAgIH0sIGEucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50b2tlbiA9IHRoaXMudG9rZW5zLnBvcCgpOwogICAgICAgIH0sIGEucHJvdG90eXBlLnBlZWsgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50b2tlbnNbdGhpcy50b2tlbnMubGVuZ3RoIC0gMV0gfHwgMDsKICAgICAgICB9LCBhLnByb3RvdHlwZS5wYXJzZVRleHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBmb3IgKHZhciBlID0gdGhpcy50b2tlbi50ZXh0OyAidGV4dCIgPT09IHRoaXMucGVlaygpLnR5cGU7KSB7CiAgICAgICAgICAgIGUgKz0gIlxuIiArIHRoaXMubmV4dCgpLnRleHQ7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHRoaXMuaW5saW5lLm91dHB1dChlKTsKICAgICAgICB9LCBhLnByb3RvdHlwZS50b2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBzd2l0Y2ggKHRoaXMudG9rZW4udHlwZSkgewogICAgICAgICAgICBjYXNlICJzcGFjZSI6CiAgICAgICAgICAgICAgcmV0dXJuICIiOwoKICAgICAgICAgICAgY2FzZSAiaHIiOgogICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlcmVyLmhyKCk7CgogICAgICAgICAgICBjYXNlICJoZWFkaW5nIjoKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci5oZWFkaW5nKHRoaXMuaW5saW5lLm91dHB1dCh0aGlzLnRva2VuLnRleHQpLCB0aGlzLnRva2VuLmRlcHRoLCBsKHRoaXMuaW5saW5lVGV4dC5vdXRwdXQodGhpcy50b2tlbi50ZXh0KSkpOwoKICAgICAgICAgICAgY2FzZSAiY29kZSI6CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyZXIuY29kZSh0aGlzLnRva2VuLnRleHQsIHRoaXMudG9rZW4ubGFuZywgdGhpcy50b2tlbi5lc2NhcGVkKTsKCiAgICAgICAgICAgIGNhc2UgInRhYmxlIjoKICAgICAgICAgICAgICB2YXIgZSwKICAgICAgICAgICAgICAgICAgdCwKICAgICAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICAgICAgciwKICAgICAgICAgICAgICAgICAgbyA9ICIiLAogICAgICAgICAgICAgICAgICBpID0gIiI7CgogICAgICAgICAgICAgIGZvciAobiA9ICIiLCBlID0gMDsgZSA8IHRoaXMudG9rZW4uaGVhZGVyLmxlbmd0aDsgZSsrKSB7CiAgICAgICAgICAgICAgICBuICs9IHRoaXMucmVuZGVyZXIudGFibGVjZWxsKHRoaXMuaW5saW5lLm91dHB1dCh0aGlzLnRva2VuLmhlYWRlcltlXSksIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyOiAhMCwKICAgICAgICAgICAgICAgICAgYWxpZ246IHRoaXMudG9rZW4uYWxpZ25bZV0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZm9yIChvICs9IHRoaXMucmVuZGVyZXIudGFibGVyb3cobiksIGUgPSAwOyBlIDwgdGhpcy50b2tlbi5jZWxscy5sZW5ndGg7IGUrKykgewogICAgICAgICAgICAgICAgZm9yICh0ID0gdGhpcy50b2tlbi5jZWxsc1tlXSwgbiA9ICIiLCByID0gMDsgciA8IHQubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgICAgICAgbiArPSB0aGlzLnJlbmRlcmVyLnRhYmxlY2VsbCh0aGlzLmlubGluZS5vdXRwdXQodFtyXSksIHsKICAgICAgICAgICAgICAgICAgICBoZWFkZXI6ICExLAogICAgICAgICAgICAgICAgICAgIGFsaWduOiB0aGlzLnRva2VuLmFsaWduW3JdCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGkgKz0gdGhpcy5yZW5kZXJlci50YWJsZXJvdyhuKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlcmVyLnRhYmxlKG8sIGkpOwoKICAgICAgICAgICAgY2FzZSAiYmxvY2txdW90ZV9zdGFydCI6CiAgICAgICAgICAgICAgZm9yIChpID0gIiI7ICJibG9ja3F1b3RlX2VuZCIgIT09IHRoaXMubmV4dCgpLnR5cGU7KSB7CiAgICAgICAgICAgICAgICBpICs9IHRoaXMudG9rKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci5ibG9ja3F1b3RlKGkpOwoKICAgICAgICAgICAgY2FzZSAibGlzdF9zdGFydCI6CiAgICAgICAgICAgICAgaSA9ICIiOwoKICAgICAgICAgICAgICBmb3IgKHZhciBhID0gdGhpcy50b2tlbi5vcmRlcmVkLCBzID0gdGhpcy50b2tlbi5zdGFydDsgImxpc3RfZW5kIiAhPT0gdGhpcy5uZXh0KCkudHlwZTspIHsKICAgICAgICAgICAgICAgIGkgKz0gdGhpcy50b2soKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlcmVyLmxpc3QoaSwgYSwgcyk7CgogICAgICAgICAgICBjYXNlICJsaXN0X2l0ZW1fc3RhcnQiOgogICAgICAgICAgICAgIGZvciAoaSA9ICIiLCB0aGlzLnRva2VuLnRhc2sgJiYgKGkgKz0gdGhpcy5yZW5kZXJlci5jaGVja2JveCh0aGlzLnRva2VuLmNoZWNrZWQpKTsgImxpc3RfaXRlbV9lbmQiICE9PSB0aGlzLm5leHQoKS50eXBlOykgewogICAgICAgICAgICAgICAgaSArPSAidGV4dCIgPT09IHRoaXMudG9rZW4udHlwZSA/IHRoaXMucGFyc2VUZXh0KCkgOiB0aGlzLnRvaygpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyZXIubGlzdGl0ZW0oaSk7CgogICAgICAgICAgICBjYXNlICJsb29zZV9pdGVtX3N0YXJ0IjoKICAgICAgICAgICAgICBmb3IgKGkgPSAiIjsgImxpc3RfaXRlbV9lbmQiICE9PSB0aGlzLm5leHQoKS50eXBlOykgewogICAgICAgICAgICAgICAgaSArPSB0aGlzLnRvaygpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyZXIubGlzdGl0ZW0oaSk7CgogICAgICAgICAgICBjYXNlICJodG1sIjoKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci5odG1sKHRoaXMudG9rZW4udGV4dCk7CgogICAgICAgICAgICBjYXNlICJwYXJhZ3JhcGgiOgogICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlcmVyLnBhcmFncmFwaCh0aGlzLmlubGluZS5vdXRwdXQodGhpcy50b2tlbi50ZXh0KSk7CgogICAgICAgICAgICBjYXNlICJ0ZXh0IjoKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci5wYXJhZ3JhcGgodGhpcy5wYXJzZVRleHQoKSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICB2YXIgbSA9IHt9LAogICAgICAgICAgICB5ID0gL14kfF5bYS16XVthLXowLTkrLi1dKjp8Xls/I10vaTsKICAgICAgICBkLmV4ZWMgPSBkLCBoLm9wdGlvbnMgPSBoLnNldE9wdGlvbnMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIHAoaC5kZWZhdWx0cywgZSksIGg7CiAgICAgICAgfSwgaC5nZXREZWZhdWx0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGJhc2VVcmw6IG51bGwsCiAgICAgICAgICAgIGJyZWFrczogITEsCiAgICAgICAgICAgIGdmbTogITAsCiAgICAgICAgICAgIGhlYWRlcklkczogITAsCiAgICAgICAgICAgIGhlYWRlclByZWZpeDogIiIsCiAgICAgICAgICAgIGhpZ2hsaWdodDogbnVsbCwKICAgICAgICAgICAgbGFuZ1ByZWZpeDogImxhbmd1YWdlLSIsCiAgICAgICAgICAgIG1hbmdsZTogITAsCiAgICAgICAgICAgIHBlZGFudGljOiAhMSwKICAgICAgICAgICAgcmVuZGVyZXI6IG5ldyBvKCksCiAgICAgICAgICAgIHNhbml0aXplOiAhMSwKICAgICAgICAgICAgc2FuaXRpemVyOiBudWxsLAogICAgICAgICAgICBzaWxlbnQ6ICExLAogICAgICAgICAgICBzbWFydExpc3RzOiAhMSwKICAgICAgICAgICAgc21hcnR5cGFudHM6ICExLAogICAgICAgICAgICB0YWJsZXM6ICEwLAogICAgICAgICAgICB4aHRtbDogITEKICAgICAgICAgIH07CiAgICAgICAgfSwgaC5kZWZhdWx0cyA9IGguZ2V0RGVmYXVsdHMoKSwgaC5QYXJzZXIgPSBhLCBoLnBhcnNlciA9IGEucGFyc2UsIGguUmVuZGVyZXIgPSBvLCBoLlRleHRSZW5kZXJlciA9IGksIGguTGV4ZXIgPSBuLCBoLmxleGVyID0gbi5sZXgsIGguSW5saW5lTGV4ZXIgPSByLCBoLmlubGluZUxleGVyID0gci5vdXRwdXQsIGgucGFyc2UgPSBoLCBlLmV4cG9ydHMgPSBoOwogICAgICB9KHRoaXMgfHwgInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cpOwogICAgfSkuY2FsbCh0LCBuKDE0KSk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICBmdW5jdGlvbiByKGUpIHsKICAgICAgdmFyIHQgPSB7fTsKICAgICAgcmV0dXJuIHUoZSwgZnVuY3Rpb24gKGUsIG4pIHsKICAgICAgICB1KGUsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB0W2VdID0gbjsKICAgICAgICB9KTsKICAgICAgfSksIHQ7CiAgICB9CgogICAgZnVuY3Rpb24gbyhlLCB0KSB7CiAgICAgIHZhciBuID0gcihlLnBsdXJhbFR5cGVUb0xhbmd1YWdlcyk7CiAgICAgIHJldHVybiBuW3RdIHx8IG5bZy5jYWxsKHQsIC8tLywgMSlbMF1dIHx8IG4uZW47CiAgICB9CgogICAgZnVuY3Rpb24gaShlLCB0LCBuKSB7CiAgICAgIHJldHVybiBlLnBsdXJhbFR5cGVzW28oZSwgdCldKG4pOwogICAgfQoKICAgIGZ1bmN0aW9uIGEoZSkgewogICAgICByZXR1cm4gZS5yZXBsYWNlKC9bLiorP14ke30oKXxbXF1cXF0vZywgIlxcJCYiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzKGUpIHsKICAgICAgdmFyIHQgPSBlICYmIGUucHJlZml4IHx8ICIleyIsCiAgICAgICAgICBuID0gZSAmJiBlLnN1ZmZpeCB8fCAifSI7CiAgICAgIGlmICh0ID09PSBtIHx8IG4gPT09IG0pIHRocm93IG5ldyBSYW5nZUVycm9yKCciJyArIG0gKyAnIiB0b2tlbiBpcyByZXNlcnZlZCBmb3IgcGx1cmFsaXphdGlvbicpOwogICAgICByZXR1cm4gbmV3IFJlZ0V4cChhKHQpICsgIiguKj8pIiArIGEobiksICJnIik7CiAgICB9CgogICAgZnVuY3Rpb24gbChlLCB0LCBuLCByLCBvKSB7CiAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgZSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiUG9seWdsb3QudHJhbnNmb3JtUGhyYXNlIGV4cGVjdHMgYXJndW1lbnQgIzEgdG8gYmUgc3RyaW5nIik7CiAgICAgIGlmIChudWxsID09IHQpIHJldHVybiBlOwogICAgICB2YXIgYSA9IGUsCiAgICAgICAgICBzID0gciB8fCB3LAogICAgICAgICAgbCA9IG8gfHwgYiwKICAgICAgICAgIGMgPSAibnVtYmVyIiA9PSB0eXBlb2YgdCA/IHsKICAgICAgICBzbWFydF9jb3VudDogdAogICAgICB9IDogdDsKCiAgICAgIGlmIChudWxsICE9IGMuc21hcnRfY291bnQgJiYgYSkgewogICAgICAgIHZhciB1ID0gZy5jYWxsKGEsIG0pOwogICAgICAgIGEgPSBmKHVbaShsLCBuIHx8ICJlbiIsIGMuc21hcnRfY291bnQpXSB8fCB1WzBdKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGEgPSB2LmNhbGwoYSwgcywgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICByZXR1cm4gcChjLCB0KSAmJiBudWxsICE9IGNbdF0gPyBjW3RdIDogZTsKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gYyhlKSB7CiAgICAgIHZhciB0ID0gZSB8fCB7fTsKICAgICAgdGhpcy5waHJhc2VzID0ge30sIHRoaXMuZXh0ZW5kKHQucGhyYXNlcyB8fCB7fSksIHRoaXMuY3VycmVudExvY2FsZSA9IHQubG9jYWxlIHx8ICJlbiI7CiAgICAgIHZhciBuID0gdC5hbGxvd01pc3NpbmcgPyBsIDogbnVsbDsKICAgICAgdGhpcy5vbk1pc3NpbmdLZXkgPSAiZnVuY3Rpb24iID09IHR5cGVvZiB0Lm9uTWlzc2luZ0tleSA/IHQub25NaXNzaW5nS2V5IDogbiwgdGhpcy53YXJuID0gdC53YXJuIHx8IGgsIHRoaXMudG9rZW5SZWdleCA9IHModC5pbnRlcnBvbGF0aW9uKSwgdGhpcy5wbHVyYWxSdWxlcyA9IHQucGx1cmFsUnVsZXMgfHwgYjsKICAgIH0KCiAgICB2YXIgdSA9IG4oMzEpLAogICAgICAgIGQgPSBuKDUwKSwKICAgICAgICBwID0gbigzNCksCiAgICAgICAgZiA9IG4oNDMpLAogICAgICAgIGggPSBmdW5jdGlvbiBoKGUpIHsKICAgICAgZCghMSwgZSk7CiAgICB9LAogICAgICAgIHYgPSBTdHJpbmcucHJvdG90eXBlLnJlcGxhY2UsCiAgICAgICAgZyA9IFN0cmluZy5wcm90b3R5cGUuc3BsaXQsCiAgICAgICAgbSA9ICJ8fHx8IiwKICAgICAgICB5ID0gZnVuY3Rpb24geShlKSB7CiAgICAgIHZhciB0ID0gZSAlIDEwMCwKICAgICAgICAgIG4gPSB0ICUgMTA7CiAgICAgIHJldHVybiAxMSAhPT0gdCAmJiAxID09PSBuID8gMCA6IDIgPD0gbiAmJiBuIDw9IDQgJiYgISh0ID49IDEyICYmIHQgPD0gMTQpID8gMSA6IDI7CiAgICB9LAogICAgICAgIGIgPSB7CiAgICAgIHBsdXJhbFR5cGVzOiB7CiAgICAgICAgYXJhYmljOiBmdW5jdGlvbiBhcmFiaWMoZSkgewogICAgICAgICAgaWYgKGUgPCAzKSByZXR1cm4gZTsKICAgICAgICAgIHZhciB0ID0gZSAlIDEwMDsKICAgICAgICAgIHJldHVybiB0ID49IDMgJiYgdCA8PSAxMCA/IDMgOiB0ID49IDExID8gNCA6IDU7CiAgICAgICAgfSwKICAgICAgICBib3NuaWFuX3NlcmJpYW46IHksCiAgICAgICAgY2hpbmVzZTogZnVuY3Rpb24gY2hpbmVzZSgpIHsKICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0sCiAgICAgICAgY3JvYXRpYW46IHksCiAgICAgICAgZnJlbmNoOiBmdW5jdGlvbiBmcmVuY2goZSkgewogICAgICAgICAgcmV0dXJuIGUgPiAxID8gMSA6IDA7CiAgICAgICAgfSwKICAgICAgICBnZXJtYW46IGZ1bmN0aW9uIGdlcm1hbihlKSB7CiAgICAgICAgICByZXR1cm4gMSAhPT0gZSA/IDEgOiAwOwogICAgICAgIH0sCiAgICAgICAgcnVzc2lhbjogeSwKICAgICAgICBsaXRodWFuaWFuOiBmdW5jdGlvbiBsaXRodWFuaWFuKGUpIHsKICAgICAgICAgIHJldHVybiBlICUgMTAgPT0gMSAmJiBlICUgMTAwICE9IDExID8gMCA6IGUgJSAxMCA+PSAyICYmIGUgJSAxMCA8PSA5ICYmIChlICUgMTAwIDwgMTEgfHwgZSAlIDEwMCA+IDE5KSA/IDEgOiAyOwogICAgICAgIH0sCiAgICAgICAgY3plY2g6IGZ1bmN0aW9uIGN6ZWNoKGUpIHsKICAgICAgICAgIHJldHVybiAxID09PSBlID8gMCA6IGUgPj0gMiAmJiBlIDw9IDQgPyAxIDogMjsKICAgICAgICB9LAogICAgICAgIHBvbGlzaDogZnVuY3Rpb24gcG9saXNoKGUpIHsKICAgICAgICAgIGlmICgxID09PSBlKSByZXR1cm4gMDsKICAgICAgICAgIHZhciB0ID0gZSAlIDEwOwogICAgICAgICAgcmV0dXJuIDIgPD0gdCAmJiB0IDw9IDQgJiYgKGUgJSAxMDAgPCAxMCB8fCBlICUgMTAwID49IDIwKSA/IDEgOiAyOwogICAgICAgIH0sCiAgICAgICAgaWNlbGFuZGljOiBmdW5jdGlvbiBpY2VsYW5kaWMoZSkgewogICAgICAgICAgcmV0dXJuIGUgJSAxMCAhPSAxIHx8IGUgJSAxMDAgPT0gMTEgPyAxIDogMDsKICAgICAgICB9LAogICAgICAgIHNsb3ZlbmlhbjogZnVuY3Rpb24gc2xvdmVuaWFuKGUpIHsKICAgICAgICAgIHZhciB0ID0gZSAlIDEwMDsKICAgICAgICAgIHJldHVybiAxID09PSB0ID8gMCA6IDIgPT09IHQgPyAxIDogMyA9PT0gdCB8fCA0ID09PSB0ID8gMiA6IDM7CiAgICAgICAgfQogICAgICB9LAogICAgICBwbHVyYWxUeXBlVG9MYW5ndWFnZXM6IHsKICAgICAgICBhcmFiaWM6IFsiYXIiXSwKICAgICAgICBib3NuaWFuX3NlcmJpYW46IFsiYnMtTGF0bi1CQSIsICJicy1DeXJsLUJBIiwgInNybC1SUyIsICJzci1SUyJdLAogICAgICAgIGNoaW5lc2U6IFsiaWQiLCAiaWQtSUQiLCAiamEiLCAia28iLCAia28tS1IiLCAibG8iLCAibXMiLCAidGgiLCAidGgtVEgiLCAiemgiXSwKICAgICAgICBjcm9hdGlhbjogWyJociIsICJoci1IUiJdLAogICAgICAgIGdlcm1hbjogWyJmYSIsICJkYSIsICJkZSIsICJlbiIsICJlcyIsICJmaSIsICJlbCIsICJoZSIsICJoaS1JTiIsICJodSIsICJodS1IVSIsICJpdCIsICJubCIsICJubyIsICJwdCIsICJzdiIsICJ0ciJdLAogICAgICAgIGZyZW5jaDogWyJmciIsICJ0bCIsICJwdC1iciJdLAogICAgICAgIHJ1c3NpYW46IFsicnUiLCAicnUtUlUiXSwKICAgICAgICBsaXRodWFuaWFuOiBbImx0Il0sCiAgICAgICAgY3plY2g6IFsiY3MiLCAiY3MtQ1oiLCAic2siXSwKICAgICAgICBwb2xpc2g6IFsicGwiXSwKICAgICAgICBpY2VsYW5kaWM6IFsiaXMiXSwKICAgICAgICBzbG92ZW5pYW46IFsic2wtU0wiXQogICAgICB9CiAgICB9LAogICAgICAgIHcgPSAvJVx7KC4qPylcfS9nOwoKICAgIGMucHJvdG90eXBlLmxvY2FsZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBlICYmICh0aGlzLmN1cnJlbnRMb2NhbGUgPSBlKSwgdGhpcy5jdXJyZW50TG9jYWxlOwogICAgfSwgYy5wcm90b3R5cGUuZXh0ZW5kID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgdShlLCBmdW5jdGlvbiAoZSwgbikgewogICAgICAgIHZhciByID0gdCA/IHQgKyAiLiIgKyBuIDogbjsKICAgICAgICAib2JqZWN0IiA9PSBfdHlwZW9mKGUpID8gdGhpcy5leHRlbmQoZSwgcikgOiB0aGlzLnBocmFzZXNbcl0gPSBlOwogICAgICB9LCB0aGlzKTsKICAgIH0sIGMucHJvdG90eXBlLnVuc2V0ID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgInN0cmluZyIgPT0gdHlwZW9mIGUgPyBkZWxldGUgdGhpcy5waHJhc2VzW2VdIDogdShlLCBmdW5jdGlvbiAoZSwgbikgewogICAgICAgIHZhciByID0gdCA/IHQgKyAiLiIgKyBuIDogbjsKICAgICAgICAib2JqZWN0IiA9PSBfdHlwZW9mKGUpID8gdGhpcy51bnNldChlLCByKSA6IGRlbGV0ZSB0aGlzLnBocmFzZXNbcl07CiAgICAgIH0sIHRoaXMpOwogICAgfSwgYy5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMucGhyYXNlcyA9IHt9OwogICAgfSwgYy5wcm90b3R5cGUucmVwbGFjZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHRoaXMuY2xlYXIoKSwgdGhpcy5leHRlbmQoZSk7CiAgICB9LCBjLnByb3RvdHlwZS50ID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgdmFyIG4sCiAgICAgICAgICByLAogICAgICAgICAgbyA9IG51bGwgPT0gdCA/IHt9IDogdDsKICAgICAgaWYgKCJzdHJpbmciID09IHR5cGVvZiB0aGlzLnBocmFzZXNbZV0pIG4gPSB0aGlzLnBocmFzZXNbZV07ZWxzZSBpZiAoInN0cmluZyIgPT0gdHlwZW9mIG8uXykgbiA9IG8uXztlbHNlIGlmICh0aGlzLm9uTWlzc2luZ0tleSkgewogICAgICAgIHZhciBpID0gdGhpcy5vbk1pc3NpbmdLZXk7CiAgICAgICAgciA9IGkoZSwgbywgdGhpcy5jdXJyZW50TG9jYWxlLCB0aGlzLnRva2VuUmVnZXgsIHRoaXMucGx1cmFsUnVsZXMpOwogICAgICB9IGVsc2UgdGhpcy53YXJuKCdNaXNzaW5nIHRyYW5zbGF0aW9uIGZvciBrZXk6ICInICsgZSArICciJyksIHIgPSBlOwogICAgICByZXR1cm4gInN0cmluZyIgPT0gdHlwZW9mIG4gJiYgKHIgPSBsKG4sIG8sIHRoaXMuY3VycmVudExvY2FsZSwgdGhpcy50b2tlblJlZ2V4LCB0aGlzLnBsdXJhbFJ1bGVzKSksIHI7CiAgICB9LCBjLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gcCh0aGlzLnBocmFzZXMsIGUpOwogICAgfSwgYy50cmFuc2Zvcm1QaHJhc2UgPSBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgICByZXR1cm4gbChlLCB0LCBuKTsKICAgIH0sIGUuZXhwb3J0cyA9IGM7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICBmdW5jdGlvbiByKGUpIHsKICAgICAgaWYgKG51bGwgPT09IGUgfHwgdm9pZCAwID09PSBlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJPYmplY3QuYXNzaWduIGNhbm5vdCBiZSBjYWxsZWQgd2l0aCBudWxsIG9yIHVuZGVmaW5lZCIpOwogICAgICByZXR1cm4gT2JqZWN0KGUpOwogICAgfQogICAgLyoKICAgIG9iamVjdC1hc3NpZ24KICAgIChjKSBTaW5kcmUgU29yaHVzCiAgICBAbGljZW5zZSBNSVQKICAgICovCgoKICAgIHZhciBvID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scywKICAgICAgICBpID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSwKICAgICAgICBhID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAoIU9iamVjdC5hc3NpZ24pIHJldHVybiAhMTsKICAgICAgICB2YXIgZSA9IG5ldyBTdHJpbmcoImFiYyIpOwogICAgICAgIGlmIChlWzVdID0gImRlIiwgIjUiID09PSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhlKVswXSkgcmV0dXJuICExOwoKICAgICAgICBmb3IgKHZhciB0ID0ge30sIG4gPSAwOyBuIDwgMTA7IG4rKykgewogICAgICAgICAgdFsiXyIgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKG4pXSA9IG47CiAgICAgICAgfQoKICAgICAgICBpZiAoIjAxMjM0NTY3ODkiICE9PSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0KS5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiB0W2VdOwogICAgICAgIH0pLmpvaW4oIiIpKSByZXR1cm4gITE7CiAgICAgICAgdmFyIHIgPSB7fTsKICAgICAgICByZXR1cm4gImFiY2RlZmdoaWprbG1ub3BxcnN0Ii5zcGxpdCgiIikuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcltlXSA9IGU7CiAgICAgICAgfSksICJhYmNkZWZnaGlqa2xtbm9wcXJzdCIgPT09IE9iamVjdC5rZXlzKE9iamVjdC5hc3NpZ24oe30sIHIpKS5qb2luKCIiKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJldHVybiAhMTsKICAgICAgfQogICAgfSgpID8gT2JqZWN0LmFzc2lnbiA6IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIGZvciAodmFyIG4sIHMsIGwgPSByKGUpLCBjID0gMTsgYyA8IGFyZ3VtZW50cy5sZW5ndGg7IGMrKykgewogICAgICAgIG4gPSBPYmplY3QoYXJndW1lbnRzW2NdKTsKCiAgICAgICAgZm9yICh2YXIgdSBpbiBuKSB7CiAgICAgICAgICBpLmNhbGwobiwgdSkgJiYgKGxbdV0gPSBuW3VdKTsKICAgICAgICB9CgogICAgICAgIGlmIChvKSB7CiAgICAgICAgICBzID0gbyhuKTsKCiAgICAgICAgICBmb3IgKHZhciBkID0gMDsgZCA8IHMubGVuZ3RoOyBkKyspIHsKICAgICAgICAgICAgYS5jYWxsKG4sIHNbZF0pICYmIChsW3NbZF1dID0gbltzW2RdXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbDsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgcjsKCiAgICBpZiAoIU9iamVjdC5rZXlzKSB7CiAgICAgIHZhciBvID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSwKICAgICAgICAgIGkgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLAogICAgICAgICAgYSA9IG4oMTApLAogICAgICAgICAgcyA9IE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUsCiAgICAgICAgICBsID0gIXMuY2FsbCh7CiAgICAgICAgdG9TdHJpbmc6IG51bGwKICAgICAgfSwgInRvU3RyaW5nIiksCiAgICAgICAgICBjID0gcy5jYWxsKGZ1bmN0aW9uICgpIHt9LCAicHJvdG90eXBlIiksCiAgICAgICAgICB1ID0gWyJ0b1N0cmluZyIsICJ0b0xvY2FsZVN0cmluZyIsICJ2YWx1ZU9mIiwgImhhc093blByb3BlcnR5IiwgImlzUHJvdG90eXBlT2YiLCAicHJvcGVydHlJc0VudW1lcmFibGUiLCAiY29uc3RydWN0b3IiXSwKICAgICAgICAgIGQgPSBmdW5jdGlvbiBkKGUpIHsKICAgICAgICB2YXIgdCA9IGUuY29uc3RydWN0b3I7CiAgICAgICAgcmV0dXJuIHQgJiYgdC5wcm90b3R5cGUgPT09IGU7CiAgICAgIH0sCiAgICAgICAgICBwID0gewogICAgICAgICRhcHBsaWNhdGlvbkNhY2hlOiAhMCwKICAgICAgICAkY29uc29sZTogITAsCiAgICAgICAgJGV4dGVybmFsOiAhMCwKICAgICAgICAkZnJhbWU6ICEwLAogICAgICAgICRmcmFtZUVsZW1lbnQ6ICEwLAogICAgICAgICRmcmFtZXM6ICEwLAogICAgICAgICRpbm5lckhlaWdodDogITAsCiAgICAgICAgJGlubmVyV2lkdGg6ICEwLAogICAgICAgICRvdXRlckhlaWdodDogITAsCiAgICAgICAgJG91dGVyV2lkdGg6ICEwLAogICAgICAgICRwYWdlWE9mZnNldDogITAsCiAgICAgICAgJHBhZ2VZT2Zmc2V0OiAhMCwKICAgICAgICAkcGFyZW50OiAhMCwKICAgICAgICAkc2Nyb2xsTGVmdDogITAsCiAgICAgICAgJHNjcm9sbFRvcDogITAsCiAgICAgICAgJHNjcm9sbFg6ICEwLAogICAgICAgICRzY3JvbGxZOiAhMCwKICAgICAgICAkc2VsZjogITAsCiAgICAgICAgJHdlYmtpdEluZGV4ZWREQjogITAsCiAgICAgICAgJHdlYmtpdFN0b3JhZ2VJbmZvOiAhMCwKICAgICAgICAkd2luZG93OiAhMAogICAgICB9LAogICAgICAgICAgZiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoInVuZGVmaW5lZCIgPT0gdHlwZW9mIHdpbmRvdykgcmV0dXJuICExOwoKICAgICAgICBmb3IgKHZhciBlIGluIHdpbmRvdykgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKCFwWyIkIiArIGVdICYmIG8uY2FsbCh3aW5kb3csIGUpICYmIG51bGwgIT09IHdpbmRvd1tlXSAmJiAib2JqZWN0IiA9PSBfdHlwZW9mKHdpbmRvd1tlXSkpIHRyeSB7CiAgICAgICAgICAgICAgZCh3aW5kb3dbZV0pOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgcmV0dXJuICEwOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIHJldHVybiAhMDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiAhMTsKICAgICAgfSgpLAogICAgICAgICAgaCA9IGZ1bmN0aW9uIGgoZSkgewogICAgICAgIGlmICgidW5kZWZpbmVkIiA9PSB0eXBlb2Ygd2luZG93IHx8ICFmKSByZXR1cm4gZChlKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBkKGUpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIHJldHVybiAhMTsKICAgICAgICB9CiAgICAgIH07CgogICAgICByID0gZnVuY3Rpb24gcihlKSB7CiAgICAgICAgdmFyIHQgPSBudWxsICE9PSBlICYmICJvYmplY3QiID09IF90eXBlb2YoZSksCiAgICAgICAgICAgIG4gPSAiW29iamVjdCBGdW5jdGlvbl0iID09PSBpLmNhbGwoZSksCiAgICAgICAgICAgIHIgPSBhKGUpLAogICAgICAgICAgICBzID0gdCAmJiAiW29iamVjdCBTdHJpbmddIiA9PT0gaS5jYWxsKGUpLAogICAgICAgICAgICBkID0gW107CgogICAgICAgIGlmICghdCAmJiAhbiAmJiAhcikgdGhyb3cgbmV3IFR5cGVFcnJvcigiT2JqZWN0LmtleXMgY2FsbGVkIG9uIGEgbm9uLW9iamVjdCIpOwogICAgICAgIHZhciBwID0gYyAmJiBuOwogICAgICAgIGlmIChzICYmIGUubGVuZ3RoID4gMCAmJiAhby5jYWxsKGUsIDApKSBmb3IgKHZhciBmID0gMDsgZiA8IGUubGVuZ3RoOyArK2YpIHsKICAgICAgICAgIGQucHVzaChTdHJpbmcoZikpOwogICAgICAgIH0KICAgICAgICBpZiAociAmJiBlLmxlbmd0aCA+IDApIGZvciAodmFyIHYgPSAwOyB2IDwgZS5sZW5ndGg7ICsrdikgewogICAgICAgICAgZC5wdXNoKFN0cmluZyh2KSk7CiAgICAgICAgfSBlbHNlIGZvciAodmFyIGcgaW4gZSkgewogICAgICAgICAgcCAmJiAicHJvdG90eXBlIiA9PT0gZyB8fCAhby5jYWxsKGUsIGcpIHx8IGQucHVzaChTdHJpbmcoZykpOwogICAgICAgIH0KICAgICAgICBpZiAobCkgZm9yICh2YXIgbSA9IGgoZSksIHkgPSAwOyB5IDwgdS5sZW5ndGg7ICsreSkgewogICAgICAgICAgbSAmJiAiY29uc3RydWN0b3IiID09PSB1W3ldIHx8ICFvLmNhbGwoZSwgdVt5XSkgfHwgZC5wdXNoKHVbeV0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZDsKICAgICAgfTsKICAgIH0KCiAgICBlLmV4cG9ydHMgPSByOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UsCiAgICAgICAgbyA9IG4oMTApLAogICAgICAgIGkgPSBPYmplY3Qua2V5cywKICAgICAgICBhID0gaSA/IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBpKGUpOwogICAgfSA6IG4oMzkpLAogICAgICAgIHMgPSBPYmplY3Qua2V5czsKICAgIGEuc2hpbSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKE9iamVjdC5rZXlzKSB7CiAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlID0gT2JqZWN0LmtleXMoYXJndW1lbnRzKTsKICAgICAgICAgIHJldHVybiBlICYmIGUubGVuZ3RoID09PSBhcmd1bWVudHMubGVuZ3RoOwogICAgICAgIH0pKDEsIDIpIHx8IChPYmplY3Qua2V5cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gcyhvKGUpID8gci5jYWxsKGUpIDogZSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBPYmplY3Qua2V5cyA9IGE7CgogICAgICByZXR1cm4gT2JqZWN0LmtleXMgfHwgYTsKICAgIH0sIGUuZXhwb3J0cyA9IGE7CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGZ1bmN0aW9uIG4oKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigic2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHIoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkIik7CiAgICB9CgogICAgZnVuY3Rpb24gbyhlKSB7CiAgICAgIGlmICh1ID09PSBzZXRUaW1lb3V0KSByZXR1cm4gc2V0VGltZW91dChlLCAwKTsKICAgICAgaWYgKCh1ID09PSBuIHx8ICF1KSAmJiBzZXRUaW1lb3V0KSByZXR1cm4gdSA9IHNldFRpbWVvdXQsIHNldFRpbWVvdXQoZSwgMCk7CgogICAgICB0cnkgewogICAgICAgIHJldHVybiB1KGUsIDApOwogICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiB1LmNhbGwobnVsbCwgZSwgMCk7CiAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgcmV0dXJuIHUuY2FsbCh0aGlzLCBlLCAwKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBpKGUpIHsKICAgICAgaWYgKGQgPT09IGNsZWFyVGltZW91dCkgcmV0dXJuIGNsZWFyVGltZW91dChlKTsKICAgICAgaWYgKChkID09PSByIHx8ICFkKSAmJiBjbGVhclRpbWVvdXQpIHJldHVybiBkID0gY2xlYXJUaW1lb3V0LCBjbGVhclRpbWVvdXQoZSk7CgogICAgICB0cnkgewogICAgICAgIHJldHVybiBkKGUpOwogICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBkLmNhbGwobnVsbCwgZSk7CiAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgcmV0dXJuIGQuY2FsbCh0aGlzLCBlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhKCkgewogICAgICB2ICYmIGYgJiYgKHYgPSAhMSwgZi5sZW5ndGggPyBoID0gZi5jb25jYXQoaCkgOiBnID0gLTEsIGgubGVuZ3RoICYmIHMoKSk7CiAgICB9CgogICAgZnVuY3Rpb24gcygpIHsKICAgICAgaWYgKCF2KSB7CiAgICAgICAgdmFyIGUgPSBvKGEpOwogICAgICAgIHYgPSAhMDsKCiAgICAgICAgZm9yICh2YXIgdCA9IGgubGVuZ3RoOyB0OykgewogICAgICAgICAgZm9yIChmID0gaCwgaCA9IFtdOyArK2cgPCB0OykgewogICAgICAgICAgICBmICYmIGZbZ10ucnVuKCk7CiAgICAgICAgICB9CgogICAgICAgICAgZyA9IC0xLCB0ID0gaC5sZW5ndGg7CiAgICAgICAgfQoKICAgICAgICBmID0gbnVsbCwgdiA9ICExLCBpKGUpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gbChlLCB0KSB7CiAgICAgIHRoaXMuZnVuID0gZSwgdGhpcy5hcnJheSA9IHQ7CiAgICB9CgogICAgZnVuY3Rpb24gYygpIHt9CgogICAgdmFyIHUsCiAgICAgICAgZCwKICAgICAgICBwID0gZS5leHBvcnRzID0ge307CiAgICAhZnVuY3Rpb24gKCkgewogICAgICB0cnkgewogICAgICAgIHUgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBzZXRUaW1lb3V0ID8gc2V0VGltZW91dCA6IG47CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB1ID0gbjsKICAgICAgfQoKICAgICAgdHJ5IHsKICAgICAgICBkID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgY2xlYXJUaW1lb3V0ID8gY2xlYXJUaW1lb3V0IDogcjsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGQgPSByOwogICAgICB9CiAgICB9KCk7CiAgICB2YXIgZiwKICAgICAgICBoID0gW10sCiAgICAgICAgdiA9ICExLAogICAgICAgIGcgPSAtMTsKICAgIHAubmV4dFRpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdCA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkgZm9yICh2YXIgbiA9IDE7IG4gPCBhcmd1bWVudHMubGVuZ3RoOyBuKyspIHsKICAgICAgICB0W24gLSAxXSA9IGFyZ3VtZW50c1tuXTsKICAgICAgfQogICAgICBoLnB1c2gobmV3IGwoZSwgdCkpLCAxICE9PSBoLmxlbmd0aCB8fCB2IHx8IG8ocyk7CiAgICB9LCBsLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpOwogICAgfSwgcC50aXRsZSA9ICJicm93c2VyIiwgcC5icm93c2VyID0gITAsIHAuZW52ID0ge30sIHAuYXJndiA9IFtdLCBwLnZlcnNpb24gPSAiIiwgcC52ZXJzaW9ucyA9IHt9LCBwLm9uID0gYywgcC5hZGRMaXN0ZW5lciA9IGMsIHAub25jZSA9IGMsIHAub2ZmID0gYywgcC5yZW1vdmVMaXN0ZW5lciA9IGMsIHAucmVtb3ZlQWxsTGlzdGVuZXJzID0gYywgcC5lbWl0ID0gYywgcC5wcmVwZW5kTGlzdGVuZXIgPSBjLCBwLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBjLCBwLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0sIHAuYmluZGluZyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigicHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQiKTsKICAgIH0sIHAuY3dkID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gIi8iOwogICAgfSwgcC5jaGRpciA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigicHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkIik7CiAgICB9LCBwLnVtYXNrID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gMDsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICBmdW5jdGlvbiByKGUpIHsKICAgICAgcmV0dXJuIGUgPSBKU09OLnN0cmluZ2lmeShlKSwgISEvXlx7W1xzXFNdKlx9JC8udGVzdChlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvKGUpIHsKICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gZSB8fCAiZnVuY3Rpb24iID09IHR5cGVvZiBlID8gZSArICIiIDogSlNPTi5zdHJpbmdpZnkoZSk7CiAgICB9CgogICAgZnVuY3Rpb24gaShlKSB7CiAgICAgIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgZSkgdHJ5IHsKICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShlKTsKICAgICAgfSBjYXRjaCAodCkgewogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYShlKSB7CiAgICAgIHJldHVybiAiW29iamVjdCBGdW5jdGlvbl0iID09PSB7fS50b1N0cmluZy5jYWxsKGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHMoZSkgewogICAgICByZXR1cm4gIltvYmplY3QgQXJyYXldIiA9PT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGwoKSB7CiAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBsKSkgcmV0dXJuIG5ldyBsKCk7CiAgICB9CgogICAgZnVuY3Rpb24gYyhlLCB0KSB7CiAgICAgIHZhciBuID0gYXJndW1lbnRzLAogICAgICAgICAgbyA9IG51bGw7CiAgICAgIGlmIChkIHx8IChkID0gbCgpKSwgMCA9PT0gbi5sZW5ndGgpIHJldHVybiBkLmdldCgpOwoKICAgICAgaWYgKDEgPT09IG4ubGVuZ3RoKSB7CiAgICAgICAgaWYgKCJzdHJpbmciID09IHR5cGVvZiBlKSByZXR1cm4gZC5nZXQoZSk7CiAgICAgICAgaWYgKHIoZSkpIHJldHVybiBkLnNldChlKTsKICAgICAgfQoKICAgICAgaWYgKDIgPT09IG4ubGVuZ3RoICYmICJzdHJpbmciID09IHR5cGVvZiBlKSB7CiAgICAgICAgaWYgKCF0KSByZXR1cm4gZC5yZW1vdmUoZSk7CiAgICAgICAgaWYgKHQgJiYgInN0cmluZyIgPT0gdHlwZW9mIHQpIHJldHVybiBkLnNldChlLCB0KTsKICAgICAgICB0ICYmIGEodCkgJiYgKG8gPSBudWxsLCBvID0gdChlLCBkLmdldChlKSksIGMuc2V0KGUsIG8pKTsKICAgICAgfQoKICAgICAgaWYgKDIgPT09IG4ubGVuZ3RoICYmIHMoZSkgJiYgYSh0KSkgZm9yICh2YXIgaSA9IDAsIHUgPSBlLmxlbmd0aDsgaSA8IHU7IGkrKykgewogICAgICAgIG8gPSB0KGVbaV0sIGQuZ2V0KGVbaV0pKSwgYy5zZXQoZVtpXSwgbyk7CiAgICAgIH0KICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsICJfX2VzTW9kdWxlIiwgewogICAgICB2YWx1ZTogITAKICAgIH0pOwogICAgLyohCiAgICAqIHN0b3JlanMgdjEuMC4yNAogICAgKiBMb2NhbCBzdG9yYWdlIGxvY2Fsc3RvcmFnZSBwYWNrYWdlIHByb3ZpZGVzIGEgc2ltcGxlIEFQSQogICAgKiAKICAgICogQ29weXJpZ2h0IChjKSAyMDE4IGtlbm55IHdhbmcgPHdvd29ob29AcXEuY29tPgogICAgKiBodHRwczovL2dpdGh1Yi5jb20vamF5d2NqbG92ZS9zdG9yZS5qcwogICAgKiAKICAgICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLgogICAgKi8KCiAgICB2YXIgdSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2U7CiAgICB1ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHQgPSAiX0lzX0luY29nbml0IjsKCiAgICAgIHRyeSB7CiAgICAgICAgZS5zZXRJdGVtKHQsICJ5ZXMiKTsKICAgICAgfSBjYXRjaCAodCkgewogICAgICAgIGlmICgiUXVvdGFFeGNlZWRlZEVycm9yIiA9PT0gdC5uYW1lKSB7CiAgICAgICAgICB2YXIgbiA9IGZ1bmN0aW9uIG4oKSB7fTsKCiAgICAgICAgICBlLl9fcHJvdG9fXyA9IHsKICAgICAgICAgICAgc2V0SXRlbTogbiwKICAgICAgICAgICAgZ2V0SXRlbTogbiwKICAgICAgICAgICAgcmVtb3ZlSXRlbTogbiwKICAgICAgICAgICAgY2xlYXI6IG4KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9IGZpbmFsbHkgewogICAgICAgICJ5ZXMiID09PSBlLmdldEl0ZW0odCkgJiYgZS5yZW1vdmVJdGVtKHQpOwogICAgICB9CgogICAgICByZXR1cm4gZTsKICAgIH0odSksIGwucHJvdG90eXBlID0gewogICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlLCB0KSB7CiAgICAgICAgaWYgKGUgJiYgIXIoZSkpIHUuc2V0SXRlbShlLCBvKHQpKTtlbHNlIGlmIChyKGUpKSBmb3IgKHZhciBuIGluIGUpIHsKICAgICAgICAgIHRoaXMuc2V0KG4sIGVbbl0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoZSkgewogICAgICAgIGlmICghZSkgewogICAgICAgICAgdmFyIHQgPSB7fTsKICAgICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24gKGUsIG4pIHsKICAgICAgICAgICAgcmV0dXJuIHRbZV0gPSBuOwogICAgICAgICAgfSksIHQ7CiAgICAgICAgfQoKICAgICAgICBpZiAoIj8iID09PSBlLmNoYXJBdCgwKSkgcmV0dXJuIHRoaXMuaGFzKGUuc3Vic3RyKDEpKTsKICAgICAgICB2YXIgbiA9IGFyZ3VtZW50czsKCiAgICAgICAgaWYgKG4ubGVuZ3RoID4gMSkgewogICAgICAgICAgZm9yICh2YXIgciA9IHt9LCBvID0gMCwgYSA9IG4ubGVuZ3RoOyBvIDwgYTsgbysrKSB7CiAgICAgICAgICAgIHZhciBzID0gaSh1LmdldEl0ZW0obltvXSkpOwogICAgICAgICAgICBzICYmIChyW25bb11dID0gcyk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaSh1LmdldEl0ZW0oZSkpOwogICAgICB9LAogICAgICBjbGVhcjogZnVuY3Rpb24gY2xlYXIoKSB7CiAgICAgICAgcmV0dXJuIHUuY2xlYXIoKSwgdGhpczsKICAgICAgfSwKICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoZSkgewogICAgICAgIHZhciB0ID0gdGhpcy5nZXQoZSk7CiAgICAgICAgcmV0dXJuIHUucmVtb3ZlSXRlbShlKSwgdDsKICAgICAgfSwKICAgICAgaGFzOiBmdW5jdGlvbiBoYXMoZSkgewogICAgICAgIHJldHVybiB7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuZ2V0KCksIGUpOwogICAgICB9LAogICAgICBrZXlzOiBmdW5jdGlvbiBrZXlzKCkgewogICAgICAgIHZhciBlID0gW107CiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgZS5wdXNoKHQpOwogICAgICAgIH0pLCBlOwogICAgICB9LAogICAgICBmb3JFYWNoOiBmdW5jdGlvbiBmb3JFYWNoKGUpIHsKICAgICAgICBmb3IgKHZhciB0ID0gMCwgbiA9IHUubGVuZ3RoOyB0IDwgbjsgdCsrKSB7CiAgICAgICAgICB2YXIgciA9IHUua2V5KHQpOwogICAgICAgICAgZShyLCB0aGlzLmdldChyKSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSwKICAgICAgc2VhcmNoOiBmdW5jdGlvbiBzZWFyY2goZSkgewogICAgICAgIGZvciAodmFyIHQgPSB0aGlzLmtleXMoKSwgbiA9IHt9LCByID0gMCwgbyA9IHQubGVuZ3RoOyByIDwgbzsgcisrKSB7CiAgICAgICAgICB0W3JdLmluZGV4T2YoZSkgPiAtMSAmJiAoblt0W3JdXSA9IHRoaXMuZ2V0KHRbcl0pKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBuOwogICAgICB9CiAgICB9OwogICAgdmFyIGQgPSBudWxsOwoKICAgIGZvciAodmFyIHAgaW4gbC5wcm90b3R5cGUpIHsKICAgICAgY1twXSA9IGwucHJvdG90eXBlW3BdOwogICAgfQoKICAgIHRbImRlZmF1bHQiXSA9IGM7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oMTIpLAogICAgICAgIG8gPSBuKDkpLAogICAgICAgIGkgPSBuKDExKSwKICAgICAgICBhID0gbigxMyksCiAgICAgICAgcyA9IG4oNDkpLAogICAgICAgIGwgPSByKGEoKSk7CiAgICBvKGwsIHsKICAgICAgZ2V0UG9seWZpbGw6IGEsCiAgICAgIGltcGxlbWVudGF0aW9uOiBpLAogICAgICBzaGltOiBzCiAgICB9KSwgZS5leHBvcnRzID0gbDsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gbigxKSwKICAgICAgICBvID0gcigiJVN0cmluZyUiKSwKICAgICAgICBpID0gcigiJVR5cGVFcnJvciUiKTsKCiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoInN5bWJvbCIgPT0gX3R5cGVvZihlKSkgdGhyb3cgbmV3IGkoIkNhbm5vdCBjb252ZXJ0IGEgU3ltYm9sIHZhbHVlIHRvIGEgc3RyaW5nIik7CiAgICAgIHJldHVybiBvKGUpOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gbigxKSwKICAgICAgICBvID0gcigiJVR5cGVFcnJvciUiKTsKCiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICBpZiAobnVsbCA9PSBlKSB0aHJvdyBuZXcgbyh0IHx8ICJDYW5ub3QgY2FsbCBtZXRob2Qgb24gIiArIGUpOwogICAgICByZXR1cm4gZTsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oMSksCiAgICAgICAgbyA9IG4oMTIpLAogICAgICAgIGkgPSBvKHIoIlN0cmluZy5wcm90b3R5cGUuaW5kZXhPZiIpKTsKCiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICB2YXIgbiA9IHIoZSwgISF0KTsKICAgICAgcmV0dXJuICJmdW5jdGlvbiIgPT0gdHlwZW9mIG4gJiYgaShlLCAiLnByb3RvdHlwZS4iKSA/IG8obikgOiBuOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIChmdW5jdGlvbiAodCkgewogICAgICB2YXIgciA9IHQuU3ltYm9sLAogICAgICAgICAgbyA9IG4oNDgpOwoKICAgICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAiZnVuY3Rpb24iID09IHR5cGVvZiByICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiAic3ltYm9sIiA9PSBfdHlwZW9mKHIoImZvbyIpKSAmJiAic3ltYm9sIiA9PSBfdHlwZW9mKFN5bWJvbCgiYmFyIikpICYmIG8oKTsKICAgICAgfTsKICAgIH0pLmNhbGwodCwgbigxNCkpOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgU3ltYm9sIHx8ICJmdW5jdGlvbiIgIT0gdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHJldHVybiAhMTsKICAgICAgaWYgKCJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLml0ZXJhdG9yKSkgcmV0dXJuICEwOwogICAgICB2YXIgZSA9IHt9LAogICAgICAgICAgdCA9IFN5bWJvbCgidGVzdCIpLAogICAgICAgICAgbiA9IE9iamVjdCh0KTsKICAgICAgaWYgKCJzdHJpbmciID09IHR5cGVvZiB0KSByZXR1cm4gITE7CiAgICAgIGlmICgiW29iamVjdCBTeW1ib2xdIiAhPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpKSByZXR1cm4gITE7CiAgICAgIGlmICgiW29iamVjdCBTeW1ib2xdIiAhPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG4pKSByZXR1cm4gITE7CiAgICAgIGVbdF0gPSA0MjsKCiAgICAgIGZvciAodCBpbiBlKSB7CiAgICAgICAgcmV0dXJuICExOwogICAgICB9CgogICAgICBpZiAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgT2JqZWN0LmtleXMgJiYgMCAhPT0gT2JqZWN0LmtleXMoZSkubGVuZ3RoKSByZXR1cm4gITE7CiAgICAgIGlmICgiZnVuY3Rpb24iID09IHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyAmJiAwICE9PSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhlKS5sZW5ndGgpIHJldHVybiAhMTsKICAgICAgdmFyIHIgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpOwogICAgICBpZiAoMSAhPT0gci5sZW5ndGggfHwgclswXSAhPT0gdCkgcmV0dXJuICExOwogICAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLCB0KSkgcmV0dXJuICExOwoKICAgICAgaWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IpIHsKICAgICAgICB2YXIgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgdCk7CiAgICAgICAgaWYgKDQyICE9PSBvLnZhbHVlIHx8ICEwICE9PSBvLmVudW1lcmFibGUpIHJldHVybiAhMTsKICAgICAgfQoKICAgICAgcmV0dXJuICEwOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gbig5KSwKICAgICAgICBvID0gbigxMyk7CgogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgZSA9IG8oKTsKICAgICAgcmV0dXJuIHIoU3RyaW5nLnByb3RvdHlwZSwgewogICAgICAgIHRyaW06IGUKICAgICAgfSwgewogICAgICAgIHRyaW06IGZ1bmN0aW9uIHRyaW0oKSB7CiAgICAgICAgICByZXR1cm4gU3RyaW5nLnByb3RvdHlwZS50cmltICE9PSBlOwogICAgICAgIH0KICAgICAgfSksIGU7CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgKGZ1bmN0aW9uICh0KSB7CiAgICAgIHZhciBuID0gInByb2R1Y3Rpb24iICE9PSB0LmVudi5OT0RFX0VOViwKICAgICAgICAgIHIgPSBmdW5jdGlvbiByKCkge307CgogICAgICBpZiAobikgewogICAgICAgIHZhciBvID0gZnVuY3Rpb24gbyhlLCB0KSB7CiAgICAgICAgICB2YXIgbiA9IGFyZ3VtZW50cy5sZW5ndGg7CiAgICAgICAgICB0ID0gbmV3IEFycmF5KG4gPiAxID8gbiAtIDEgOiAwKTsKCiAgICAgICAgICBmb3IgKHZhciByID0gMTsgciA8IG47IHIrKykgewogICAgICAgICAgICB0W3IgLSAxXSA9IGFyZ3VtZW50c1tyXTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgbyA9IDAsCiAgICAgICAgICAgICAgaSA9ICJXYXJuaW5nOiAiICsgZS5yZXBsYWNlKC8lcy9nLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB0W28rK107CiAgICAgICAgICB9KTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoaSk7CiAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgIH07CgogICAgICAgIHIgPSBmdW5jdGlvbiByKGUsIHQsIG4pIHsKICAgICAgICAgIHZhciByID0gYXJndW1lbnRzLmxlbmd0aDsKICAgICAgICAgIG4gPSBuZXcgQXJyYXkociA+IDIgPyByIC0gMiA6IDApOwoKICAgICAgICAgIGZvciAodmFyIGkgPSAyOyBpIDwgcjsgaSsrKSB7CiAgICAgICAgICAgIG5baSAtIDJdID0gYXJndW1lbnRzW2ldOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh2b2lkIDAgPT09IHQpIHRocm93IG5ldyBFcnJvcigiYHdhcm5pbmcoY29uZGl0aW9uLCBmb3JtYXQsIC4uLmFyZ3MpYCByZXF1aXJlcyBhIHdhcm5pbmcgbWVzc2FnZSBhcmd1bWVudCIpOwogICAgICAgICAgZSB8fCBvLmFwcGx5KG51bGwsIFt0XS5jb25jYXQobikpOwogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGUuZXhwb3J0cyA9IHI7CiAgICB9KS5jYWxsKHQsIG4oNDEpKTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgZnVuY3Rpb24gcihlLCB0KSB7CiAgICAgIHJldHVybiBuZXcgYSh0KS5wcm9jZXNzKGUpOwogICAgfQoKICAgIHZhciBvID0gbigxNSksCiAgICAgICAgaSA9IG4oMTYpLAogICAgICAgIGEgPSBuKDUyKTsKICAgIHQgPSBlLmV4cG9ydHMgPSByLCB0LmZpbHRlclhTUyA9IHIsIHQuRmlsdGVyWFNTID0gYTsKCiAgICBmb3IgKHZhciBzIGluIG8pIHsKICAgICAgdFtzXSA9IG9bc107CiAgICB9CgogICAgZm9yICh2YXIgcyBpbiBpKSB7CiAgICAgIHRbc10gPSBpW3NdOwogICAgfQoKICAgICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgJiYgKHdpbmRvdy5maWx0ZXJYU1MgPSBlLmV4cG9ydHMpLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygc2VsZiAmJiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgRGVkaWNhdGVkV29ya2VyR2xvYmFsU2NvcGUgJiYgc2VsZiBpbnN0YW5jZW9mIERlZGljYXRlZFdvcmtlckdsb2JhbFNjb3BlOwogICAgfSgpICYmIChzZWxmLmZpbHRlclhTUyA9IGUuZXhwb3J0cyk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIGZ1bmN0aW9uIHIoZSkgewogICAgICByZXR1cm4gdm9pZCAwID09PSBlIHx8IG51bGwgPT09IGU7CiAgICB9CgogICAgZnVuY3Rpb24gbyhlKSB7CiAgICAgIHZhciB0ID0gcC5zcGFjZUluZGV4KGUpOwogICAgICBpZiAoLTEgPT09IHQpIHJldHVybiB7CiAgICAgICAgaHRtbDogIiIsCiAgICAgICAgY2xvc2luZzogIi8iID09PSBlW2UubGVuZ3RoIC0gMl0KICAgICAgfTsKICAgICAgZSA9IHAudHJpbShlLnNsaWNlKHQgKyAxLCAtMSkpOwogICAgICB2YXIgbiA9ICIvIiA9PT0gZVtlLmxlbmd0aCAtIDFdOwogICAgICByZXR1cm4gbiAmJiAoZSA9IHAudHJpbShlLnNsaWNlKDAsIC0xKSkpLCB7CiAgICAgICAgaHRtbDogZSwKICAgICAgICBjbG9zaW5nOiBuCiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gaShlKSB7CiAgICAgIHZhciB0ID0ge307CgogICAgICBmb3IgKHZhciBuIGluIGUpIHsKICAgICAgICB0W25dID0gZVtuXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHQ7CiAgICB9CgogICAgZnVuY3Rpb24gYShlKSB7CiAgICAgIGUgPSBpKGUgfHwge30pLCBlLnN0cmlwSWdub3JlVGFnICYmIChlLm9uSWdub3JlVGFnLCBlLm9uSWdub3JlVGFnID0gbC5vbklnbm9yZVRhZ1N0cmlwQWxsKSwgZS53aGl0ZUxpc3QgPSBlLndoaXRlTGlzdCB8fCBsLndoaXRlTGlzdCwgZS5vblRhZyA9IGUub25UYWcgfHwgbC5vblRhZywgZS5vblRhZ0F0dHIgPSBlLm9uVGFnQXR0ciB8fCBsLm9uVGFnQXR0ciwgZS5vbklnbm9yZVRhZyA9IGUub25JZ25vcmVUYWcgfHwgbC5vbklnbm9yZVRhZywgZS5vbklnbm9yZVRhZ0F0dHIgPSBlLm9uSWdub3JlVGFnQXR0ciB8fCBsLm9uSWdub3JlVGFnQXR0ciwgZS5zYWZlQXR0clZhbHVlID0gZS5zYWZlQXR0clZhbHVlIHx8IGwuc2FmZUF0dHJWYWx1ZSwgZS5lc2NhcGVIdG1sID0gZS5lc2NhcGVIdG1sIHx8IGwuZXNjYXBlSHRtbCwgdGhpcy5vcHRpb25zID0gZSwgITEgPT09IGUuY3NzID8gdGhpcy5jc3NGaWx0ZXIgPSAhMSA6IChlLmNzcyA9IGUuY3NzIHx8IHt9LCB0aGlzLmNzc0ZpbHRlciA9IG5ldyBzKGUuY3NzKSk7CiAgICB9CgogICAgdmFyIHMgPSBuKDMpLkZpbHRlckNTUywKICAgICAgICBsID0gbigxNSksCiAgICAgICAgYyA9IG4oMTYpLAogICAgICAgIHUgPSBjLnBhcnNlVGFnLAogICAgICAgIGQgPSBjLnBhcnNlQXR0ciwKICAgICAgICBwID0gbig1KTsKICAgIGEucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoZSA9IGUgfHwgIiIsICEoZSA9IGUudG9TdHJpbmcoKSkpIHJldHVybiAiIjsKICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgbiA9IHQub3B0aW9ucywKICAgICAgICAgIGkgPSBuLndoaXRlTGlzdCwKICAgICAgICAgIGEgPSBuLm9uVGFnLAogICAgICAgICAgcyA9IG4ub25JZ25vcmVUYWcsCiAgICAgICAgICBjID0gbi5vblRhZ0F0dHIsCiAgICAgICAgICBmID0gbi5vbklnbm9yZVRhZ0F0dHIsCiAgICAgICAgICBoID0gbi5zYWZlQXR0clZhbHVlLAogICAgICAgICAgdiA9IG4uZXNjYXBlSHRtbCwKICAgICAgICAgIGcgPSB0LmNzc0ZpbHRlcjsKICAgICAgbi5zdHJpcEJsYW5rQ2hhciAmJiAoZSA9IGwuc3RyaXBCbGFua0NoYXIoZSkpLCBuLmFsbG93Q29tbWVudFRhZyB8fCAoZSA9IGwuc3RyaXBDb21tZW50VGFnKGUpKTsKICAgICAgdmFyIG0gPSAhMTsKCiAgICAgIGlmIChuLnN0cmlwSWdub3JlVGFnQm9keSkgewogICAgICAgIHZhciBtID0gbC5TdHJpcFRhZ0JvZHkobi5zdHJpcElnbm9yZVRhZ0JvZHksIHMpOwogICAgICAgIHMgPSBtLm9uSWdub3JlVGFnOwogICAgICB9CgogICAgICB2YXIgeSA9IHUoZSwgZnVuY3Rpb24gKGUsIHQsIG4sIGwsIHUpIHsKICAgICAgICB2YXIgbSA9IHsKICAgICAgICAgIHNvdXJjZVBvc2l0aW9uOiBlLAogICAgICAgICAgcG9zaXRpb246IHQsCiAgICAgICAgICBpc0Nsb3Npbmc6IHUsCiAgICAgICAgICBpc1doaXRlOiBpLmhhc093blByb3BlcnR5KG4pCiAgICAgICAgfSwKICAgICAgICAgICAgeSA9IGEobiwgbCwgbSk7CiAgICAgICAgaWYgKCFyKHkpKSByZXR1cm4geTsKCiAgICAgICAgaWYgKG0uaXNXaGl0ZSkgewogICAgICAgICAgaWYgKG0uaXNDbG9zaW5nKSByZXR1cm4gIjwvIiArIG4gKyAiPiI7CiAgICAgICAgICB2YXIgYiA9IG8obCksCiAgICAgICAgICAgICAgdyA9IGlbbl0sCiAgICAgICAgICAgICAgeCA9IGQoYi5odG1sLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgICB2YXIgbyA9IC0xICE9PSBwLmluZGV4T2YodywgZSksCiAgICAgICAgICAgICAgICBpID0gYyhuLCBlLCB0LCBvKTsKICAgICAgICAgICAgaWYgKCFyKGkpKSByZXR1cm4gaTsKICAgICAgICAgICAgaWYgKG8pIHJldHVybiB0ID0gaChuLCBlLCB0LCBnKSwgdCA/IGUgKyAnPSInICsgdCArICciJyA6IGU7CiAgICAgICAgICAgIHZhciBpID0gZihuLCBlLCB0LCBvKTsKICAgICAgICAgICAgcmV0dXJuIHIoaSkgPyB2b2lkIDAgOiBpOwogICAgICAgICAgfSksCiAgICAgICAgICAgICAgbCA9ICI8IiArIG47CiAgICAgICAgICByZXR1cm4geCAmJiAobCArPSAiICIgKyB4KSwgYi5jbG9zaW5nICYmIChsICs9ICIgLyIpLCBsICs9ICI+IjsKICAgICAgICB9CgogICAgICAgIHZhciB5ID0gcyhuLCBsLCBtKTsKICAgICAgICByZXR1cm4gcih5KSA/IHYobCkgOiB5OwogICAgICB9LCB2KTsKICAgICAgcmV0dXJuIG0gJiYgKHkgPSBtLnJlbW92ZSh5KSksIHk7CiAgICB9LCBlLmV4cG9ydHMgPSBhOwogIH0sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICBlLmV4cG9ydHMgPSB7CiAgICAgIHNtaWxlOiAiZTMvMjAxOG5ld193ZWl4aW9hMDJfb3JnLnBuZyIsCiAgICAgIGxvdmVseTogIjA5LzIwMThuZXdfa2VhaV9vcmcucG5nIiwKICAgICAgaGFwcHk6ICIxZS8yMDE4bmV3X3RhaWthaXhpbl9vcmcucG5nIiwKICAgICAgY2xhcDogIjZlLzIwMThuZXdfZ3V6aGFuZ190aHVtYi5wbmciLAogICAgICB3aGVlOiAiMzMvMjAxOG5ld194aXhpX3RodW1iLnBuZyIsCiAgICAgIGhhaGE6ICI4Zi8yMDE4bmV3X2hhaGFfdGh1bWIucG5nIiwKICAgICAgImxhdWdoIGFuZCBjcnkiOiAiNGEvMjAxOG5ld194aWFva3VfdGh1bWIucG5nIiwKICAgICAgd2luazogIjQzLzIwMThuZXdfaml5YW5fb3JnLnBuZyIsCiAgICAgIGdyZWRkeTogImZhLzIwMThuZXdfY2hhbnp1aV9vcmcucG5nIiwKICAgICAgYXdrd2FyZDogImEzLzIwMThuZXdfaGVpeGlhbl90aHVtYi5wbmciLAogICAgICBzd2VhdDogIjI4LzIwMThuZXdfaGFuX29yZy5wbmciLAogICAgICAicGljayBub3NlIjogIjlhLzIwMThuZXdfd2FiaV90aHVtYi5wbmciLAogICAgICBodW06ICI3Yy8yMDE4bmV3X2hlbmdfdGh1bWIucG5nIiwKICAgICAgYW5ncnk6ICJmNi8yMDE4bmV3X251X3RodW1iLnBuZyIsCiAgICAgIGdyaWV2YW5jZTogImE1LzIwMThuZXdfd2VpcXVfdGh1bWIucG5nIiwKICAgICAgcG9vcjogIjk2LzIwMThuZXdfa2VsaWFuX29yZy5wbmciLAogICAgICBkaXNhcHBvaW50OiAiYWEvMjAxOG5ld19zaGl3YW5nX3RodW1iLnBuZyIsCiAgICAgIHNhZDogImVlLzIwMThuZXdfYmVpc2hhbmdfb3JnLnBuZyIsCiAgICAgIHRlYXI6ICI2ZS8yMDE4bmV3X2xlaW11X29yZy5wbmciLAogICAgICAibm8gd2F5IjogIjgzLzIwMThuZXdfa3V4aWFvX29yZy5wbmciLAogICAgICBzaHk6ICJjMS8yMDE4bmV3X2hhaXhpdV9vcmcucG5nIiwKICAgICAgZGlydDogIjEwLzIwMThuZXdfd3VfdGh1bWIucG5nIiwKICAgICAgImxvdmUgeW91IjogImY2LzIwMThuZXdfYWluaV9vcmcucG5nIiwKICAgICAga2lzczogIjJjLzIwMThuZXdfcWlucWluX3RodW1iLnBuZyIsCiAgICAgIGFtb3JvdXNuZXNzOiAiOWQvMjAxOG5ld19odWF4aW5fb3JnLnBuZyIsCiAgICAgIGxvbmdpbmc6ICJjOS8yMDE4bmV3X2Nob25namluZ19vcmcucG5nIiwKICAgICAgZGVzaXJlOiAiM2UvMjAxOG5ld190aWFucGluZ190aHVtYi5wbmciLAogICAgICAiYmFkIGxhdWdoIjogIjRkLzIwMThuZXdfaHVhaXhpYW9fb3JnLnBuZyIsCiAgICAgIGJsYWNrbmVzczogIjllLzIwMThuZXdfeWlueGlhbl9vcmcucG5nIiwKICAgICAgImxhdWdoIHdpdGhvdXQgd29yZCI6ICIyZC8yMDE4bmV3X3hpYW9lcmJ1eXVfb3JnLnBuZyIsCiAgICAgIHRpdHRlcjogIjcxLzIwMThuZXdfdG91eGlhb19vcmcucG5nIiwKICAgICAgY29vbDogImM0LzIwMThuZXdfa3Vfb3JnLnBuZyIsCiAgICAgICJub3QgZWFzeSI6ICJhYS8yMDE4bmV3X2JpbmdidWppYW5kYW5fdGh1bWIucG5nIiwKICAgICAgdGhpbms6ICIzMC8yMDE4bmV3X3Npa2FvX29yZy5wbmciLAogICAgICBxdWVzdGlvbjogImI4LzIwMThuZXdfbmluZ3dlbl9vcmcucG5nIiwKICAgICAgIm5vIGlkZWEiOiAiMmEvMjAxOG5ld193ZW5oYW9fdGh1bWIucG5nIiwKICAgICAgZGl6enk6ICIwNy8yMDE4bmV3X3l1bl90aHVtYi5wbmciLAogICAgICBib21iOiAiYTIvMjAxOG5ld19zaHVhaV90aHVtYi5wbmciLAogICAgICBib25lOiAiYTEvMjAxOG5ld19rdWxvdV90aHVtYi5wbmciLAogICAgICAiYmUgcXVpZXQiOiAiYjAvMjAxOG5ld194dV9vcmcucG5nIiwKICAgICAgInNodXQgdXAiOiAiNjIvMjAxOG5ld19iaXp1aV9vcmcucG5nIiwKICAgICAgc3R1cGlkOiAiZGQvMjAxOG5ld19zaGF5YW5fb3JnLnBuZyIsCiAgICAgICJzdXJwcmlzZSAiOiAiNDkvMjAxOG5ld19jaGlqaW5nX29yZy5wbmciLAogICAgICB2b21pdDogIjA4LzIwMThuZXdfdHVfb3JnLnBuZyIsCiAgICAgIGNvbGQ6ICI0MC8yMDE4bmV3X2tvdXpoYW9fdGh1bWIucG5nIiwKICAgICAgc2ljazogIjNiLzIwMThuZXdfc2hlbmdiaW5nX3RodW1iLnBuZyIsCiAgICAgIGJ5ZTogImZkLzIwMThuZXdfYmFpYmFpX3RodW1iLnBuZyIsCiAgICAgICJsb29rIGRvd24gb24iOiAiZGEvMjAxOG5ld19iaXNoaV9vcmcucG5nIiwKICAgICAgIndoaXRlIGV5ZSI6ICJlZi8yMDE4bmV3X2xhbmRlbGluaV9vcmcucG5nIiwKICAgICAgImxlZnQgaHVtIjogIjQzLzIwMThuZXdfenVvaGVuZ2hlbmdfdGh1bWIucG5nIiwKICAgICAgInJpZ2h0IGh1bSI6ICJjMS8yMDE4bmV3X3lvdWhlbmdoZW5nX3RodW1iLnBuZyIsCiAgICAgIGNyYXp5OiAiMTcvMjAxOG5ld196aHVha3Vhbmdfb3JnLnBuZyIsCiAgICAgICJzY29sZCAiOiAiODcvMjAxOG5ld196aG91bWFfdGh1bWIucG5nIiwKICAgICAgImhpdCBvbiBmYWNlIjogImNiLzIwMThuZXdfZGFsaWFuX29yZy5wbmciLAogICAgICB3b3c6ICJhZS8yMDE4bmV3X2Rpbmdfb3JnLnBuZyIsCiAgICAgIGZhbjogIjg2LzIwMThuZXdfaHVmZW4wMl9vcmcucG5nIiwKICAgICAgbW9uZXk6ICJhMi8yMDE4bmV3X3FpYW5fdGh1bWIucG5nIiwKICAgICAgeWF3bjogIjU1LzIwMThuZXdfZGFoYXFpYW5fb3JnLnBuZyIsCiAgICAgIHNsZWVweTogIjNjLzIwMThuZXdfa3VuX3RodW1iLnBuZyIsCiAgICAgIHNsZWVwOiAiZTIvMjAxOG5ld19zaHVpamlhb190aHVtYi5wbmciLAogICAgICAid2F0ZXJtZWxvbiAiOiAiMDEvMjAxOG5ld19jaGlndWFfdGh1bWIucG5nIiwKICAgICAgZG9nZTogImExLzIwMThuZXdfZG9nZTAyX29yZy5wbmciLAogICAgICBkb2c6ICIyMi8yMDE4bmV3X2VyaGFfb3JnLnBuZyIsCiAgICAgIGNhdDogIjdiLzIwMThuZXdfbWlhb21pYW9fdGh1bWIucG5nIiwKICAgICAgdGh1bWI6ICJlNi8yMDE4bmV3X3phbl9vcmcucG5nIiwKICAgICAgZ29vZDogIjhhLzIwMThuZXdfZ29vZF9vcmcucG5nIiwKICAgICAgb2s6ICI0NS8yMDE4bmV3X29rX29yZy5wbmciLAogICAgICB5ZWFoOiAiMjkvMjAxOG5ld195ZV90aHVtYi5wbmciLAogICAgICAic2hhY2sgaGFuZCI6ICJlOS8yMDE4bmV3X3dvc2hvdV90aHVtYi5wbmciLAogICAgICBib3c6ICJlNy8yMDE4bmV3X3p1b3lpX29yZy5wbmciLAogICAgICBjb21lOiAiNDIvMjAxOG5ld19ndW9sYWlfdGh1bWIucG5nIiwKICAgICAgcHVuY2g6ICI4Ni8yMDE4bmV3X3F1YW50b3VfdGh1bWIucG5nIgogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCkgewogICAgZS5leHBvcnRzID0gewogICAgICBuaWNrOiAiTmlja05hbWUiLAogICAgICBtYWlsOiAiRS1NYWlsIiwKICAgICAgbGluazogIldlYnNpdGUoaHR0cDovLykiLAogICAgICBuaWNrRmFpbDogIk5pY2tOYW1lIGNhbm5vdCBiZSBsZXNzIHRoYW4gMyBieXRlcy4iLAogICAgICBtYWlsRmFpbDogIlBsZWFzZSBjb25maXJtIHlvdXIgZW1haWwgYWRkcmVzcy4iLAogICAgICBzb2ZhOiAiTm8gY29tbWVudCB5ZXQuIiwKICAgICAgc3VibWl0OiAiU3VibWl0IiwKICAgICAgcmVwbHk6ICJSZXBseSIsCiAgICAgIGNhbmNlbFJlcGx5OiAiQ2FuY2VsIHJlcGx5IiwKICAgICAgY29tbWVudHM6ICJDb21tZW50cyIsCiAgICAgIGNhbmNlbDogIkNhbmNlbCIsCiAgICAgIGNvbmZpcm06ICJDb25maXJtIiwKICAgICAgImNvbnRpbnVlIjogIkNvbnRpbnVlIiwKICAgICAgbW9yZTogIkxvYWQgTW9yZS4uLiIsCiAgICAgIHByZXZpZXc6ICJQcmV2aWV3IiwKICAgICAgZW1vamk6ICJFbW9qaSIsCiAgICAgIGV4cGFuZDogIlNlZSBtb3JlLi4uLiIsCiAgICAgIHNlY29uZHM6ICJzZWNvbmRzIGFnbyIsCiAgICAgIG1pbnV0ZXM6ICJtaW51dGVzIGFnbyIsCiAgICAgIGhvdXJzOiAiaG91cnMgYWdvIiwKICAgICAgZGF5czogImRheXMgYWdvIiwKICAgICAgbm93OiAianVzdCBub3ciLAogICAgICB1cGxvYWRpbmc6ICJVcGxvYWRpbmcgLi4uIiwKICAgICAgdXBsb2FkRG9uZTogIlVwbG9hZCBjb21wbGV0ZWQhIiwKICAgICAgYnVzeTogIlN1Ym1pdCBpcyBidXN5LCBwbGVhc2Ugd2FpdC4uLiIsCiAgICAgICJjb2RlLTk4IjogIlZhbGluZSBpbml0aWFsaXphdGlvbiBmYWlsZWQsIHBsZWFzZSBjaGVjayB5b3VyIHZlcnNpb24gb2YgYXYtbWluLmpzLiIsCiAgICAgICJjb2RlLTk5IjogIlZhbGluZSBpbml0aWFsaXphdGlvbiBmYWlsZWQsIFBsZWFzZSBjaGVjayB0aGUgYGVsYCBlbGVtZW50IGluIHRoZSBpbml0IG1ldGhvZC4iLAogICAgICAiY29kZS0xMDAiOiAiVmFsaW5lIGluaXRpYWxpemF0aW9uIGZhaWxlZCwgUGxlYXNlIGNoZWNrIHlvdXIgYXBwSWQgYW5kIGFwcEtleS4iLAogICAgICAiY29kZS0xNDAiOiAiVGhlIHRvdGFsIG51bWJlciBvZiBBUEkgY2FsbHMgdG9kYXkgaGFzIGV4Y2VlZGVkIHRoZSBkZXZlbG9wbWVudCB2ZXJzaW9uIGxpbWl0LiIsCiAgICAgICJjb2RlLTQwMSI6ICJVbmF1dGhvcml6ZWQgb3BlcmF0aW9uLCBQbGVhc2UgY2hlY2sgeW91ciBhcHBJZCBhbmQgYXBwS2V5LiIsCiAgICAgICJjb2RlLTQwMyI6ICJBY2Nlc3MgZGVuaWVkIGJ5IEFQSSBkb21haW4gd2hpdGUgbGlzdCwgUGxlYXNlIGNoZWNrIHlvdXIgc2VjdXJpdHkgZG9tYWluLiIKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGUuZXhwb3J0cyA9IHsKICAgICAgbmljazogIuODi+ODg+OCr+ODjeODvOODoCIsCiAgICAgIG1haWw6ICLjg6Hjg7zjg6vjgqLjg4njg6zjgrkiLAogICAgICBsaW5rOiAi44K144Kk44OIKGh0dHA6Ly8pIiwKICAgICAgbmlja0ZhaWw6ICIz44OQ44Kk44OI5Lul5LiK44Gu44OL44OD44Kv44ON44O844Og44KS44GU5YWl5Yqb44GP44Gg44GV44GELiIsCiAgICAgIG1haWxGYWlsOiAi44Oh44O844Or44Ki44OJ44Os44K544KS44GU56K66KqN44GP44Gg44GV44GELiIsCiAgICAgIHNvZmE6ICLjgrPjg6Hjg7Pjg4jjgZfjgb7jgZfjgofjgYZ+IiwKICAgICAgc3VibWl0OiAi5o+Q5Ye644GZ44KLIiwKICAgICAgcmVwbHk6ICLov5Tkv6HjgZnjgosiLAogICAgICBjYW5jZWxSZXBseTogIuOCreODo+ODs+OCu+ODqyIsCiAgICAgIGNvbW1lbnRzOiAi44Kz44Oh44Oz44OIIiwKICAgICAgY2FuY2VsOiAi44Kt44Oj44Oz44K744OrIiwKICAgICAgY29uZmlybTogIueiuuiqjeOBmeOCiyIsCiAgICAgICJjb250aW51ZSI6ICLnu6fnu60iLAogICAgICBtb3JlOiAi44GV44KJ44Gr6Kqt44G/6L6844KALi4uIiwKICAgICAgcHJldmlldzogIuODl+ODrOODk+ODpeODvCIsCiAgICAgIGVtb2ppOiAi57W15paH5a2XIiwKICAgICAgZXhwYW5kOiAi44KC44Gj44Go6KaL44KLIiwKICAgICAgc2Vjb25kczogIuenkuWJjSIsCiAgICAgIG1pbnV0ZXM6ICLliIbliY0iLAogICAgICBob3VyczogIuaZgumWk+WJjSIsCiAgICAgIGRheXM6ICLml6XliY0iLAogICAgICBub3c6ICLjgZ/jgaPjgaDku4oiLAogICAgICB1cGxvYWRpbmc6ICLjgqLjg4Pjg5fjg63jg7zjg4nkuK0uLi4iLAogICAgICB1cGxvYWREb25lOiAi44Ki44OD44OX44Ot44O844OJ44GM5a6M5LqG44GX44G+44GX44GfISIsCiAgICAgIGJ1c3k6ICIyMCDnp5LplpPpmpTjgafmj5Dlh7rjgZfjgabjgY/jgaDjgZXjgYQgICAgLi4uIiwKICAgICAgImNvZGUtOTgiOiAi44Ot44O844OJ44Ko44Op44O844Gn44GZ44CCYXYtbWluLmpzIOOBruODkOODvOOCuOODp+ODs+OCkueiuuiqjeOBl+OBpuOBj+OBoOOBleOBhC4iLAogICAgICAiY29kZS05OSI6ICLjg63jg7zjg4njgqjjg6njg7zjgafjgZnjgIJpbml044Gr44GC44KLYGVsYOOCqOODrOODoeODs+ODiOOCkueiuuiqjeOBj+OBoOOBleOBhC4iLAogICAgICAiY29kZS0xMDAiOiAi44Ot44O844OJ44Ko44Op44O844Gn44GZ44CCQXBwSWTjgahBcHBLZXnjgpLnorroqo3jgY/jgaDjgZXjgYQuIiwKICAgICAgImNvZGUtMTQwIjogIuS7iuaXpeOBrkFQSeOCs+ODvOODq+OBrue3j+aVsOOBjOmWi+eZuuODkOODvOOCuOODp+ODs+OBruS4iumZkOOCkui2heOBiOOBny4iLAogICAgICAiY29kZS00MDEiOiAi5qip6ZmQ44GM5Yi26ZmQ44GV44KM44Gm44GE44G+44GZ44CCQXBwSWTjgahBcHBLZXnjgpLnorroqo3jgY/jgaDjgZXjgYQuIiwKICAgICAgImNvZGUtNDAzIjogIuOCouOCr+OCu+OCueOBjEFQSeOBquOBqeOBq+WItumZkOOBleOCjOOBvuOBl+OBn+OAgeODieODoeOCpOODs+WQjeOBruOCu+OCreODpeODquODhuOCo+ioreWumuOCkueiuuiqjeOBj+OBoOOBleOBhCIKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGUuZXhwb3J0cyA9IHsKICAgICAgbmljazogIuaYteensCIsCiAgICAgIG1haWw6ICLpgq7nrrEiLAogICAgICBsaW5rOiAi572R5Z2AKGh0dHA6Ly8pIiwKICAgICAgbmlja0ZhaWw6ICLmmLXnp7DkuI3og73lsJHkuo4z5Liq5a2X56ymIiwKICAgICAgbWFpbEZhaWw6ICLor7floavlhpnmraPnoa7nmoTpgq7ku7blnLDlnYAiLAogICAgICBzb2ZhOiAi5p2l5Y+R6K+E6K665ZCnfiIsCiAgICAgIHN1Ym1pdDogIuaPkOS6pCIsCiAgICAgIHJlcGx5OiAi5Zue5aSNIiwKICAgICAgY2FuY2VsUmVwbHk6ICLlj5bmtojlm57lpI0iLAogICAgICBjb21tZW50czogIuivhOiuuiIsCiAgICAgIGNhbmNlbDogIuWPlua2iCIsCiAgICAgIGNvbmZpcm06ICLnoa7orqQiLAogICAgICAiY29udGludWUiOiAi57un57utIiwKICAgICAgbW9yZTogIuWKoOi9veabtOWkmi4uLiIsCiAgICAgIHByZXZpZXc6ICLpooTop4giLAogICAgICBlbW9qaTogIuihqOaDhSIsCiAgICAgIGV4cGFuZDogIuafpeeci+abtOWkmi4uLiIsCiAgICAgIHNlY29uZHM6ICLnp5LliY0iLAogICAgICBtaW51dGVzOiAi5YiG6ZKf5YmNIiwKICAgICAgaG91cnM6ICLlsI/ml7bliY0iLAogICAgICBkYXlzOiAi5aSp5YmNIiwKICAgICAgbm93OiAi5Yia5YiaIiwKICAgICAgdXBsb2FkaW5nOiAi5q2j5Zyo5Lyg6L6TLi4uIiwKICAgICAgdXBsb2FkRG9uZTogIuS8oOi+k+WujOaIkCEiLAogICAgICBidXN5OiAi5pON5L2c6aKR57mB77yM6K+356iN5YCZ5YaN6K+VLi4uIiwKICAgICAgImNvZGUtOTgiOiAiVmFsaW5lIOWIneWni+WMluWksei0pe+8jOivt+ajgOafpSBhdi1taW4uanMg54mI5pysIiwKICAgICAgImNvZGUtOTkiOiAiVmFsaW5lIOWIneWni+WMluWksei0pe+8jOivt+ajgOafpWluaXTkuK3nmoRgZWxg5YWD57SgLiIsCiAgICAgICJjb2RlLTEwMCI6ICJWYWxpbmUg5Yid5aeL5YyW5aSx6LSl77yM6K+35qOA5p+l5L2g55qEQXBwSWTlkoxBcHBLZXkuIiwKICAgICAgImNvZGUtMTQwIjogIuS7iuaXpSBBUEkg6LCD55So5oC75qyh5pWw5bey6LaF6L+H5byA5Y+R54mI6ZmQ5Yi2LiIsCiAgICAgICJjb2RlLTQwMSI6ICLmnKrnu4/mjojmnYPnmoTmk43kvZzvvIzor7fmo4Dmn6XkvaDnmoRBcHBJZOWSjEFwcEtleS4iLAogICAgICAiY29kZS00MDMiOiAi6K6/6Zeu6KKrQVBJ5Z+f5ZCN55m95ZCN5Y2V5ouS57ud77yM6K+35qOA5p+l5L2g55qE5a6J5YWo5Z+f5ZCN6K6+572uLiIKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGUuZXhwb3J0cyA9IHsKICAgICAgbmljazogIuaaseeosSIsCiAgICAgIG1haWw6ICLpg7XnrrEiLAogICAgICBsaW5rOiAi57ay5Z2AKGh0dHA6Ly8pIiwKICAgICAgbmlja0ZhaWw6ICLmmLXnqLHkuI3og73lsJHmlrwz5YCL5a2X56ymIiwKICAgICAgbWFpbEZhaWw6ICLoq4vloavlr6vmraPnorrnmoTpg7Xku7blnLDlnYAiLAogICAgICBzb2ZhOiAi5L6G55m86KmV6KuW5ZCnfiIsCiAgICAgIHN1Ym1pdDogIuaPkOS6pCIsCiAgICAgIHJlcGx5OiAi5Zue6KaGIiwKICAgICAgY2FuY2VsUmVwbHk6ICLlj5bmtojlm57opoYiLAogICAgICBjb21tZW50czogIuipleirliIsCiAgICAgIGNhbmNlbDogIuWPlua2iCIsCiAgICAgIGNvbmZpcm06ICLnorroqo0iLAogICAgICAiY29udGludWUiOiAi57m857qMIiwKICAgICAgbW9yZTogIuWKoOi8ieabtOWkmi4uLiIsCiAgICAgIHByZXZpZXc6ICLpoJDopr0iLAogICAgICBlbW9qaTogIuihqOaDhSIsCiAgICAgIGV4cGFuZDogIuafpeeci+abtOWkmi4uLiIsCiAgICAgIHNlY29uZHM6ICLnp5LliY0iLAogICAgICBtaW51dGVzOiAi5YiG6ZCY5YmNIiwKICAgICAgaG91cnM6ICLlsI/mmYLliY0iLAogICAgICBkYXlzOiAi5aSp5YmNIiwKICAgICAgbm93OiAi5Ymb5YmbIiwKICAgICAgdXBsb2FkaW5nOiAi5q2j5Zyo5LiK5YKzLi4uIiwKICAgICAgdXBsb2FkRG9uZTogIuS4iuWCs+WujOaIkCEiLAogICAgICBidXN5OiAi5pON5L2c6aC757mB77yM6KuL56iN5YCZ5YaN6KmmLi4uIiwKICAgICAgImNvZGUtOTgiOiAiVmFsaW5lIOWIneWni+WMluWkseaVl++8jOiri+aqouafpSBhdi1taW4uanMg54mI5pysIiwKICAgICAgImNvZGUtOTkiOiAiVmFsaW5lIOWIneWni+WMluWkseaVl++8jOiri+aqouafpWluaXTkuK3nmoRgZWxg5YWD57SgLiIsCiAgICAgICJjb2RlLTEwMCI6ICJWYWxpbmUg5Yid5aeL5YyW5aSx5pWX77yM6KuL5qqi5p+l5L2g55qEQXBwSWTlkoxBcHBLZXkuIiwKICAgICAgImNvZGUtMTQwIjogIuS7iuaXpSBBUEkg6Kq/55So57i95qyh5pW45bey6LaF6YGO6ZaL55m854mI6ZmQ5Yi2LiIsCiAgICAgICJjb2RlLTQwMSI6ICLmnKrntpPmjojmrIrnmoTmk43kvZzvvIzoq4vmqqLmn6XkvaDnmoRBcHBJZOWSjEFwcEtleS4iLAogICAgICAiY29kZS00MDMiOiAi6Kiq5ZWP6KKrQVBJ5Z+f5ZCN55m95ZCN5Zau5ouS57WV77yM6KuL5qqi5p+l5L2g55qE5a6J5YWo5Z+f5ZCN6Kit572uLiIKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIHZhciByID0gbig1OSk7CiAgICAic3RyaW5nIiA9PSB0eXBlb2YgciAmJiAociA9IFtbZS5pLCByLCAiIl1dKTsKICAgIHZhciBvID0ge307CiAgICBvLnRyYW5zZm9ybSA9IHZvaWQgMDsKICAgIG4oNjEpKHIsIG8pOwogICAgci5sb2NhbHMgJiYgKGUuZXhwb3J0cyA9IHIubG9jYWxzKTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgdCA9IGUuZXhwb3J0cyA9IG4oNjApKCExKSwgdC5wdXNoKFtlLmksICcudltkYXRhLWNsYXNzPXZde2ZvbnQtc2l6ZToxNnB4O3RleHQtYWxpZ246bGVmdH0udltkYXRhLWNsYXNzPXZdICp7LXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7Ym94LXNpemluZzpib3JkZXItYm94O2xpbmUtaGVpZ2h0OjEuNzV9LnZbZGF0YS1jbGFzcz12XSAuc3RhdHVzLWJhciwudltkYXRhLWNsYXNzPXZdIC52ZWRpdG9yLC52W2RhdGEtY2xhc3M9dl0gLnZpbnB1dCwudltkYXRhLWNsYXNzPXZdIHAsLnZbZGF0YS1jbGFzcz12XSBwcmUgY29kZXtjb2xvcjojNTU1fS52W2RhdGEtY2xhc3M9dl0gLnZzeXMsLnZbZGF0YS1jbGFzcz12XSAudnRpbWV7Y29sb3I6I2IzYjNiM30udltkYXRhLWNsYXNzPXZdIC50ZXh0LXJpZ2h0e3RleHQtYWxpZ246cmlnaHR9LnZbZGF0YS1jbGFzcz12XSAudGV4dC1jZW50ZXJ7dGV4dC1hbGlnbjpjZW50ZXJ9LnZbZGF0YS1jbGFzcz12XSBpbWd7bWF4LXdpZHRoOjEwMCU7Ym9yZGVyOm5vbmV9LnZbZGF0YS1jbGFzcz12XSBocnttYXJnaW46LjgyNWVtIDA7Ym9yZGVyLWNvbG9yOiNmNmY2ZjY7Ym9yZGVyLXN0eWxlOmRhc2hlZH0udltkYXRhLWNsYXNzPXZdLmhpZGUtYXZhdGFyIC52aW1ne2Rpc3BsYXk6bm9uZX0udltkYXRhLWNsYXNzPXZdIGF7cG9zaXRpb246cmVsYXRpdmU7Y3Vyc29yOnBvaW50ZXI7Y29sb3I6IzFhYmM5Yzt0ZXh0LWRlY29yYXRpb246bm9uZTtkaXNwbGF5OmlubGluZS1ibG9ja30udltkYXRhLWNsYXNzPXZdIGE6aG92ZXJ7Y29sb3I6I2Q3MTkxYX0udltkYXRhLWNsYXNzPXZdIGNvZGUsLnZbZGF0YS1jbGFzcz12XSBwcmV7YmFja2dyb3VuZC1jb2xvcjojZjhmOGY4O3BhZGRpbmc6LjJlbSAuNGVtO2JvcmRlci1yYWRpdXM6M3B4O2ZvbnQtc2l6ZTo4NSU7bWFyZ2luOjB9LnZbZGF0YS1jbGFzcz12XSBwcmV7cGFkZGluZzoxMHB4O292ZXJmbG93OmF1dG87bGluZS1oZWlnaHQ6MS40NX0udltkYXRhLWNsYXNzPXZdIHByZSBjb2Rle3BhZGRpbmc6MDtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O3doaXRlLXNwYWNlOnByZS13cmFwO3dvcmQtYnJlYWs6a2VlcC1hbGx9LnZbZGF0YS1jbGFzcz12XSBibG9ja3F1b3Rle2NvbG9yOiM2NjY7bWFyZ2luOi41ZW0gMDtwYWRkaW5nOjAgMCAwIDFlbTtib3JkZXItbGVmdDo4cHggc29saWQgaHNsYSgwLDAlLDkzJSwuNSl9LnZbZGF0YS1jbGFzcz12XSAudmlucHV0e2JvcmRlcjpub25lO3Jlc2l6ZTpub25lO291dGxpbmU6bm9uZTtwYWRkaW5nOjEwcHggNXB4O21heC13aWR0aDoxMDAlO2ZvbnQtc2l6ZTouNzc1ZW19LnZbZGF0YS1jbGFzcz12XSBpbnB1dFt0eXBlPWNoZWNrYm94XSwudltkYXRhLWNsYXNzPXZdIGlucHV0W3R5cGU9cmFkaW9de2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTttYXJnaW4tdG9wOi0ycHh9LnZbZGF0YS1jbGFzcz12XSAudmljb257Y3Vyc29yOnBvaW50ZXI7ZGlzcGxheTppbmxpbmUtYmxvY2s7b3ZlcmZsb3c6aGlkZGVuO2ZpbGw6IzU1NTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGV9LnZbZGF0YS1jbGFzcz12XSAudmljb24rLnZpY29ue21hcmdpbi1sZWZ0OjEwcHh9LnZbZGF0YS1jbGFzcz12XSAudmljb24uYWN0aXZlZHtmaWxsOiM2NmIxZmZ9LnZbZGF0YS1jbGFzcz12XSAudnJvd3tmb250LXNpemU6MDtwYWRkaW5nOjEwcHggMH0udltkYXRhLWNsYXNzPXZdIC52cm93IC52Y29se2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtmb250LXNpemU6MTRweH0udltkYXRhLWNsYXNzPXZdIC52cm93IC52Y29sLnZjb2wtMjB7d2lkdGg6MjAlfS52W2RhdGEtY2xhc3M9dl0gLnZyb3cgLnZjb2wudmNvbC0zMHt3aWR0aDozMCV9LnZbZGF0YS1jbGFzcz12XSAudnJvdyAudmNvbC52Y29sLTQwe3dpZHRoOjQwJX0udltkYXRhLWNsYXNzPXZdIC52cm93IC52Y29sLnZjb2wtNTB7d2lkdGg6NTAlfS52W2RhdGEtY2xhc3M9dl0gLnZyb3cgLnZjb2wudmNvbC02MHt3aWR0aDo2MCV9LnZbZGF0YS1jbGFzcz12XSAudnJvdyAudmNvbC52Y29sLTcwe3dpZHRoOjcwJX0udltkYXRhLWNsYXNzPXZdIC52cm93IC52Y29sLnZjb2wtODB7d2lkdGg6ODAlfS52W2RhdGEtY2xhc3M9dl0gLnZyb3cgLnZjb2wudmN0cmx7Zm9udC1zaXplOjEycHh9LnZbZGF0YS1jbGFzcz12XSAuZW1vamksLnZbZGF0YS1jbGFzcz12XSAudmVtb2ppe21heC13aWR0aDoyNXB4O3ZlcnRpY2FsLWFsaWduOm1pZGRsZTttYXJnaW46MCAxcHg7ZGlzcGxheTppbmxpbmUtYmxvY2t9LnZbZGF0YS1jbGFzcz12XSAudndyYXB7Ym9yZGVyOjFweCBzb2xpZCAjZjBmMGYwO2JvcmRlci1yYWRpdXM6NHB4O21hcmdpbi1ib3R0b206MTBweDtvdmVyZmxvdzpoaWRkZW47cG9zaXRpb246cmVsYXRpdmU7cGFkZGluZzoxMHB4fS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIGlucHV0e2JhY2tncm91bmQ6dHJhbnNwYXJlbnR9LnZbZGF0YS1jbGFzcz12XSAudndyYXAgLnZlZGl0e3Bvc2l0aW9uOnJlbGF0aXZlO3BhZGRpbmctdG9wOjEwcHh9LnZbZGF0YS1jbGFzcz12XSAudndyYXAgLmNhbmNlbC1yZXBseS1idG57cG9zaXRpb246YWJzb2x1dGU7cmlnaHQ6NXB4O3RvcDo1cHg7Y3Vyc29yOnBvaW50ZXJ9LnZbZGF0YS1jbGFzcz12XSAudndyYXAgLnZlbW9qaXN7ZGlzcGxheTpub25lO2ZvbnQtc2l6ZToxOHB4O21heC1oZWlnaHQ6MTQ1cHg7b3ZlcmZsb3c6YXV0bztwYWRkaW5nLWJvdHRvbToxMHB4Oy13ZWJraXQtYm94LXNoYWRvdzowIDAgMXB4ICNmMGYwZjA7Ym94LXNoYWRvdzowIDAgMXB4ICNmMGYwZjB9LnZbZGF0YS1jbGFzcz12XSAudndyYXAgLnZlbW9qaXMgaXtmb250LXN0eWxlOm5vcm1hbDtwYWRkaW5nLXRvcDo3cHg7d2lkdGg6MzZweDtjdXJzb3I6cG9pbnRlcjt0ZXh0LWFsaWduOmNlbnRlcjtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjptaWRkbGV9LnZbZGF0YS1jbGFzcz12XSAudndyYXAgLnZwcmV2aWV3e3BhZGRpbmc6N3B4Oy13ZWJraXQtYm94LXNoYWRvdzowIDAgMXB4ICNmMGYwZjA7Ym94LXNoYWRvdzowIDAgMXB4ICNmMGYwZjB9LnZbZGF0YS1jbGFzcz12XSAudndyYXAgLnZoZWFkZXIgLnZpbnB1dHt3aWR0aDozMy4zMyU7Ym9yZGVyLWJvdHRvbToxcHggZGFzaGVkICNkZWRlZGV9LnZbZGF0YS1jbGFzcz12XSAudndyYXAgLnZoZWFkZXIuaXRlbTIgLnZpbnB1dHt3aWR0aDo1MCV9LnZbZGF0YS1jbGFzcz12XSAudndyYXAgLnZoZWFkZXIuaXRlbTEgLnZpbnB1dHt3aWR0aDoxMDAlfS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52aGVhZGVyIC52aW5wdXQ6Zm9jdXN7Ym9yZGVyLWJvdHRvbS1jb2xvcjojZWI1MDU1fUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6NTIwcHgpey52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52aGVhZGVyLml0ZW0yIC52aW5wdXQsLnZbZGF0YS1jbGFzcz12XSAudndyYXAgLnZoZWFkZXIgLnZpbnB1dHt3aWR0aDoxMDAlfX0udltkYXRhLWNsYXNzPXZdIC52cG93ZXJ7Y29sb3I6Izk5OTtmb250LXNpemU6Ljc1ZW07cGFkZGluZzouNWVtIDB9LnZbZGF0YS1jbGFzcz12XSAudnBvd2VyIGF7Zm9udC1zaXplOi43NWVtfS52W2RhdGEtY2xhc3M9dl0gLnZjb3VudHtwYWRkaW5nOjVweDtmb250LXdlaWdodDo2MDA7Zm9udC1zaXplOjEuMjVlbX0udltkYXRhLWNsYXNzPXZdIG9sLC52W2RhdGEtY2xhc3M9dl0gdWx7cGFkZGluZzowO21hcmdpbi1sZWZ0OjEuMjVlbX0udltkYXRhLWNsYXNzPXZdIC50eHQtY2VudGVye3RleHQtYWxpZ246Y2VudGVyfS52W2RhdGEtY2xhc3M9dl0gLnR4dC1yaWdodHt0ZXh0LWFsaWduOnJpZ2h0fS52W2RhdGEtY2xhc3M9dl0gLnBkNXtwYWRkaW5nOjVweH0udltkYXRhLWNsYXNzPXZdIC5wZDEwe3BhZGRpbmc6MTBweH0udltkYXRhLWNsYXNzPXZdIC52ZWRpdG9ye3dpZHRoOjEwMCU7bWluLWhlaWdodDo4Ljc1ZW07Zm9udC1zaXplOi44NzVlbTtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O3Jlc2l6ZTp2ZXJ0aWNhbDstd2Via2l0LXRyYW5zaXRpb246YWxsIC4yNXMgZWFzZTt0cmFuc2l0aW9uOmFsbCAuMjVzIGVhc2V9LnZbZGF0YS1jbGFzcz12XSAudmJ0bnstd2Via2l0LXRyYW5zaXRpb24tZHVyYXRpb246LjRzO3RyYW5zaXRpb24tZHVyYXRpb246LjRzO3RleHQtYWxpZ246Y2VudGVyO2NvbG9yOiM1NTU7Ym9yZGVyOjFweCBzb2xpZCAjZWRlZGVkO2JvcmRlci1yYWRpdXM6LjNlbTtkaXNwbGF5OmlubGluZS1ibG9jaztiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O21hcmdpbi1ib3R0b206MDtmb250LXdlaWdodDo0MDA7dmVydGljYWwtYWxpZ246bWlkZGxlOy1tcy10b3VjaC1hY3Rpb246bWFuaXB1bGF0aW9uO3RvdWNoLWFjdGlvbjptYW5pcHVsYXRpb247Y3Vyc29yOnBvaW50ZXI7d2hpdGUtc3BhY2U6bm93cmFwO3BhZGRpbmc6LjVlbSAxLjI1ZW07Zm9udC1zaXplOi44NzVlbTtsaW5lLWhlaWdodDoxLjQyODU3MTQzOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmU7LW1zLXVzZXItc2VsZWN0Om5vbmU7dXNlci1zZWxlY3Q6bm9uZTtvdXRsaW5lOm5vbmV9LnZbZGF0YS1jbGFzcz12XSAudmJ0bisudmJ0bnttYXJnaW4tbGVmdDoxLjI1ZW19LnZbZGF0YS1jbGFzcz12XSAudmJ0bjphY3RpdmUsLnZbZGF0YS1jbGFzcz12XSAudmJ0bjpob3Zlcntjb2xvcjojMzA5MGU0O2JvcmRlci1jb2xvcjojMzA5MGU0fS52W2RhdGEtY2xhc3M9dl0gLnZidG46ZGlzYWJsZWR7Ym9yZGVyLWNvbG9yOiNlMWUxZTE7Y29sb3I6I2UxZTFlMTtiYWNrZ3JvdW5kLWNvbG9yOiNmZGZhZmE7Y3Vyc29yOm5vdC1hbGxvd2VkfS52W2RhdGEtY2xhc3M9dl0gLnZlbXB0eXtwYWRkaW5nOjEuMjVlbTt0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjojNTU1O292ZXJmbG93OmF1dG99LnZbZGF0YS1jbGFzcz12XSAudnN5c3tkaXNwbGF5OmlubGluZS1ibG9jaztwYWRkaW5nOi4yZW0gLjVlbTtmb250LXNpemU6Ljc1ZW07Ym9yZGVyLXJhZGl1czouMmVtO21hcmdpbi1yaWdodDouM2VtfUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6NTIwcHgpey52W2RhdGEtY2xhc3M9dl0gLnZzeXN7ZGlzcGxheTpub25lfX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHN7d2lkdGg6MTAwJX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJke3BhZGRpbmctdG9wOjEuMjVlbTtwb3NpdGlvbjpyZWxhdGl2ZTtkaXNwbGF5OmJsb2NrfS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQ6YWZ0ZXJ7Y29udGVudDoiIjtjbGVhcjpib3RoO2Rpc3BsYXk6YmxvY2t9LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmltZ3t3aWR0aDozLjEyNWVtO2hlaWdodDozLjEyNWVtO2Zsb2F0OmxlZnQ7Ym9yZGVyLXJhZGl1czo1MCU7bWFyZ2luLXJpZ2h0Oi43NTI1ZW07Ym9yZGVyOjFweCBzb2xpZCAjZjVmNWY1O3BhZGRpbmc6LjEyNWVtfUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6NzIwcHgpey52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZpbWd7d2lkdGg6Mi41ZW07aGVpZ2h0OjIuNWVtfX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52aGVhZHtsaW5lLWhlaWdodDoxLjU7bWFyZ2luLXRvcDowfS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZoZWFkIC52bmlja3twb3NpdGlvbjpyZWxhdGl2ZTtmb250LXNpemU6Ljg3NWVtO2ZvbnQtd2VpZ2h0OjUwMDttYXJnaW4tcmlnaHQ6Ljg3NWVtO2N1cnNvcjpwb2ludGVyO3RleHQtZGVjb3JhdGlvbjpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrfS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZoZWFkIC52bmljazpob3Zlcntjb2xvcjojZDcxOTFhfS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZoe292ZXJmbG93OmhpZGRlbjtwYWRkaW5nLWJvdHRvbTouNWVtO2JvcmRlci1ib3R0b206MXB4IGRhc2hlZCAjZjVmNWY1fS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZoIC52dGltZXtmb250LXNpemU6Ljc1ZW07bWFyZ2luLXJpZ2h0Oi44NzVlbX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52aCAudm1ldGF7bGluZS1oZWlnaHQ6MTtwb3NpdGlvbjpyZWxhdGl2ZX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52aCAudm1ldGEgLnZhdHtmb250LXNpemU6LjgxMjVlbTtjb2xvcjojZWYyZjExO2N1cnNvcjpwb2ludGVyO2Zsb2F0OnJpZ2h0fS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQ6bGFzdC1jaGlsZCAudmh7Ym9yZGVyLWJvdHRvbTpub25lfS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZjb250ZW50e3dvcmQtd3JhcDpicmVhay13b3JkO3dvcmQtYnJlYWs6YnJlYWstYWxsO2ZvbnQtc2l6ZTouODc1ZW07bGluZS1oZWlnaHQ6Mjtwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW4tYm90dG9tOi43NWVtO3BhZGRpbmctdG9wOi42MjVlbX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmR7Y3Vyc29yOnBvaW50ZXI7bWF4LWhlaWdodDo4ZW07b3ZlcmZsb3c6aGlkZGVufS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZjb250ZW50LmV4cGFuZDpiZWZvcmV7ZGlzcGxheTpibG9jaztjb250ZW50OiIiO3Bvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEwMCU7bGVmdDowO3RvcDowO2JvdHRvbTozLjE1ZW07YmFja2dyb3VuZDotd2Via2l0LWdyYWRpZW50KGxpbmVhcixsZWZ0IHRvcCxsZWZ0IGJvdHRvbSxmcm9tKGhzbGEoMCwwJSwxMDAlLDApKSx0byhoc2xhKDAsMCUsMTAwJSwuOSkpKTtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxODBkZWcsaHNsYSgwLDAlLDEwMCUsMCksaHNsYSgwLDAlLDEwMCUsLjkpKTt6LWluZGV4Ojk5OX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YWZ0ZXJ7ZGlzcGxheTpibG9jaztjb250ZW50OmF0dHIoZGF0YS1leHBhbmQpO3RleHQtYWxpZ246Y2VudGVyO2NvbG9yOiM4Mjg1ODY7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwJTtoZWlnaHQ6My4xNWVtO2xpbmUtaGVpZ2h0OjMuMTVlbTtsZWZ0OjA7Ym90dG9tOjA7ei1pbmRleDo5OTk7YmFja2dyb3VuZDpoc2xhKDAsMCUsMTAwJSwuOSl9LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudnF1b3Rle3BhZGRpbmctbGVmdDoxZW07Ym9yZGVyLWxlZnQ6MXB4IGRhc2hlZCBoc2xhKDAsMCUsOTMlLC41KX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52cXVvdGUgLnZpbWd7d2lkdGg6Mi4yMjVlbTtoZWlnaHQ6Mi4yMjVlbX0udltkYXRhLWNsYXNzPXZdIC52cGFnZSAudm1vcmV7bWFyZ2luOjFlbSAwfS52W2RhdGEtY2xhc3M9dl0gLmNsZWFye2NvbnRlbnQ6IiI7ZGlzcGxheTpibG9jaztjbGVhcjpib3RofUAtd2Via2l0LWtleWZyYW1lcyBzcGluezAley13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgwZGVnKTt0cmFuc2Zvcm06cm90YXRlKDBkZWcpfXRvey13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgxdHVybik7dHJhbnNmb3JtOnJvdGF0ZSgxdHVybil9fUBrZXlmcmFtZXMgc3BpbnswJXstd2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoMGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgwZGVnKX10b3std2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoMXR1cm4pO3RyYW5zZm9ybTpyb3RhdGUoMXR1cm4pfX1ALXdlYmtpdC1rZXlmcmFtZXMgcHVsc2V7NTAle2JhY2tncm91bmQ6I2RjZGNkY319QGtleWZyYW1lcyBwdWxzZXs1MCV7YmFja2dyb3VuZDojZGNkY2RjfX0udltkYXRhLWNsYXNzPXZdIC52c3Bpbm5lcnt3aWR0aDoyMnB4O2hlaWdodDoyMnB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO2JvcmRlcjo2cHggZG91YmxlICNhMGEwYTA7Ym9yZGVyLXRvcC1jb2xvcjp0cmFuc3BhcmVudDtib3JkZXItYm90dG9tLWNvbG9yOnRyYW5zcGFyZW50O2JvcmRlci1yYWRpdXM6NTAlOy13ZWJraXQtYW5pbWF0aW9uOnNwaW4gMXMgaW5maW5pdGUgbGluZWFyO2FuaW1hdGlvbjpzcGluIDFzIGluZmluaXRlIGxpbmVhcjtwb3NpdGlvbjpyZWxhdGl2ZTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7bWFyZ2luOjAgNXB4fS5kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnN0YXR1cy1iYXIsLmRhcmsgLnZbZGF0YS1jbGFzcz12XSAudmVkaXRvciwuZGFyayAudltkYXRhLWNsYXNzPXZdIC52aW5wdXQsLmRhcmsgLnZbZGF0YS1jbGFzcz12XSBwLC5kYXJrIC52W2RhdGEtY2xhc3M9dl0gcHJlIGNvZGUsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gLnN0YXR1cy1iYXIsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gLnZlZGl0b3IsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gLnZpbnB1dCwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSBwLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIHByZSBjb2RlLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIC5zdGF0dXMtYmFyLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIC52ZWRpdG9yLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIC52aW5wdXQsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gcCwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSBwcmUgY29kZSxbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIC5zdGF0dXMtYmFyLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gLnZlZGl0b3IsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSAudmlucHV0LFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gcCxbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIHByZSBjb2Rle2NvbG9yOiNiMmIyYjV9LmRhcmsgLnZbZGF0YS1jbGFzcz12XSAudnN5cywuZGFyayAudltkYXRhLWNsYXNzPXZdIC52dGltZSwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSAudnN5cywubmlnaHQgLnZbZGF0YS1jbGFzcz12XSAudnRpbWUsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZzeXMsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZ0aW1lLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gLnZzeXMsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSAudnRpbWV7Y29sb3I6IzkyOTI5OH0uZGFyayAudltkYXRhLWNsYXNzPXZdIGNvZGUsLmRhcmsgLnZbZGF0YS1jbGFzcz12XSBwcmUsLmRhcmsgLnZbZGF0YS1jbGFzcz12XSBwcmUgY29kZSwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSBjb2RlLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIHByZSwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSBwcmUgY29kZSwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSBjb2RlLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIHByZSwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSBwcmUgY29kZSxbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIGNvZGUsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSBwcmUsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSBwcmUgY29kZXtjb2xvcjojOTI5Mjk4O2JhY2tncm91bmQtY29sb3I6IzE1MTQxNH0uZGFyayAudltkYXRhLWNsYXNzPXZdIC52d3JhcCwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSAudndyYXAsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwe2JvcmRlci1jb2xvcjojYjJiMmI1fS5kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZpY29uLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIC52aWNvbiwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSAudmljb24sW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSAudmljb257ZmlsbDojYjJiMmI1fS5kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZpY29uLmFjdGl2ZWQsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gLnZpY29uLmFjdGl2ZWQsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZpY29uLmFjdGl2ZWQsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSAudmljb24uYWN0aXZlZHtmaWxsOiM2NmIxZmZ9LmRhcmsgLnZbZGF0YS1jbGFzcz12XSAudmJ0biwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSAudmJ0biwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSAudmJ0bixbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIC52YnRue2NvbG9yOiNiMmIyYjU7Ym9yZGVyLWNvbG9yOiNiMmIyYjV9LmRhcmsgLnZbZGF0YS1jbGFzcz12XSAudmJ0bjpob3ZlciwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSAudmJ0bjpob3ZlciwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSAudmJ0bjpob3ZlcixbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIC52YnRuOmhvdmVye2NvbG9yOiM2NmIxZmY7Ym9yZGVyLWNvbG9yOiM2NmIxZmZ9LmRhcmsgLnZbZGF0YS1jbGFzcz12XSBhOmhvdmVyLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIGE6aG92ZXIsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gYTpob3ZlcixbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIGE6aG92ZXJ7Y29sb3I6I2Q3MTkxYX0uZGFyayAudltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YmVmb3JlLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YmVmb3JlLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YmVmb3JlLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZjb250ZW50LmV4cGFuZDpiZWZvcmV7YmFja2dyb3VuZDotd2Via2l0LWdyYWRpZW50KGxpbmVhcixsZWZ0IHRvcCxsZWZ0IGJvdHRvbSxmcm9tKHJnYmEoMCwwLDAsLjMpKSx0byhyZ2JhKDAsMCwwLC43KSkpO2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZyxyZ2JhKDAsMCwwLC4zKSxyZ2JhKDAsMCwwLC43KSl9LmRhcmsgLnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5kOmFmdGVyLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YWZ0ZXIsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZjb250ZW50LmV4cGFuZDphZnRlcixbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YWZ0ZXJ7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLC43KX1AbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOmRhcmspey52W2RhdGEtY2xhc3M9dl0gLnN0YXR1cy1iYXIsLnZbZGF0YS1jbGFzcz12XSAudmVkaXRvciwudltkYXRhLWNsYXNzPXZdIC52aW5wdXQsLnZbZGF0YS1jbGFzcz12XSBwLC52W2RhdGEtY2xhc3M9dl0gcHJlIGNvZGV7Y29sb3I6I2IyYjJiNX0udltkYXRhLWNsYXNzPXZdIC52c3lzLC52W2RhdGEtY2xhc3M9dl0gLnZ0aW1le2NvbG9yOiM5MjkyOTh9LnZbZGF0YS1jbGFzcz12XSBjb2RlLC52W2RhdGEtY2xhc3M9dl0gcHJlLC52W2RhdGEtY2xhc3M9dl0gcHJlIGNvZGV7Y29sb3I6IzkyOTI5ODtiYWNrZ3JvdW5kLWNvbG9yOiMxNTE0MTR9LnZbZGF0YS1jbGFzcz12XSAudndyYXB7Ym9yZGVyLWNvbG9yOiNiMmIyYjV9LnZbZGF0YS1jbGFzcz12XSAudmljb257ZmlsbDojYjJiMmI1fS52W2RhdGEtY2xhc3M9dl0gLnZpY29uLmFjdGl2ZWR7ZmlsbDojNjZiMWZmfS52W2RhdGEtY2xhc3M9dl0gLnZidG57Y29sb3I6I2IyYjJiNTtib3JkZXItY29sb3I6I2IyYjJiNX0udltkYXRhLWNsYXNzPXZdIC52YnRuOmhvdmVye2NvbG9yOiM2NmIxZmY7Ym9yZGVyLWNvbG9yOiM2NmIxZmZ9LnZbZGF0YS1jbGFzcz12XSBhOmhvdmVye2NvbG9yOiNkNzE5MWF9LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5kOmJlZm9yZXtiYWNrZ3JvdW5kOi13ZWJraXQtZ3JhZGllbnQobGluZWFyLGxlZnQgdG9wLGxlZnQgYm90dG9tLGZyb20ocmdiYSgwLDAsMCwuMykpLHRvKHJnYmEoMCwwLDAsLjcpKSk7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTgwZGVnLHJnYmEoMCwwLDAsLjMpLHJnYmEoMCwwLDAsLjcpKX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YWZ0ZXJ7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLC43KX19JywgIiJdKTsKICB9LCBmdW5jdGlvbiAoZSwgdCkgewogICAgZnVuY3Rpb24gbihlLCB0KSB7CiAgICAgIHZhciBuID0gZVsxXSB8fCAiIiwKICAgICAgICAgIG8gPSBlWzNdOwogICAgICBpZiAoIW8pIHJldHVybiBuOwoKICAgICAgaWYgKHQgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgYnRvYSkgewogICAgICAgIHZhciBpID0gcihvKTsKICAgICAgICByZXR1cm4gW25dLmNvbmNhdChvLnNvdXJjZXMubWFwKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gIi8qIyBzb3VyY2VVUkw9IiArIG8uc291cmNlUm9vdCArIGUgKyAiICovIjsKICAgICAgICB9KSkuY29uY2F0KFtpXSkuam9pbigiXG4iKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFtuXS5qb2luKCJcbiIpOwogICAgfQoKICAgIGZ1bmN0aW9uIHIoZSkgewogICAgICByZXR1cm4gIi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoZSkpKSkgKyAiICovIjsKICAgIH0KCiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdCA9IFtdOwogICAgICByZXR1cm4gdC50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHZhciByID0gbih0LCBlKTsKICAgICAgICAgIHJldHVybiB0WzJdID8gIkBtZWRpYSAiICsgdFsyXSArICJ7IiArIHIgKyAifSIgOiByOwogICAgICAgIH0pLmpvaW4oIiIpOwogICAgICB9LCB0LmkgPSBmdW5jdGlvbiAoZSwgbikgewogICAgICAgICJzdHJpbmciID09IHR5cGVvZiBlICYmIChlID0gW1tudWxsLCBlLCAiIl1dKTsKCiAgICAgICAgZm9yICh2YXIgciA9IHt9LCBvID0gMDsgbyA8IHRoaXMubGVuZ3RoOyBvKyspIHsKICAgICAgICAgIHZhciBpID0gdGhpc1tvXVswXTsKICAgICAgICAgICJudW1iZXIiID09IHR5cGVvZiBpICYmIChyW2ldID0gITApOwogICAgICAgIH0KCiAgICAgICAgZm9yIChvID0gMDsgbyA8IGUubGVuZ3RoOyBvKyspIHsKICAgICAgICAgIHZhciBhID0gZVtvXTsKICAgICAgICAgICJudW1iZXIiID09IHR5cGVvZiBhWzBdICYmIHJbYVswXV0gfHwgKG4gJiYgIWFbMl0gPyBhWzJdID0gbiA6IG4gJiYgKGFbMl0gPSAiKCIgKyBhWzJdICsgIikgYW5kICgiICsgbiArICIpIiksIHQucHVzaChhKSk7CiAgICAgICAgfQogICAgICB9LCB0OwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgZnVuY3Rpb24gcihlLCB0KSB7CiAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICAgIHZhciByID0gZVtuXSwKICAgICAgICAgICAgbyA9IGhbci5pZF07CgogICAgICAgIGlmIChvKSB7CiAgICAgICAgICBvLnJlZnMrKzsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG8ucGFydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgby5wYXJ0c1tpXShyLnBhcnRzW2ldKTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKDsgaSA8IHIucGFydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgby5wYXJ0cy5wdXNoKHUoci5wYXJ0c1tpXSwgdCkpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmb3IgKHZhciBhID0gW10sIGkgPSAwOyBpIDwgci5wYXJ0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBhLnB1c2godShyLnBhcnRzW2ldLCB0KSk7CiAgICAgICAgICB9CgogICAgICAgICAgaFtyLmlkXSA9IHsKICAgICAgICAgICAgaWQ6IHIuaWQsCiAgICAgICAgICAgIHJlZnM6IDEsCiAgICAgICAgICAgIHBhcnRzOiBhCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIG8oZSwgdCkgewogICAgICBmb3IgKHZhciBuID0gW10sIHIgPSB7fSwgbyA9IDA7IG8gPCBlLmxlbmd0aDsgbysrKSB7CiAgICAgICAgdmFyIGkgPSBlW29dLAogICAgICAgICAgICBhID0gdC5iYXNlID8gaVswXSArIHQuYmFzZSA6IGlbMF0sCiAgICAgICAgICAgIHMgPSBpWzFdLAogICAgICAgICAgICBsID0gaVsyXSwKICAgICAgICAgICAgYyA9IGlbM10sCiAgICAgICAgICAgIHUgPSB7CiAgICAgICAgICBjc3M6IHMsCiAgICAgICAgICBtZWRpYTogbCwKICAgICAgICAgIHNvdXJjZU1hcDogYwogICAgICAgIH07CiAgICAgICAgclthXSA/IHJbYV0ucGFydHMucHVzaCh1KSA6IG4ucHVzaChyW2FdID0gewogICAgICAgICAgaWQ6IGEsCiAgICAgICAgICBwYXJ0czogW3VdCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfQoKICAgIGZ1bmN0aW9uIGkoZSwgdCkgewogICAgICB2YXIgbiA9IGcoZS5pbnNlcnRJbnRvKTsKICAgICAgaWYgKCFuKSB0aHJvdyBuZXcgRXJyb3IoIkNvdWxkbid0IGZpbmQgYSBzdHlsZSB0YXJnZXQuIFRoaXMgcHJvYmFibHkgbWVhbnMgdGhhdCB0aGUgdmFsdWUgZm9yIHRoZSAnaW5zZXJ0SW50bycgcGFyYW1ldGVyIGlzIGludmFsaWQuIik7CiAgICAgIHZhciByID0gYltiLmxlbmd0aCAtIDFdOwogICAgICBpZiAoInRvcCIgPT09IGUuaW5zZXJ0QXQpIHIgPyByLm5leHRTaWJsaW5nID8gbi5pbnNlcnRCZWZvcmUodCwgci5uZXh0U2libGluZykgOiBuLmFwcGVuZENoaWxkKHQpIDogbi5pbnNlcnRCZWZvcmUodCwgbi5maXJzdENoaWxkKSwgYi5wdXNoKHQpO2Vsc2UgewogICAgICAgIGlmICgiYm90dG9tIiAhPT0gZS5pbnNlcnRBdCkgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHZhbHVlIGZvciBwYXJhbWV0ZXIgJ2luc2VydEF0Jy4gTXVzdCBiZSAndG9wJyBvciAnYm90dG9tJy4iKTsKICAgICAgICBuLmFwcGVuZENoaWxkKHQpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYShlKSB7CiAgICAgIGlmIChudWxsID09PSBlLnBhcmVudE5vZGUpIHJldHVybiAhMTsKICAgICAgZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGUpOwogICAgICB2YXIgdCA9IGIuaW5kZXhPZihlKTsKICAgICAgdCA+PSAwICYmIGIuc3BsaWNlKHQsIDEpOwogICAgfQoKICAgIGZ1bmN0aW9uIHMoZSkgewogICAgICB2YXIgdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7CiAgICAgIHJldHVybiBlLmF0dHJzLnR5cGUgPSAidGV4dC9jc3MiLCBjKHQsIGUuYXR0cnMpLCBpKGUsIHQpLCB0OwogICAgfQoKICAgIGZ1bmN0aW9uIGwoZSkgewogICAgICB2YXIgdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpbmsiKTsKICAgICAgcmV0dXJuIGUuYXR0cnMudHlwZSA9ICJ0ZXh0L2NzcyIsIGUuYXR0cnMucmVsID0gInN0eWxlc2hlZXQiLCBjKHQsIGUuYXR0cnMpLCBpKGUsIHQpLCB0OwogICAgfQoKICAgIGZ1bmN0aW9uIGMoZSwgdCkgewogICAgICBPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7CiAgICAgICAgZS5zZXRBdHRyaWJ1dGUobiwgdFtuXSk7CiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIHUoZSwgdCkgewogICAgICB2YXIgbiwgciwgbywgaTsKCiAgICAgIGlmICh0LnRyYW5zZm9ybSAmJiBlLmNzcykgewogICAgICAgIGlmICghKGkgPSB0LnRyYW5zZm9ybShlLmNzcykpKSByZXR1cm4gZnVuY3Rpb24gKCkge307CiAgICAgICAgZS5jc3MgPSBpOwogICAgICB9CgogICAgICBpZiAodC5zaW5nbGV0b24pIHsKICAgICAgICB2YXIgYyA9IHkrKzsKICAgICAgICBuID0gbSB8fCAobSA9IHModCkpLCByID0gZC5iaW5kKG51bGwsIG4sIGMsICExKSwgbyA9IGQuYmluZChudWxsLCBuLCBjLCAhMCk7CiAgICAgIH0gZWxzZSBlLnNvdXJjZU1hcCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBVUkwgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgVVJMLmNyZWF0ZU9iamVjdFVSTCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBVUkwucmV2b2tlT2JqZWN0VVJMICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIEJsb2IgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgYnRvYSA/IChuID0gbCh0KSwgciA9IGYuYmluZChudWxsLCBuLCB0KSwgbyA9IGZ1bmN0aW9uIG8oKSB7CiAgICAgICAgYShuKSwgbi5ocmVmICYmIFVSTC5yZXZva2VPYmplY3RVUkwobi5ocmVmKTsKICAgICAgfSkgOiAobiA9IHModCksIHIgPSBwLmJpbmQobnVsbCwgbiksIG8gPSBmdW5jdGlvbiBvKCkgewogICAgICAgIGEobik7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHIoZSksIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgaWYgKHQpIHsKICAgICAgICAgIGlmICh0LmNzcyA9PT0gZS5jc3MgJiYgdC5tZWRpYSA9PT0gZS5tZWRpYSAmJiB0LnNvdXJjZU1hcCA9PT0gZS5zb3VyY2VNYXApIHJldHVybjsKICAgICAgICAgIHIoZSA9IHQpOwogICAgICAgIH0gZWxzZSBvKCk7CiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gZChlLCB0LCBuLCByKSB7CiAgICAgIHZhciBvID0gbiA/ICIiIDogci5jc3M7CiAgICAgIGlmIChlLnN0eWxlU2hlZXQpIGUuc3R5bGVTaGVldC5jc3NUZXh0ID0geCh0LCBvKTtlbHNlIHsKICAgICAgICB2YXIgaSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG8pLAogICAgICAgICAgICBhID0gZS5jaGlsZE5vZGVzOwogICAgICAgIGFbdF0gJiYgZS5yZW1vdmVDaGlsZChhW3RdKSwgYS5sZW5ndGggPyBlLmluc2VydEJlZm9yZShpLCBhW3RdKSA6IGUuYXBwZW5kQ2hpbGQoaSk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBwKGUsIHQpIHsKICAgICAgdmFyIG4gPSB0LmNzcywKICAgICAgICAgIHIgPSB0Lm1lZGlhOwogICAgICBpZiAociAmJiBlLnNldEF0dHJpYnV0ZSgibWVkaWEiLCByKSwgZS5zdHlsZVNoZWV0KSBlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IG47ZWxzZSB7CiAgICAgICAgZm9yICg7IGUuZmlyc3RDaGlsZDspIHsKICAgICAgICAgIGUucmVtb3ZlQ2hpbGQoZS5maXJzdENoaWxkKTsKICAgICAgICB9CgogICAgICAgIGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobikpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZihlLCB0LCBuKSB7CiAgICAgIHZhciByID0gbi5jc3MsCiAgICAgICAgICBvID0gbi5zb3VyY2VNYXAsCiAgICAgICAgICBpID0gdm9pZCAwID09PSB0LmNvbnZlcnRUb0Fic29sdXRlVXJscyAmJiBvOwogICAgICAodC5jb252ZXJ0VG9BYnNvbHV0ZVVybHMgfHwgaSkgJiYgKHIgPSB3KHIpKSwgbyAmJiAociArPSAiXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LCIgKyBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShvKSkpKSArICIgKi8iKTsKICAgICAgdmFyIGEgPSBuZXcgQmxvYihbcl0sIHsKICAgICAgICB0eXBlOiAidGV4dC9jc3MiCiAgICAgIH0pLAogICAgICAgICAgcyA9IGUuaHJlZjsKICAgICAgZS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChhKSwgcyAmJiBVUkwucmV2b2tlT2JqZWN0VVJMKHMpOwogICAgfQoKICAgIHZhciBoID0ge30sCiAgICAgICAgdiA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB0OwogICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB2b2lkIDAgPT09IHQgJiYgKHQgPSBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpLCB0OwogICAgICB9OwogICAgfShmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB3aW5kb3cgJiYgZG9jdW1lbnQgJiYgZG9jdW1lbnQuYWxsICYmICF3aW5kb3cuYXRvYjsKICAgIH0pLAogICAgICAgIGcgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdCA9IHt9OwogICAgICByZXR1cm4gZnVuY3Rpb24gKG4pIHsKICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0W25dICYmICh0W25dID0gZS5jYWxsKHRoaXMsIG4pKSwgdFtuXTsKICAgICAgfTsKICAgIH0oZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZSk7CiAgICB9KSwKICAgICAgICBtID0gbnVsbCwKICAgICAgICB5ID0gMCwKICAgICAgICBiID0gW10sCiAgICAgICAgdyA9IG4oNjIpOwoKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIGlmICgidW5kZWZpbmVkIiAhPSB0eXBlb2YgREVCVUcgJiYgREVCVUcgJiYgIm9iamVjdCIgIT0gKHR5cGVvZiBkb2N1bWVudCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZG9jdW1lbnQpKSkgdGhyb3cgbmV3IEVycm9yKCJUaGUgc3R5bGUtbG9hZGVyIGNhbm5vdCBiZSB1c2VkIGluIGEgbm9uLWJyb3dzZXIgZW52aXJvbm1lbnQiKTsKICAgICAgdCA9IHQgfHwge30sIHQuYXR0cnMgPSAib2JqZWN0IiA9PSBfdHlwZW9mKHQuYXR0cnMpID8gdC5hdHRycyA6IHt9LCB0LnNpbmdsZXRvbiB8fCAodC5zaW5nbGV0b24gPSB2KCkpLCB0Lmluc2VydEludG8gfHwgKHQuaW5zZXJ0SW50byA9ICJoZWFkIiksIHQuaW5zZXJ0QXQgfHwgKHQuaW5zZXJ0QXQgPSAiYm90dG9tIik7CiAgICAgIHZhciBuID0gbyhlLCB0KTsKICAgICAgcmV0dXJuIHIobiwgdCksIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IFtdLCBhID0gMDsgYSA8IG4ubGVuZ3RoOyBhKyspIHsKICAgICAgICAgIHZhciBzID0gblthXSwKICAgICAgICAgICAgICBsID0gaFtzLmlkXTsKICAgICAgICAgIGwucmVmcy0tLCBpLnB1c2gobCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoZSkgewogICAgICAgICAgcihvKGUsIHQpLCB0KTsKICAgICAgICB9CgogICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgaS5sZW5ndGg7IGErKykgewogICAgICAgICAgdmFyIGwgPSBpW2FdOwoKICAgICAgICAgIGlmICgwID09PSBsLnJlZnMpIHsKICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBsLnBhcnRzLmxlbmd0aDsgYysrKSB7CiAgICAgICAgICAgICAgbC5wYXJ0c1tjXSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkZWxldGUgaFtsLmlkXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICB9OwoKICAgIHZhciB4ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgZSA9IFtdOwogICAgICByZXR1cm4gZnVuY3Rpb24gKHQsIG4pIHsKICAgICAgICByZXR1cm4gZVt0XSA9IG4sIGUuZmlsdGVyKEJvb2xlYW4pLmpvaW4oIlxuIik7CiAgICAgIH07CiAgICB9KCk7CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB0ID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cubG9jYXRpb247CiAgICAgIGlmICghdCkgdGhyb3cgbmV3IEVycm9yKCJmaXhVcmxzIHJlcXVpcmVzIHdpbmRvdy5sb2NhdGlvbiIpOwogICAgICBpZiAoIWUgfHwgInN0cmluZyIgIT0gdHlwZW9mIGUpIHJldHVybiBlOwogICAgICB2YXIgbiA9IHQucHJvdG9jb2wgKyAiLy8iICsgdC5ob3N0LAogICAgICAgICAgciA9IG4gKyB0LnBhdGhuYW1lLnJlcGxhY2UoL1wvW15cL10qJC8sICIvIik7CiAgICAgIHJldHVybiBlLnJlcGxhY2UoL3VybFxzKlwoKCg/OlteKShdfFwoKD86W14pKF0rfFwoW14pKF0qXCkpKlwpKSopXCkvZ2ksIGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgdmFyIG8gPSB0LnRyaW0oKS5yZXBsYWNlKC9eIiguKikiJC8sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgICByZXR1cm4gdDsKICAgICAgICB9KS5yZXBsYWNlKC9eJyguKiknJC8sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgICByZXR1cm4gdDsKICAgICAgICB9KTsKICAgICAgICBpZiAoL14oI3xkYXRhOnxodHRwOlwvXC98aHR0cHM6XC9cL3xmaWxlOlwvXC9cLykvaS50ZXN0KG8pKSByZXR1cm4gZTsKICAgICAgICB2YXIgaTsKICAgICAgICByZXR1cm4gaSA9IDAgPT09IG8uaW5kZXhPZigiLy8iKSA/IG8gOiAwID09PSBvLmluZGV4T2YoIi8iKSA/IG4gKyBvIDogciArIG8ucmVwbGFjZSgvXlwuXC8vLCAiIiksICJ1cmwoIiArIEpTT04uc3RyaW5naWZ5KGkpICsgIikiOwogICAgICB9KTsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIG4oNTgpLCBlLmV4cG9ydHMgPSBuKDE4KTsKICB9XSk7Cn0pOw=="},null]}