{"remainingRequest":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\babel-loader\\lib\\index.js??ref--3-1!D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\follow-redirects\\index.js","dependencies":[{"path":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\follow-redirects\\index.js","mtime":499162500000},{"path":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90eXBlb2YgPSByZXF1aXJlKCJEOi92c2NvZGVwcm9qZWN0cy92dWVwcmVzcy10aGVtZS1yZWNvL215YmxvZ3Mvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mIilbImRlZmF1bHQiXTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuY3JlYXRlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2guanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIudGltZXJzLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0eS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluZGV4LW9mLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc2VhcmNoLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0aWVzLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnN0YXJ0cy13aXRoLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7Cgp2YXIgdXJsID0gcmVxdWlyZSgidXJsIik7Cgp2YXIgVVJMID0gdXJsLlVSTDsKCnZhciBodHRwID0gcmVxdWlyZSgiaHR0cCIpOwoKdmFyIGh0dHBzID0gcmVxdWlyZSgiaHR0cHMiKTsKCnZhciBXcml0YWJsZSA9IHJlcXVpcmUoInN0cmVhbSIpLldyaXRhYmxlOwoKdmFyIGFzc2VydCA9IHJlcXVpcmUoImFzc2VydCIpOwoKdmFyIGRlYnVnID0gcmVxdWlyZSgiLi9kZWJ1ZyIpOyAvLyBDcmVhdGUgaGFuZGxlcnMgdGhhdCBwYXNzIGV2ZW50cyBmcm9tIG5hdGl2ZSByZXF1ZXN0cwoKCnZhciBldmVudHMgPSBbImFib3J0IiwgImFib3J0ZWQiLCAiY29ubmVjdCIsICJlcnJvciIsICJzb2NrZXQiLCAidGltZW91dCJdOwp2YXIgZXZlbnRIYW5kbGVycyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CmV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkgewogIGV2ZW50SGFuZGxlcnNbZXZlbnRdID0gZnVuY3Rpb24gKGFyZzEsIGFyZzIsIGFyZzMpIHsKICAgIHRoaXMuX3JlZGlyZWN0YWJsZS5lbWl0KGV2ZW50LCBhcmcxLCBhcmcyLCBhcmczKTsKICB9Owp9KTsgLy8gRXJyb3IgdHlwZXMgd2l0aCBjb2RlcwoKdmFyIFJlZGlyZWN0aW9uRXJyb3IgPSBjcmVhdGVFcnJvclR5cGUoIkVSUl9GUl9SRURJUkVDVElPTl9GQUlMVVJFIiwgIiIpOwp2YXIgVG9vTWFueVJlZGlyZWN0c0Vycm9yID0gY3JlYXRlRXJyb3JUeXBlKCJFUlJfRlJfVE9PX01BTllfUkVESVJFQ1RTIiwgIk1heGltdW0gbnVtYmVyIG9mIHJlZGlyZWN0cyBleGNlZWRlZCIpOwp2YXIgTWF4Qm9keUxlbmd0aEV4Y2VlZGVkRXJyb3IgPSBjcmVhdGVFcnJvclR5cGUoIkVSUl9GUl9NQVhfQk9EWV9MRU5HVEhfRVhDRUVERUQiLCAiUmVxdWVzdCBib2R5IGxhcmdlciB0aGFuIG1heEJvZHlMZW5ndGggbGltaXQiKTsKdmFyIFdyaXRlQWZ0ZXJFbmRFcnJvciA9IGNyZWF0ZUVycm9yVHlwZSgiRVJSX1NUUkVBTV9XUklURV9BRlRFUl9FTkQiLCAid3JpdGUgYWZ0ZXIgZW5kIik7IC8vIEFuIEhUVFAoUykgcmVxdWVzdCB0aGF0IGNhbiBiZSByZWRpcmVjdGVkCgpmdW5jdGlvbiBSZWRpcmVjdGFibGVSZXF1ZXN0KG9wdGlvbnMsIHJlc3BvbnNlQ2FsbGJhY2spIHsKICAvLyBJbml0aWFsaXplIHRoZSByZXF1ZXN0CiAgV3JpdGFibGUuY2FsbCh0aGlzKTsKCiAgdGhpcy5fc2FuaXRpemVPcHRpb25zKG9wdGlvbnMpOwoKICB0aGlzLl9vcHRpb25zID0gb3B0aW9uczsKICB0aGlzLl9lbmRlZCA9IGZhbHNlOwogIHRoaXMuX2VuZGluZyA9IGZhbHNlOwogIHRoaXMuX3JlZGlyZWN0Q291bnQgPSAwOwogIHRoaXMuX3JlZGlyZWN0cyA9IFtdOwogIHRoaXMuX3JlcXVlc3RCb2R5TGVuZ3RoID0gMDsKICB0aGlzLl9yZXF1ZXN0Qm9keUJ1ZmZlcnMgPSBbXTsgLy8gQXR0YWNoIGEgY2FsbGJhY2sgaWYgcGFzc2VkCgogIGlmIChyZXNwb25zZUNhbGxiYWNrKSB7CiAgICB0aGlzLm9uKCJyZXNwb25zZSIsIHJlc3BvbnNlQ2FsbGJhY2spOwogIH0gLy8gUmVhY3QgdG8gcmVzcG9uc2VzIG9mIG5hdGl2ZSByZXF1ZXN0cwoKCiAgdmFyIHNlbGYgPSB0aGlzOwoKICB0aGlzLl9vbk5hdGl2ZVJlc3BvbnNlID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICBzZWxmLl9wcm9jZXNzUmVzcG9uc2UocmVzcG9uc2UpOwogIH07IC8vIFBlcmZvcm0gdGhlIGZpcnN0IHJlcXVlc3QKCgogIHRoaXMuX3BlcmZvcm1SZXF1ZXN0KCk7Cn0KClJlZGlyZWN0YWJsZVJlcXVlc3QucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShXcml0YWJsZS5wcm90b3R5cGUpOwoKUmVkaXJlY3RhYmxlUmVxdWVzdC5wcm90b3R5cGUuYWJvcnQgPSBmdW5jdGlvbiAoKSB7CiAgLy8gQWJvcnQgdGhlIGludGVybmFsIHJlcXVlc3QKICBhYm9ydFJlcXVlc3QodGhpcy5fY3VycmVudFJlcXVlc3QpOyAvLyBBYm9ydCB0aGlzIHJlcXVlc3QKCiAgdGhpcy5lbWl0KCJhYm9ydCIpOwogIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCk7Cn07IC8vIFdyaXRlcyBidWZmZXJlZCBkYXRhIHRvIHRoZSBjdXJyZW50IG5hdGl2ZSByZXF1ZXN0CgoKUmVkaXJlY3RhYmxlUmVxdWVzdC5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAoZGF0YSwgZW5jb2RpbmcsIGNhbGxiYWNrKSB7CiAgLy8gV3JpdGluZyBpcyBub3QgYWxsb3dlZCBpZiBlbmQgaGFzIGJlZW4gY2FsbGVkCiAgaWYgKHRoaXMuX2VuZGluZykgewogICAgdGhyb3cgbmV3IFdyaXRlQWZ0ZXJFbmRFcnJvcigpOwogIH0gLy8gVmFsaWRhdGUgaW5wdXQgYW5kIHNoaWZ0IHBhcmFtZXRlcnMgaWYgbmVjZXNzYXJ5CgoKICBpZiAoISh0eXBlb2YgZGF0YSA9PT0gInN0cmluZyIgfHwgX3R5cGVvZihkYXRhKSA9PT0gIm9iamVjdCIgJiYgImxlbmd0aCIgaW4gZGF0YSkpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoImRhdGEgc2hvdWxkIGJlIGEgc3RyaW5nLCBCdWZmZXIgb3IgVWludDhBcnJheSIpOwogIH0KCiAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gImZ1bmN0aW9uIikgewogICAgY2FsbGJhY2sgPSBlbmNvZGluZzsKICAgIGVuY29kaW5nID0gbnVsbDsKICB9IC8vIElnbm9yZSBlbXB0eSBidWZmZXJzLCBzaW5jZSB3cml0aW5nIHRoZW0gZG9lc24ndCBpbnZva2UgdGhlIGNhbGxiYWNrCiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL2lzc3Vlcy8yMjA2NgoKCiAgaWYgKGRhdGEubGVuZ3RoID09PSAwKSB7CiAgICBpZiAoY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2soKTsKICAgIH0KCiAgICByZXR1cm47CiAgfSAvLyBPbmx5IHdyaXRlIHdoZW4gd2UgZG9uJ3QgZXhjZWVkIHRoZSBtYXhpbXVtIGJvZHkgbGVuZ3RoCgoKICBpZiAodGhpcy5fcmVxdWVzdEJvZHlMZW5ndGggKyBkYXRhLmxlbmd0aCA8PSB0aGlzLl9vcHRpb25zLm1heEJvZHlMZW5ndGgpIHsKICAgIHRoaXMuX3JlcXVlc3RCb2R5TGVuZ3RoICs9IGRhdGEubGVuZ3RoOwoKICAgIHRoaXMuX3JlcXVlc3RCb2R5QnVmZmVycy5wdXNoKHsKICAgICAgZGF0YTogZGF0YSwKICAgICAgZW5jb2Rpbmc6IGVuY29kaW5nCiAgICB9KTsKCiAgICB0aGlzLl9jdXJyZW50UmVxdWVzdC53cml0ZShkYXRhLCBlbmNvZGluZywgY2FsbGJhY2spOwogIH0gLy8gRXJyb3Igd2hlbiB3ZSBleGNlZWQgdGhlIG1heGltdW0gYm9keSBsZW5ndGgKICBlbHNlIHsKICAgICAgdGhpcy5lbWl0KCJlcnJvciIsIG5ldyBNYXhCb2R5TGVuZ3RoRXhjZWVkZWRFcnJvcigpKTsKICAgICAgdGhpcy5hYm9ydCgpOwogICAgfQp9OyAvLyBFbmRzIHRoZSBjdXJyZW50IG5hdGl2ZSByZXF1ZXN0CgoKUmVkaXJlY3RhYmxlUmVxdWVzdC5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKGRhdGEsIGVuY29kaW5nLCBjYWxsYmFjaykgewogIC8vIFNoaWZ0IHBhcmFtZXRlcnMgaWYgbmVjZXNzYXJ5CiAgaWYgKHR5cGVvZiBkYXRhID09PSAiZnVuY3Rpb24iKSB7CiAgICBjYWxsYmFjayA9IGRhdGE7CiAgICBkYXRhID0gZW5jb2RpbmcgPSBudWxsOwogIH0gZWxzZSBpZiAodHlwZW9mIGVuY29kaW5nID09PSAiZnVuY3Rpb24iKSB7CiAgICBjYWxsYmFjayA9IGVuY29kaW5nOwogICAgZW5jb2RpbmcgPSBudWxsOwogIH0gLy8gV3JpdGUgZGF0YSBpZiBuZWVkZWQgYW5kIGVuZAoKCiAgaWYgKCFkYXRhKSB7CiAgICB0aGlzLl9lbmRlZCA9IHRoaXMuX2VuZGluZyA9IHRydWU7CgogICAgdGhpcy5fY3VycmVudFJlcXVlc3QuZW5kKG51bGwsIG51bGwsIGNhbGxiYWNrKTsKICB9IGVsc2UgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdmFyIGN1cnJlbnRSZXF1ZXN0ID0gdGhpcy5fY3VycmVudFJlcXVlc3Q7CiAgICB0aGlzLndyaXRlKGRhdGEsIGVuY29kaW5nLCBmdW5jdGlvbiAoKSB7CiAgICAgIHNlbGYuX2VuZGVkID0gdHJ1ZTsKICAgICAgY3VycmVudFJlcXVlc3QuZW5kKG51bGwsIG51bGwsIGNhbGxiYWNrKTsKICAgIH0pOwogICAgdGhpcy5fZW5kaW5nID0gdHJ1ZTsKICB9Cn07IC8vIFNldHMgYSBoZWFkZXIgdmFsdWUgb24gdGhlIGN1cnJlbnQgbmF0aXZlIHJlcXVlc3QKCgpSZWRpcmVjdGFibGVSZXF1ZXN0LnByb3RvdHlwZS5zZXRIZWFkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHsKICB0aGlzLl9vcHRpb25zLmhlYWRlcnNbbmFtZV0gPSB2YWx1ZTsKCiAgdGhpcy5fY3VycmVudFJlcXVlc3Quc2V0SGVhZGVyKG5hbWUsIHZhbHVlKTsKfTsgLy8gQ2xlYXJzIGEgaGVhZGVyIHZhbHVlIG9uIHRoZSBjdXJyZW50IG5hdGl2ZSByZXF1ZXN0CgoKUmVkaXJlY3RhYmxlUmVxdWVzdC5wcm90b3R5cGUucmVtb3ZlSGVhZGVyID0gZnVuY3Rpb24gKG5hbWUpIHsKICBkZWxldGUgdGhpcy5fb3B0aW9ucy5oZWFkZXJzW25hbWVdOwoKICB0aGlzLl9jdXJyZW50UmVxdWVzdC5yZW1vdmVIZWFkZXIobmFtZSk7Cn07IC8vIEdsb2JhbCB0aW1lb3V0IGZvciBhbGwgdW5kZXJseWluZyByZXF1ZXN0cwoKClJlZGlyZWN0YWJsZVJlcXVlc3QucHJvdG90eXBlLnNldFRpbWVvdXQgPSBmdW5jdGlvbiAobXNlY3MsIGNhbGxiYWNrKSB7CiAgdmFyIHNlbGYgPSB0aGlzOwoKICBpZiAoY2FsbGJhY2spIHsKICAgIHRoaXMub24oInRpbWVvdXQiLCBjYWxsYmFjayk7CiAgfQoKICBmdW5jdGlvbiBkZXN0cm95T25UaW1lb3V0KHNvY2tldCkgewogICAgc29ja2V0LnNldFRpbWVvdXQobXNlY3MpOwogICAgc29ja2V0LnJlbW92ZUxpc3RlbmVyKCJ0aW1lb3V0Iiwgc29ja2V0LmRlc3Ryb3kpOwogICAgc29ja2V0LmFkZExpc3RlbmVyKCJ0aW1lb3V0Iiwgc29ja2V0LmRlc3Ryb3kpOwogIH0gLy8gU2V0cyB1cCBhIHRpbWVyIHRvIHRyaWdnZXIgYSB0aW1lb3V0IGV2ZW50CgoKICBmdW5jdGlvbiBzdGFydFRpbWVyKHNvY2tldCkgewogICAgaWYgKHNlbGYuX3RpbWVvdXQpIHsKICAgICAgY2xlYXJUaW1lb3V0KHNlbGYuX3RpbWVvdXQpOwogICAgfQoKICAgIHNlbGYuX3RpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgc2VsZi5lbWl0KCJ0aW1lb3V0Iik7CiAgICAgIGNsZWFyVGltZXIoKTsKICAgIH0sIG1zZWNzKTsKICAgIGRlc3Ryb3lPblRpbWVvdXQoc29ja2V0KTsKICB9IC8vIFByZXZlbnQgYSB0aW1lb3V0IGZyb20gdHJpZ2dlcmluZwoKCiAgZnVuY3Rpb24gY2xlYXJUaW1lcigpIHsKICAgIGNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0KTsKCiAgICBpZiAoY2FsbGJhY2spIHsKICAgICAgc2VsZi5yZW1vdmVMaXN0ZW5lcigidGltZW91dCIsIGNhbGxiYWNrKTsKICAgIH0KCiAgICBpZiAoIXRoaXMuc29ja2V0KSB7CiAgICAgIHNlbGYuX2N1cnJlbnRSZXF1ZXN0LnJlbW92ZUxpc3RlbmVyKCJzb2NrZXQiLCBzdGFydFRpbWVyKTsKICAgIH0KICB9IC8vIFN0YXJ0IHRoZSB0aW1lciB3aGVuIHRoZSBzb2NrZXQgaXMgb3BlbmVkCgoKICBpZiAodGhpcy5zb2NrZXQpIHsKICAgIHN0YXJ0VGltZXIodGhpcy5zb2NrZXQpOwogIH0gZWxzZSB7CiAgICB0aGlzLl9jdXJyZW50UmVxdWVzdC5vbmNlKCJzb2NrZXQiLCBzdGFydFRpbWVyKTsKICB9CgogIHRoaXMub24oInNvY2tldCIsIGRlc3Ryb3lPblRpbWVvdXQpOwogIHRoaXMub25jZSgicmVzcG9uc2UiLCBjbGVhclRpbWVyKTsKICB0aGlzLm9uY2UoImVycm9yIiwgY2xlYXJUaW1lcik7CiAgcmV0dXJuIHRoaXM7Cn07IC8vIFByb3h5IGFsbCBvdGhlciBwdWJsaWMgQ2xpZW50UmVxdWVzdCBtZXRob2RzCgoKWyJmbHVzaEhlYWRlcnMiLCAiZ2V0SGVhZGVyIiwgInNldE5vRGVsYXkiLCAic2V0U29ja2V0S2VlcEFsaXZlIl0uZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7CiAgUmVkaXJlY3RhYmxlUmVxdWVzdC5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICByZXR1cm4gdGhpcy5fY3VycmVudFJlcXVlc3RbbWV0aG9kXShhLCBiKTsKICB9Owp9KTsgLy8gUHJveHkgYWxsIHB1YmxpYyBDbGllbnRSZXF1ZXN0IHByb3BlcnRpZXMKClsiYWJvcnRlZCIsICJjb25uZWN0aW9uIiwgInNvY2tldCJdLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5KSB7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlZGlyZWN0YWJsZVJlcXVlc3QucHJvdG90eXBlLCBwcm9wZXJ0eSwgewogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50UmVxdWVzdFtwcm9wZXJ0eV07CiAgICB9CiAgfSk7Cn0pOwoKUmVkaXJlY3RhYmxlUmVxdWVzdC5wcm90b3R5cGUuX3Nhbml0aXplT3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgLy8gRW5zdXJlIGhlYWRlcnMgYXJlIGFsd2F5cyBwcmVzZW50CiAgaWYgKCFvcHRpb25zLmhlYWRlcnMpIHsKICAgIG9wdGlvbnMuaGVhZGVycyA9IHt9OwogIH0gLy8gU2luY2UgaHR0cC5yZXF1ZXN0IHRyZWF0cyBob3N0IGFzIGFuIGFsaWFzIG9mIGhvc3RuYW1lLAogIC8vIGJ1dCB0aGUgdXJsIG1vZHVsZSBpbnRlcnByZXRzIGhvc3QgYXMgaG9zdG5hbWUgcGx1cyBwb3J0LAogIC8vIGVsaW1pbmF0ZSB0aGUgaG9zdCBwcm9wZXJ0eSB0byBhdm9pZCBjb25mdXNpb24uCgoKICBpZiAob3B0aW9ucy5ob3N0KSB7CiAgICAvLyBVc2UgaG9zdG5hbWUgaWYgc2V0LCBiZWNhdXNlIGl0IGhhcyBwcmVjZWRlbmNlCiAgICBpZiAoIW9wdGlvbnMuaG9zdG5hbWUpIHsKICAgICAgb3B0aW9ucy5ob3N0bmFtZSA9IG9wdGlvbnMuaG9zdDsKICAgIH0KCiAgICBkZWxldGUgb3B0aW9ucy5ob3N0OwogIH0gLy8gQ29tcGxldGUgdGhlIFVSTCBvYmplY3Qgd2hlbiBuZWNlc3NhcnkKCgogIGlmICghb3B0aW9ucy5wYXRobmFtZSAmJiBvcHRpb25zLnBhdGgpIHsKICAgIHZhciBzZWFyY2hQb3MgPSBvcHRpb25zLnBhdGguaW5kZXhPZigiPyIpOwoKICAgIGlmIChzZWFyY2hQb3MgPCAwKSB7CiAgICAgIG9wdGlvbnMucGF0aG5hbWUgPSBvcHRpb25zLnBhdGg7CiAgICB9IGVsc2UgewogICAgICBvcHRpb25zLnBhdGhuYW1lID0gb3B0aW9ucy5wYXRoLnN1YnN0cmluZygwLCBzZWFyY2hQb3MpOwogICAgICBvcHRpb25zLnNlYXJjaCA9IG9wdGlvbnMucGF0aC5zdWJzdHJpbmcoc2VhcmNoUG9zKTsKICAgIH0KICB9Cn07IC8vIEV4ZWN1dGVzIHRoZSBuZXh0IG5hdGl2ZSByZXF1ZXN0IChpbml0aWFsIG9yIHJlZGlyZWN0KQoKClJlZGlyZWN0YWJsZVJlcXVlc3QucHJvdG90eXBlLl9wZXJmb3JtUmVxdWVzdCA9IGZ1bmN0aW9uICgpIHsKICAvLyBMb2FkIHRoZSBuYXRpdmUgcHJvdG9jb2wKICB2YXIgcHJvdG9jb2wgPSB0aGlzLl9vcHRpb25zLnByb3RvY29sOwogIHZhciBuYXRpdmVQcm90b2NvbCA9IHRoaXMuX29wdGlvbnMubmF0aXZlUHJvdG9jb2xzW3Byb3RvY29sXTsKCiAgaWYgKCFuYXRpdmVQcm90b2NvbCkgewogICAgdGhpcy5lbWl0KCJlcnJvciIsIG5ldyBUeXBlRXJyb3IoIlVuc3VwcG9ydGVkIHByb3RvY29sICIgKyBwcm90b2NvbCkpOwogICAgcmV0dXJuOwogIH0gLy8gSWYgc3BlY2lmaWVkLCB1c2UgdGhlIGFnZW50IGNvcnJlc3BvbmRpbmcgdG8gdGhlIHByb3RvY29sCiAgLy8gKEhUVFAgYW5kIEhUVFBTIHVzZSBkaWZmZXJlbnQgdHlwZXMgb2YgYWdlbnRzKQoKCiAgaWYgKHRoaXMuX29wdGlvbnMuYWdlbnRzKSB7CiAgICB2YXIgc2NoZW1lID0gcHJvdG9jb2wuc3Vic3RyKDAsIHByb3RvY29sLmxlbmd0aCAtIDEpOwogICAgdGhpcy5fb3B0aW9ucy5hZ2VudCA9IHRoaXMuX29wdGlvbnMuYWdlbnRzW3NjaGVtZV07CiAgfSAvLyBDcmVhdGUgdGhlIG5hdGl2ZSByZXF1ZXN0CgoKICB2YXIgcmVxdWVzdCA9IHRoaXMuX2N1cnJlbnRSZXF1ZXN0ID0gbmF0aXZlUHJvdG9jb2wucmVxdWVzdCh0aGlzLl9vcHRpb25zLCB0aGlzLl9vbk5hdGl2ZVJlc3BvbnNlKTsKICB0aGlzLl9jdXJyZW50VXJsID0gdXJsLmZvcm1hdCh0aGlzLl9vcHRpb25zKTsgLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzCgogIHJlcXVlc3QuX3JlZGlyZWN0YWJsZSA9IHRoaXM7CgogIGZvciAodmFyIGUgPSAwOyBlIDwgZXZlbnRzLmxlbmd0aDsgZSsrKSB7CiAgICByZXF1ZXN0Lm9uKGV2ZW50c1tlXSwgZXZlbnRIYW5kbGVyc1tldmVudHNbZV1dKTsKICB9IC8vIEVuZCBhIHJlZGlyZWN0ZWQgcmVxdWVzdAogIC8vIChUaGUgZmlyc3QgcmVxdWVzdCBtdXN0IGJlIGVuZGVkIGV4cGxpY2l0bHkgd2l0aCBSZWRpcmVjdGFibGVSZXF1ZXN0I2VuZCkKCgogIGlmICh0aGlzLl9pc1JlZGlyZWN0KSB7CiAgICAvLyBXcml0ZSB0aGUgcmVxdWVzdCBlbnRpdHkgYW5kIGVuZC4KICAgIHZhciBpID0gMDsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIHZhciBidWZmZXJzID0gdGhpcy5fcmVxdWVzdEJvZHlCdWZmZXJzOwoKICAgIChmdW5jdGlvbiB3cml0ZU5leHQoZXJyb3IpIHsKICAgICAgLy8gT25seSB3cml0ZSBpZiB0aGlzIHJlcXVlc3QgaGFzIG5vdCBiZWVuIHJlZGlyZWN0ZWQgeWV0CgogICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwogICAgICBpZiAocmVxdWVzdCA9PT0gc2VsZi5fY3VycmVudFJlcXVlc3QpIHsKICAgICAgICAvLyBSZXBvcnQgYW55IHdyaXRlIGVycm9ycwoKICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICAgICAgICBpZiAoZXJyb3IpIHsKICAgICAgICAgIHNlbGYuZW1pdCgiZXJyb3IiLCBlcnJvcik7CiAgICAgICAgfSAvLyBXcml0ZSB0aGUgbmV4dCBidWZmZXIgaWYgdGhlcmUgYXJlIHN0aWxsIGxlZnQKICAgICAgICBlbHNlIGlmIChpIDwgYnVmZmVycy5sZW5ndGgpIHsKICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IGJ1ZmZlcnNbaSsrXTsKICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KCiAgICAgICAgICAgIGlmICghcmVxdWVzdC5maW5pc2hlZCkgewogICAgICAgICAgICAgIHJlcXVlc3Qud3JpdGUoYnVmZmVyLmRhdGEsIGJ1ZmZlci5lbmNvZGluZywgd3JpdGVOZXh0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSAvLyBFbmQgdGhlIHJlcXVlc3QgaWYgYGVuZGAgaGFzIGJlZW4gY2FsbGVkIG9uIHVzCiAgICAgICAgICBlbHNlIGlmIChzZWxmLl9lbmRlZCkgewogICAgICAgICAgICAgIHJlcXVlc3QuZW5kKCk7CiAgICAgICAgICAgIH0KICAgICAgfQogICAgfSkoKTsKICB9Cn07IC8vIFByb2Nlc3NlcyBhIHJlc3BvbnNlIGZyb20gdGhlIGN1cnJlbnQgbmF0aXZlIHJlcXVlc3QKCgpSZWRpcmVjdGFibGVSZXF1ZXN0LnByb3RvdHlwZS5fcHJvY2Vzc1Jlc3BvbnNlID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgLy8gU3RvcmUgdGhlIHJlZGlyZWN0ZWQgcmVzcG9uc2UKICB2YXIgc3RhdHVzQ29kZSA9IHJlc3BvbnNlLnN0YXR1c0NvZGU7CgogIGlmICh0aGlzLl9vcHRpb25zLnRyYWNrUmVkaXJlY3RzKSB7CiAgICB0aGlzLl9yZWRpcmVjdHMucHVzaCh7CiAgICAgIHVybDogdGhpcy5fY3VycmVudFVybCwKICAgICAgaGVhZGVyczogcmVzcG9uc2UuaGVhZGVycywKICAgICAgc3RhdHVzQ29kZTogc3RhdHVzQ29kZQogICAgfSk7CiAgfSAvLyBSRkM3MjMxwqc2LjQ6IFRoZSAzeHggKFJlZGlyZWN0aW9uKSBjbGFzcyBvZiBzdGF0dXMgY29kZSBpbmRpY2F0ZXMKICAvLyB0aGF0IGZ1cnRoZXIgYWN0aW9uIG5lZWRzIHRvIGJlIHRha2VuIGJ5IHRoZSB1c2VyIGFnZW50IGluIG9yZGVyIHRvCiAgLy8gZnVsZmlsbCB0aGUgcmVxdWVzdC4gSWYgYSBMb2NhdGlvbiBoZWFkZXIgZmllbGQgaXMgcHJvdmlkZWQsCiAgLy8gdGhlIHVzZXIgYWdlbnQgTUFZIGF1dG9tYXRpY2FsbHkgcmVkaXJlY3QgaXRzIHJlcXVlc3QgdG8gdGhlIFVSSQogIC8vIHJlZmVyZW5jZWQgYnkgdGhlIExvY2F0aW9uIGZpZWxkIHZhbHVlLAogIC8vIGV2ZW4gaWYgdGhlIHNwZWNpZmljIHN0YXR1cyBjb2RlIGlzIG5vdCB1bmRlcnN0b29kLgoKCiAgdmFyIGxvY2F0aW9uID0gcmVzcG9uc2UuaGVhZGVycy5sb2NhdGlvbjsKCiAgaWYgKGxvY2F0aW9uICYmIHRoaXMuX29wdGlvbnMuZm9sbG93UmVkaXJlY3RzICE9PSBmYWxzZSAmJiBzdGF0dXNDb2RlID49IDMwMCAmJiBzdGF0dXNDb2RlIDwgNDAwKSB7CiAgICAvLyBBYm9ydCB0aGUgY3VycmVudCByZXF1ZXN0CiAgICBhYm9ydFJlcXVlc3QodGhpcy5fY3VycmVudFJlcXVlc3QpOyAvLyBEaXNjYXJkIHRoZSByZW1haW5kZXIgb2YgdGhlIHJlc3BvbnNlIHRvIGF2b2lkIHdhaXRpbmcgZm9yIGRhdGEKCiAgICByZXNwb25zZS5kZXN0cm95KCk7IC8vIFJGQzcyMzHCpzYuNDogQSBjbGllbnQgU0hPVUxEIGRldGVjdCBhbmQgaW50ZXJ2ZW5lCiAgICAvLyBpbiBjeWNsaWNhbCByZWRpcmVjdGlvbnMgKGkuZS4sICJpbmZpbml0ZSIgcmVkaXJlY3Rpb24gbG9vcHMpLgoKICAgIGlmICgrK3RoaXMuX3JlZGlyZWN0Q291bnQgPiB0aGlzLl9vcHRpb25zLm1heFJlZGlyZWN0cykgewogICAgICB0aGlzLmVtaXQoImVycm9yIiwgbmV3IFRvb01hbnlSZWRpcmVjdHNFcnJvcigpKTsKICAgICAgcmV0dXJuOwogICAgfSAvLyBSRkM3MjMxwqc2LjQ6IEF1dG9tYXRpYyByZWRpcmVjdGlvbiBuZWVkcyB0byBkb25lIHdpdGgKICAgIC8vIGNhcmUgZm9yIG1ldGhvZHMgbm90IGtub3duIHRvIGJlIHNhZmUsIFvigKZdCiAgICAvLyBSRkM3MjMxwqc2LjQuMuKAkzM6IEZvciBoaXN0b3JpY2FsIHJlYXNvbnMsIGEgdXNlciBhZ2VudCBNQVkgY2hhbmdlCiAgICAvLyB0aGUgcmVxdWVzdCBtZXRob2QgZnJvbSBQT1NUIHRvIEdFVCBmb3IgdGhlIHN1YnNlcXVlbnQgcmVxdWVzdC4KCgogICAgaWYgKChzdGF0dXNDb2RlID09PSAzMDEgfHwgc3RhdHVzQ29kZSA9PT0gMzAyKSAmJiB0aGlzLl9vcHRpb25zLm1ldGhvZCA9PT0gIlBPU1QiIHx8IC8vIFJGQzcyMzHCpzYuNC40OiBUaGUgMzAzIChTZWUgT3RoZXIpIHN0YXR1cyBjb2RlIGluZGljYXRlcyB0aGF0CiAgICAvLyB0aGUgc2VydmVyIGlzIHJlZGlyZWN0aW5nIHRoZSB1c2VyIGFnZW50IHRvIGEgZGlmZmVyZW50IHJlc291cmNlIFvigKZdCiAgICAvLyBBIHVzZXIgYWdlbnQgY2FuIHBlcmZvcm0gYSByZXRyaWV2YWwgcmVxdWVzdCB0YXJnZXRpbmcgdGhhdCBVUkkKICAgIC8vIChhIEdFVCBvciBIRUFEIHJlcXVlc3QgaWYgdXNpbmcgSFRUUCkgW+KApl0KICAgIHN0YXR1c0NvZGUgPT09IDMwMyAmJiAhL14oPzpHRVR8SEVBRCkkLy50ZXN0KHRoaXMuX29wdGlvbnMubWV0aG9kKSkgewogICAgICB0aGlzLl9vcHRpb25zLm1ldGhvZCA9ICJHRVQiOyAvLyBEcm9wIGEgcG9zc2libGUgZW50aXR5IGFuZCBoZWFkZXJzIHJlbGF0ZWQgdG8gaXQKCiAgICAgIHRoaXMuX3JlcXVlc3RCb2R5QnVmZmVycyA9IFtdOwogICAgICByZW1vdmVNYXRjaGluZ0hlYWRlcnMoL15jb250ZW50LS9pLCB0aGlzLl9vcHRpb25zLmhlYWRlcnMpOwogICAgfSAvLyBEcm9wIHRoZSBIb3N0IGhlYWRlciwgYXMgdGhlIHJlZGlyZWN0IG1pZ2h0IGxlYWQgdG8gYSBkaWZmZXJlbnQgaG9zdAoKCiAgICB2YXIgcHJldmlvdXNIb3N0TmFtZSA9IHJlbW92ZU1hdGNoaW5nSGVhZGVycygvXmhvc3QkL2ksIHRoaXMuX29wdGlvbnMuaGVhZGVycykgfHwgdXJsLnBhcnNlKHRoaXMuX2N1cnJlbnRVcmwpLmhvc3RuYW1lOyAvLyBDcmVhdGUgdGhlIHJlZGlyZWN0ZWQgcmVxdWVzdAoKICAgIHZhciByZWRpcmVjdFVybCA9IHVybC5yZXNvbHZlKHRoaXMuX2N1cnJlbnRVcmwsIGxvY2F0aW9uKTsKICAgIGRlYnVnKCJyZWRpcmVjdGluZyB0byIsIHJlZGlyZWN0VXJsKTsKICAgIHRoaXMuX2lzUmVkaXJlY3QgPSB0cnVlOwogICAgdmFyIHJlZGlyZWN0VXJsUGFydHMgPSB1cmwucGFyc2UocmVkaXJlY3RVcmwpOwogICAgT2JqZWN0LmFzc2lnbih0aGlzLl9vcHRpb25zLCByZWRpcmVjdFVybFBhcnRzKTsgLy8gRHJvcCB0aGUgQXV0aG9yaXphdGlvbiBoZWFkZXIgaWYgcmVkaXJlY3RpbmcgdG8gYW5vdGhlciBob3N0CgogICAgaWYgKHJlZGlyZWN0VXJsUGFydHMuaG9zdG5hbWUgIT09IHByZXZpb3VzSG9zdE5hbWUpIHsKICAgICAgcmVtb3ZlTWF0Y2hpbmdIZWFkZXJzKC9eYXV0aG9yaXphdGlvbiQvaSwgdGhpcy5fb3B0aW9ucy5oZWFkZXJzKTsKICAgIH0gLy8gRXZhbHVhdGUgdGhlIGJlZm9yZVJlZGlyZWN0IGNhbGxiYWNrCgoKICAgIGlmICh0eXBlb2YgdGhpcy5fb3B0aW9ucy5iZWZvcmVSZWRpcmVjdCA9PT0gImZ1bmN0aW9uIikgewogICAgICB2YXIgcmVzcG9uc2VEZXRhaWxzID0gewogICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlLmhlYWRlcnMKICAgICAgfTsKCiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy5fb3B0aW9ucy5iZWZvcmVSZWRpcmVjdC5jYWxsKG51bGwsIHRoaXMuX29wdGlvbnMsIHJlc3BvbnNlRGV0YWlscyk7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuZW1pdCgiZXJyb3IiLCBlcnIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5fc2FuaXRpemVPcHRpb25zKHRoaXMuX29wdGlvbnMpOwogICAgfSAvLyBQZXJmb3JtIHRoZSByZWRpcmVjdGVkIHJlcXVlc3QKCgogICAgdHJ5IHsKICAgICAgdGhpcy5fcGVyZm9ybVJlcXVlc3QoKTsKICAgIH0gY2F0Y2ggKGNhdXNlKSB7CiAgICAgIHZhciBlcnJvciA9IG5ldyBSZWRpcmVjdGlvbkVycm9yKCJSZWRpcmVjdGVkIHJlcXVlc3QgZmFpbGVkOiAiICsgY2F1c2UubWVzc2FnZSk7CiAgICAgIGVycm9yLmNhdXNlID0gY2F1c2U7CiAgICAgIHRoaXMuZW1pdCgiZXJyb3IiLCBlcnJvcik7CiAgICB9CiAgfSBlbHNlIHsKICAgIC8vIFRoZSByZXNwb25zZSBpcyBub3QgYSByZWRpcmVjdDsgcmV0dXJuIGl0IGFzLWlzCiAgICByZXNwb25zZS5yZXNwb25zZVVybCA9IHRoaXMuX2N1cnJlbnRVcmw7CiAgICByZXNwb25zZS5yZWRpcmVjdHMgPSB0aGlzLl9yZWRpcmVjdHM7CiAgICB0aGlzLmVtaXQoInJlc3BvbnNlIiwgcmVzcG9uc2UpOyAvLyBDbGVhbiB1cAoKICAgIHRoaXMuX3JlcXVlc3RCb2R5QnVmZmVycyA9IFtdOwogIH0KfTsgLy8gV3JhcHMgdGhlIGtleS92YWx1ZSBvYmplY3Qgb2YgcHJvdG9jb2xzIHdpdGggcmVkaXJlY3QgZnVuY3Rpb25hbGl0eQoKCmZ1bmN0aW9uIHdyYXAocHJvdG9jb2xzKSB7CiAgLy8gRGVmYXVsdCBzZXR0aW5ncwogIHZhciBleHBvcnRzID0gewogICAgbWF4UmVkaXJlY3RzOiAyMSwKICAgIG1heEJvZHlMZW5ndGg6IDEwICogMTAyNCAqIDEwMjQKICB9OyAvLyBXcmFwIGVhY2ggcHJvdG9jb2wKCiAgdmFyIG5hdGl2ZVByb3RvY29scyA9IHt9OwogIE9iamVjdC5rZXlzKHByb3RvY29scykuZm9yRWFjaChmdW5jdGlvbiAoc2NoZW1lKSB7CiAgICB2YXIgcHJvdG9jb2wgPSBzY2hlbWUgKyAiOiI7CiAgICB2YXIgbmF0aXZlUHJvdG9jb2wgPSBuYXRpdmVQcm90b2NvbHNbcHJvdG9jb2xdID0gcHJvdG9jb2xzW3NjaGVtZV07CiAgICB2YXIgd3JhcHBlZFByb3RvY29sID0gZXhwb3J0c1tzY2hlbWVdID0gT2JqZWN0LmNyZWF0ZShuYXRpdmVQcm90b2NvbCk7IC8vIEV4ZWN1dGVzIGEgcmVxdWVzdCwgZm9sbG93aW5nIHJlZGlyZWN0cwoKICAgIGZ1bmN0aW9uIHJlcXVlc3QoaW5wdXQsIG9wdGlvbnMsIGNhbGxiYWNrKSB7CiAgICAgIC8vIFBhcnNlIHBhcmFtZXRlcnMKICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gInN0cmluZyIpIHsKICAgICAgICB2YXIgdXJsU3RyID0gaW5wdXQ7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBpbnB1dCA9IHVybFRvT3B0aW9ucyhuZXcgVVJMKHVybFN0cikpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICAgICAgICAgIGlucHV0ID0gdXJsLnBhcnNlKHVybFN0cik7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKFVSTCAmJiBpbnB1dCBpbnN0YW5jZW9mIFVSTCkgewogICAgICAgIGlucHV0ID0gdXJsVG9PcHRpb25zKGlucHV0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjYWxsYmFjayA9IG9wdGlvbnM7CiAgICAgICAgb3B0aW9ucyA9IGlucHV0OwogICAgICAgIGlucHV0ID0gewogICAgICAgICAgcHJvdG9jb2w6IHByb3RvY29sCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgY2FsbGJhY2sgPSBvcHRpb25zOwogICAgICAgIG9wdGlvbnMgPSBudWxsOwogICAgICB9IC8vIFNldCBkZWZhdWx0cwoKCiAgICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsKICAgICAgICBtYXhSZWRpcmVjdHM6IGV4cG9ydHMubWF4UmVkaXJlY3RzLAogICAgICAgIG1heEJvZHlMZW5ndGg6IGV4cG9ydHMubWF4Qm9keUxlbmd0aAogICAgICB9LCBpbnB1dCwgb3B0aW9ucyk7CiAgICAgIG9wdGlvbnMubmF0aXZlUHJvdG9jb2xzID0gbmF0aXZlUHJvdG9jb2xzOwogICAgICBhc3NlcnQuZXF1YWwob3B0aW9ucy5wcm90b2NvbCwgcHJvdG9jb2wsICJwcm90b2NvbCBtaXNtYXRjaCIpOwogICAgICBkZWJ1Zygib3B0aW9ucyIsIG9wdGlvbnMpOwogICAgICByZXR1cm4gbmV3IFJlZGlyZWN0YWJsZVJlcXVlc3Qob3B0aW9ucywgY2FsbGJhY2spOwogICAgfSAvLyBFeGVjdXRlcyBhIEdFVCByZXF1ZXN0LCBmb2xsb3dpbmcgcmVkaXJlY3RzCgoKICAgIGZ1bmN0aW9uIGdldChpbnB1dCwgb3B0aW9ucywgY2FsbGJhY2spIHsKICAgICAgdmFyIHdyYXBwZWRSZXF1ZXN0ID0gd3JhcHBlZFByb3RvY29sLnJlcXVlc3QoaW5wdXQsIG9wdGlvbnMsIGNhbGxiYWNrKTsKICAgICAgd3JhcHBlZFJlcXVlc3QuZW5kKCk7CiAgICAgIHJldHVybiB3cmFwcGVkUmVxdWVzdDsKICAgIH0gLy8gRXhwb3NlIHRoZSBwcm9wZXJ0aWVzIG9uIHRoZSB3cmFwcGVkIHByb3RvY29sCgoKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHdyYXBwZWRQcm90b2NvbCwgewogICAgICByZXF1ZXN0OiB7CiAgICAgICAgdmFsdWU6IHJlcXVlc3QsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUKICAgICAgfSwKICAgICAgZ2V0OiB7CiAgICAgICAgdmFsdWU6IGdldCwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICB9CiAgICB9KTsKICB9KTsKICByZXR1cm4gZXhwb3J0czsKfQovKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoKCmZ1bmN0aW9uIG5vb3AoKSB7CiAgLyogZW1wdHkgKi8KfSAvLyBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlanMvbm9kZS9ibG9iL21hc3Rlci9saWIvaW50ZXJuYWwvdXJsLmpzCgoKZnVuY3Rpb24gdXJsVG9PcHRpb25zKHVybE9iamVjdCkgewogIHZhciBvcHRpb25zID0gewogICAgcHJvdG9jb2w6IHVybE9iamVjdC5wcm90b2NvbCwKICAgIGhvc3RuYW1lOiB1cmxPYmplY3QuaG9zdG5hbWUuc3RhcnRzV2l0aCgiWyIpID8KICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICB1cmxPYmplY3QuaG9zdG5hbWUuc2xpY2UoMSwgLTEpIDogdXJsT2JqZWN0Lmhvc3RuYW1lLAogICAgaGFzaDogdXJsT2JqZWN0Lmhhc2gsCiAgICBzZWFyY2g6IHVybE9iamVjdC5zZWFyY2gsCiAgICBwYXRobmFtZTogdXJsT2JqZWN0LnBhdGhuYW1lLAogICAgcGF0aDogdXJsT2JqZWN0LnBhdGhuYW1lICsgdXJsT2JqZWN0LnNlYXJjaCwKICAgIGhyZWY6IHVybE9iamVjdC5ocmVmCiAgfTsKCiAgaWYgKHVybE9iamVjdC5wb3J0ICE9PSAiIikgewogICAgb3B0aW9ucy5wb3J0ID0gTnVtYmVyKHVybE9iamVjdC5wb3J0KTsKICB9CgogIHJldHVybiBvcHRpb25zOwp9CgpmdW5jdGlvbiByZW1vdmVNYXRjaGluZ0hlYWRlcnMocmVnZXgsIGhlYWRlcnMpIHsKICB2YXIgbGFzdFZhbHVlOwoKICBmb3IgKHZhciBoZWFkZXIgaW4gaGVhZGVycykgewogICAgaWYgKHJlZ2V4LnRlc3QoaGVhZGVyKSkgewogICAgICBsYXN0VmFsdWUgPSBoZWFkZXJzW2hlYWRlcl07CiAgICAgIGRlbGV0ZSBoZWFkZXJzW2hlYWRlcl07CiAgICB9CiAgfQoKICByZXR1cm4gbGFzdFZhbHVlOwp9CgpmdW5jdGlvbiBjcmVhdGVFcnJvclR5cGUoY29kZSwgZGVmYXVsdE1lc3NhZ2UpIHsKICBmdW5jdGlvbiBDdXN0b21FcnJvcihtZXNzYWdlKSB7CiAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTsKICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgfHwgZGVmYXVsdE1lc3NhZ2U7CiAgfQoKICBDdXN0b21FcnJvci5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTsKICBDdXN0b21FcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDdXN0b21FcnJvcjsKICBDdXN0b21FcnJvci5wcm90b3R5cGUubmFtZSA9ICJFcnJvciBbIiArIGNvZGUgKyAiXSI7CiAgQ3VzdG9tRXJyb3IucHJvdG90eXBlLmNvZGUgPSBjb2RlOwogIHJldHVybiBDdXN0b21FcnJvcjsKfQoKZnVuY3Rpb24gYWJvcnRSZXF1ZXN0KHJlcXVlc3QpIHsKICBmb3IgKHZhciBlID0gMDsgZSA8IGV2ZW50cy5sZW5ndGg7IGUrKykgewogICAgcmVxdWVzdC5yZW1vdmVMaXN0ZW5lcihldmVudHNbZV0sIGV2ZW50SGFuZGxlcnNbZXZlbnRzW2VdXSk7CiAgfQoKICByZXF1ZXN0Lm9uKCJlcnJvciIsIG5vb3ApOwogIHJlcXVlc3QuYWJvcnQoKTsKfSAvLyBFeHBvcnRzCgoKbW9kdWxlLmV4cG9ydHMgPSB3cmFwKHsKICBodHRwOiBodHRwLAogIGh0dHBzOiBodHRwcwp9KTsKbW9kdWxlLmV4cG9ydHMud3JhcCA9IHdyYXA7"},{"version":3,"sources":["D:/vscodeprojects/vuepress-theme-reco/myblogs/node_modules/follow-redirects/index.js"],"names":["url","require","URL","http","https","Writable","assert","debug","events","eventHandlers","Object","create","forEach","event","arg1","arg2","arg3","_redirectable","emit","RedirectionError","createErrorType","TooManyRedirectsError","MaxBodyLengthExceededError","WriteAfterEndError","RedirectableRequest","options","responseCallback","call","_sanitizeOptions","_options","_ended","_ending","_redirectCount","_redirects","_requestBodyLength","_requestBodyBuffers","on","self","_onNativeResponse","response","_processResponse","_performRequest","prototype","abort","abortRequest","_currentRequest","removeAllListeners","write","data","encoding","callback","TypeError","length","maxBodyLength","push","end","currentRequest","setHeader","name","value","headers","removeHeader","setTimeout","msecs","destroyOnTimeout","socket","removeListener","destroy","addListener","startTimer","_timeout","clearTimeout","clearTimer","once","method","a","b","property","defineProperty","get","host","hostname","pathname","path","searchPos","indexOf","substring","search","protocol","nativeProtocol","nativeProtocols","agents","scheme","substr","agent","request","_currentUrl","format","e","_isRedirect","i","buffers","writeNext","error","buffer","finished","statusCode","trackRedirects","location","followRedirects","maxRedirects","test","removeMatchingHeaders","previousHostName","parse","redirectUrl","resolve","redirectUrlParts","assign","beforeRedirect","responseDetails","err","cause","message","responseUrl","redirects","wrap","protocols","exports","keys","wrappedProtocol","input","urlStr","urlToOptions","equal","wrappedRequest","defineProperties","configurable","enumerable","writable","noop","urlObject","startsWith","slice","hash","href","port","Number","regex","lastValue","header","code","defaultMessage","CustomError","Error","captureStackTrace","constructor","module"],"mappings":"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","sourcesContent":["var url = require(\"url\");\nvar URL = url.URL;\nvar http = require(\"http\");\nvar https = require(\"https\");\nvar Writable = require(\"stream\").Writable;\nvar assert = require(\"assert\");\nvar debug = require(\"./debug\");\n\n// Create handlers that pass events from native requests\nvar events = [\"abort\", \"aborted\", \"connect\", \"error\", \"socket\", \"timeout\"];\nvar eventHandlers = Object.create(null);\nevents.forEach(function (event) {\n  eventHandlers[event] = function (arg1, arg2, arg3) {\n    this._redirectable.emit(event, arg1, arg2, arg3);\n  };\n});\n\n// Error types with codes\nvar RedirectionError = createErrorType(\n  \"ERR_FR_REDIRECTION_FAILURE\",\n  \"\"\n);\nvar TooManyRedirectsError = createErrorType(\n  \"ERR_FR_TOO_MANY_REDIRECTS\",\n  \"Maximum number of redirects exceeded\"\n);\nvar MaxBodyLengthExceededError = createErrorType(\n  \"ERR_FR_MAX_BODY_LENGTH_EXCEEDED\",\n  \"Request body larger than maxBodyLength limit\"\n);\nvar WriteAfterEndError = createErrorType(\n  \"ERR_STREAM_WRITE_AFTER_END\",\n  \"write after end\"\n);\n\n// An HTTP(S) request that can be redirected\nfunction RedirectableRequest(options, responseCallback) {\n  // Initialize the request\n  Writable.call(this);\n  this._sanitizeOptions(options);\n  this._options = options;\n  this._ended = false;\n  this._ending = false;\n  this._redirectCount = 0;\n  this._redirects = [];\n  this._requestBodyLength = 0;\n  this._requestBodyBuffers = [];\n\n  // Attach a callback if passed\n  if (responseCallback) {\n    this.on(\"response\", responseCallback);\n  }\n\n  // React to responses of native requests\n  var self = this;\n  this._onNativeResponse = function (response) {\n    self._processResponse(response);\n  };\n\n  // Perform the first request\n  this._performRequest();\n}\nRedirectableRequest.prototype = Object.create(Writable.prototype);\n\nRedirectableRequest.prototype.abort = function () {\n  // Abort the internal request\n  abortRequest(this._currentRequest);\n\n  // Abort this request\n  this.emit(\"abort\");\n  this.removeAllListeners();\n};\n\n// Writes buffered data to the current native request\nRedirectableRequest.prototype.write = function (data, encoding, callback) {\n  // Writing is not allowed if end has been called\n  if (this._ending) {\n    throw new WriteAfterEndError();\n  }\n\n  // Validate input and shift parameters if necessary\n  if (!(typeof data === \"string\" || typeof data === \"object\" && (\"length\" in data))) {\n    throw new TypeError(\"data should be a string, Buffer or Uint8Array\");\n  }\n  if (typeof encoding === \"function\") {\n    callback = encoding;\n    encoding = null;\n  }\n\n  // Ignore empty buffers, since writing them doesn't invoke the callback\n  // https://github.com/nodejs/node/issues/22066\n  if (data.length === 0) {\n    if (callback) {\n      callback();\n    }\n    return;\n  }\n  // Only write when we don't exceed the maximum body length\n  if (this._requestBodyLength + data.length <= this._options.maxBodyLength) {\n    this._requestBodyLength += data.length;\n    this._requestBodyBuffers.push({ data: data, encoding: encoding });\n    this._currentRequest.write(data, encoding, callback);\n  }\n  // Error when we exceed the maximum body length\n  else {\n    this.emit(\"error\", new MaxBodyLengthExceededError());\n    this.abort();\n  }\n};\n\n// Ends the current native request\nRedirectableRequest.prototype.end = function (data, encoding, callback) {\n  // Shift parameters if necessary\n  if (typeof data === \"function\") {\n    callback = data;\n    data = encoding = null;\n  }\n  else if (typeof encoding === \"function\") {\n    callback = encoding;\n    encoding = null;\n  }\n\n  // Write data if needed and end\n  if (!data) {\n    this._ended = this._ending = true;\n    this._currentRequest.end(null, null, callback);\n  }\n  else {\n    var self = this;\n    var currentRequest = this._currentRequest;\n    this.write(data, encoding, function () {\n      self._ended = true;\n      currentRequest.end(null, null, callback);\n    });\n    this._ending = true;\n  }\n};\n\n// Sets a header value on the current native request\nRedirectableRequest.prototype.setHeader = function (name, value) {\n  this._options.headers[name] = value;\n  this._currentRequest.setHeader(name, value);\n};\n\n// Clears a header value on the current native request\nRedirectableRequest.prototype.removeHeader = function (name) {\n  delete this._options.headers[name];\n  this._currentRequest.removeHeader(name);\n};\n\n// Global timeout for all underlying requests\nRedirectableRequest.prototype.setTimeout = function (msecs, callback) {\n  var self = this;\n  if (callback) {\n    this.on(\"timeout\", callback);\n  }\n\n  function destroyOnTimeout(socket) {\n    socket.setTimeout(msecs);\n    socket.removeListener(\"timeout\", socket.destroy);\n    socket.addListener(\"timeout\", socket.destroy);\n  }\n\n  // Sets up a timer to trigger a timeout event\n  function startTimer(socket) {\n    if (self._timeout) {\n      clearTimeout(self._timeout);\n    }\n    self._timeout = setTimeout(function () {\n      self.emit(\"timeout\");\n      clearTimer();\n    }, msecs);\n    destroyOnTimeout(socket);\n  }\n\n  // Prevent a timeout from triggering\n  function clearTimer() {\n    clearTimeout(this._timeout);\n    if (callback) {\n      self.removeListener(\"timeout\", callback);\n    }\n    if (!this.socket) {\n      self._currentRequest.removeListener(\"socket\", startTimer);\n    }\n  }\n\n  // Start the timer when the socket is opened\n  if (this.socket) {\n    startTimer(this.socket);\n  }\n  else {\n    this._currentRequest.once(\"socket\", startTimer);\n  }\n\n  this.on(\"socket\", destroyOnTimeout);\n  this.once(\"response\", clearTimer);\n  this.once(\"error\", clearTimer);\n\n  return this;\n};\n\n// Proxy all other public ClientRequest methods\n[\n  \"flushHeaders\", \"getHeader\",\n  \"setNoDelay\", \"setSocketKeepAlive\",\n].forEach(function (method) {\n  RedirectableRequest.prototype[method] = function (a, b) {\n    return this._currentRequest[method](a, b);\n  };\n});\n\n// Proxy all public ClientRequest properties\n[\"aborted\", \"connection\", \"socket\"].forEach(function (property) {\n  Object.defineProperty(RedirectableRequest.prototype, property, {\n    get: function () { return this._currentRequest[property]; },\n  });\n});\n\nRedirectableRequest.prototype._sanitizeOptions = function (options) {\n  // Ensure headers are always present\n  if (!options.headers) {\n    options.headers = {};\n  }\n\n  // Since http.request treats host as an alias of hostname,\n  // but the url module interprets host as hostname plus port,\n  // eliminate the host property to avoid confusion.\n  if (options.host) {\n    // Use hostname if set, because it has precedence\n    if (!options.hostname) {\n      options.hostname = options.host;\n    }\n    delete options.host;\n  }\n\n  // Complete the URL object when necessary\n  if (!options.pathname && options.path) {\n    var searchPos = options.path.indexOf(\"?\");\n    if (searchPos < 0) {\n      options.pathname = options.path;\n    }\n    else {\n      options.pathname = options.path.substring(0, searchPos);\n      options.search = options.path.substring(searchPos);\n    }\n  }\n};\n\n\n// Executes the next native request (initial or redirect)\nRedirectableRequest.prototype._performRequest = function () {\n  // Load the native protocol\n  var protocol = this._options.protocol;\n  var nativeProtocol = this._options.nativeProtocols[protocol];\n  if (!nativeProtocol) {\n    this.emit(\"error\", new TypeError(\"Unsupported protocol \" + protocol));\n    return;\n  }\n\n  // If specified, use the agent corresponding to the protocol\n  // (HTTP and HTTPS use different types of agents)\n  if (this._options.agents) {\n    var scheme = protocol.substr(0, protocol.length - 1);\n    this._options.agent = this._options.agents[scheme];\n  }\n\n  // Create the native request\n  var request = this._currentRequest =\n        nativeProtocol.request(this._options, this._onNativeResponse);\n  this._currentUrl = url.format(this._options);\n\n  // Set up event handlers\n  request._redirectable = this;\n  for (var e = 0; e < events.length; e++) {\n    request.on(events[e], eventHandlers[events[e]]);\n  }\n\n  // End a redirected request\n  // (The first request must be ended explicitly with RedirectableRequest#end)\n  if (this._isRedirect) {\n    // Write the request entity and end.\n    var i = 0;\n    var self = this;\n    var buffers = this._requestBodyBuffers;\n    (function writeNext(error) {\n      // Only write if this request has not been redirected yet\n      /* istanbul ignore else */\n      if (request === self._currentRequest) {\n        // Report any write errors\n        /* istanbul ignore if */\n        if (error) {\n          self.emit(\"error\", error);\n        }\n        // Write the next buffer if there are still left\n        else if (i < buffers.length) {\n          var buffer = buffers[i++];\n          /* istanbul ignore else */\n          if (!request.finished) {\n            request.write(buffer.data, buffer.encoding, writeNext);\n          }\n        }\n        // End the request if `end` has been called on us\n        else if (self._ended) {\n          request.end();\n        }\n      }\n    }());\n  }\n};\n\n// Processes a response from the current native request\nRedirectableRequest.prototype._processResponse = function (response) {\n  // Store the redirected response\n  var statusCode = response.statusCode;\n  if (this._options.trackRedirects) {\n    this._redirects.push({\n      url: this._currentUrl,\n      headers: response.headers,\n      statusCode: statusCode,\n    });\n  }\n\n  // RFC7231§6.4: The 3xx (Redirection) class of status code indicates\n  // that further action needs to be taken by the user agent in order to\n  // fulfill the request. If a Location header field is provided,\n  // the user agent MAY automatically redirect its request to the URI\n  // referenced by the Location field value,\n  // even if the specific status code is not understood.\n  var location = response.headers.location;\n  if (location && this._options.followRedirects !== false &&\n      statusCode >= 300 && statusCode < 400) {\n    // Abort the current request\n    abortRequest(this._currentRequest);\n    // Discard the remainder of the response to avoid waiting for data\n    response.destroy();\n\n    // RFC7231§6.4: A client SHOULD detect and intervene\n    // in cyclical redirections (i.e., \"infinite\" redirection loops).\n    if (++this._redirectCount > this._options.maxRedirects) {\n      this.emit(\"error\", new TooManyRedirectsError());\n      return;\n    }\n\n    // RFC7231§6.4: Automatic redirection needs to done with\n    // care for methods not known to be safe, […]\n    // RFC7231§6.4.2–3: For historical reasons, a user agent MAY change\n    // the request method from POST to GET for the subsequent request.\n    if ((statusCode === 301 || statusCode === 302) && this._options.method === \"POST\" ||\n        // RFC7231§6.4.4: The 303 (See Other) status code indicates that\n        // the server is redirecting the user agent to a different resource […]\n        // A user agent can perform a retrieval request targeting that URI\n        // (a GET or HEAD request if using HTTP) […]\n        (statusCode === 303) && !/^(?:GET|HEAD)$/.test(this._options.method)) {\n      this._options.method = \"GET\";\n      // Drop a possible entity and headers related to it\n      this._requestBodyBuffers = [];\n      removeMatchingHeaders(/^content-/i, this._options.headers);\n    }\n\n    // Drop the Host header, as the redirect might lead to a different host\n    var previousHostName = removeMatchingHeaders(/^host$/i, this._options.headers) ||\n      url.parse(this._currentUrl).hostname;\n\n    // Create the redirected request\n    var redirectUrl = url.resolve(this._currentUrl, location);\n    debug(\"redirecting to\", redirectUrl);\n    this._isRedirect = true;\n    var redirectUrlParts = url.parse(redirectUrl);\n    Object.assign(this._options, redirectUrlParts);\n\n    // Drop the Authorization header if redirecting to another host\n    if (redirectUrlParts.hostname !== previousHostName) {\n      removeMatchingHeaders(/^authorization$/i, this._options.headers);\n    }\n\n    // Evaluate the beforeRedirect callback\n    if (typeof this._options.beforeRedirect === \"function\") {\n      var responseDetails = { headers: response.headers };\n      try {\n        this._options.beforeRedirect.call(null, this._options, responseDetails);\n      }\n      catch (err) {\n        this.emit(\"error\", err);\n        return;\n      }\n      this._sanitizeOptions(this._options);\n    }\n\n    // Perform the redirected request\n    try {\n      this._performRequest();\n    }\n    catch (cause) {\n      var error = new RedirectionError(\"Redirected request failed: \" + cause.message);\n      error.cause = cause;\n      this.emit(\"error\", error);\n    }\n  }\n  else {\n    // The response is not a redirect; return it as-is\n    response.responseUrl = this._currentUrl;\n    response.redirects = this._redirects;\n    this.emit(\"response\", response);\n\n    // Clean up\n    this._requestBodyBuffers = [];\n  }\n};\n\n// Wraps the key/value object of protocols with redirect functionality\nfunction wrap(protocols) {\n  // Default settings\n  var exports = {\n    maxRedirects: 21,\n    maxBodyLength: 10 * 1024 * 1024,\n  };\n\n  // Wrap each protocol\n  var nativeProtocols = {};\n  Object.keys(protocols).forEach(function (scheme) {\n    var protocol = scheme + \":\";\n    var nativeProtocol = nativeProtocols[protocol] = protocols[scheme];\n    var wrappedProtocol = exports[scheme] = Object.create(nativeProtocol);\n\n    // Executes a request, following redirects\n    function request(input, options, callback) {\n      // Parse parameters\n      if (typeof input === \"string\") {\n        var urlStr = input;\n        try {\n          input = urlToOptions(new URL(urlStr));\n        }\n        catch (err) {\n          /* istanbul ignore next */\n          input = url.parse(urlStr);\n        }\n      }\n      else if (URL && (input instanceof URL)) {\n        input = urlToOptions(input);\n      }\n      else {\n        callback = options;\n        options = input;\n        input = { protocol: protocol };\n      }\n      if (typeof options === \"function\") {\n        callback = options;\n        options = null;\n      }\n\n      // Set defaults\n      options = Object.assign({\n        maxRedirects: exports.maxRedirects,\n        maxBodyLength: exports.maxBodyLength,\n      }, input, options);\n      options.nativeProtocols = nativeProtocols;\n\n      assert.equal(options.protocol, protocol, \"protocol mismatch\");\n      debug(\"options\", options);\n      return new RedirectableRequest(options, callback);\n    }\n\n    // Executes a GET request, following redirects\n    function get(input, options, callback) {\n      var wrappedRequest = wrappedProtocol.request(input, options, callback);\n      wrappedRequest.end();\n      return wrappedRequest;\n    }\n\n    // Expose the properties on the wrapped protocol\n    Object.defineProperties(wrappedProtocol, {\n      request: { value: request, configurable: true, enumerable: true, writable: true },\n      get: { value: get, configurable: true, enumerable: true, writable: true },\n    });\n  });\n  return exports;\n}\n\n/* istanbul ignore next */\nfunction noop() { /* empty */ }\n\n// from https://github.com/nodejs/node/blob/master/lib/internal/url.js\nfunction urlToOptions(urlObject) {\n  var options = {\n    protocol: urlObject.protocol,\n    hostname: urlObject.hostname.startsWith(\"[\") ?\n      /* istanbul ignore next */\n      urlObject.hostname.slice(1, -1) :\n      urlObject.hostname,\n    hash: urlObject.hash,\n    search: urlObject.search,\n    pathname: urlObject.pathname,\n    path: urlObject.pathname + urlObject.search,\n    href: urlObject.href,\n  };\n  if (urlObject.port !== \"\") {\n    options.port = Number(urlObject.port);\n  }\n  return options;\n}\n\nfunction removeMatchingHeaders(regex, headers) {\n  var lastValue;\n  for (var header in headers) {\n    if (regex.test(header)) {\n      lastValue = headers[header];\n      delete headers[header];\n    }\n  }\n  return lastValue;\n}\n\nfunction createErrorType(code, defaultMessage) {\n  function CustomError(message) {\n    Error.captureStackTrace(this, this.constructor);\n    this.message = message || defaultMessage;\n  }\n  CustomError.prototype = new Error();\n  CustomError.prototype.constructor = CustomError;\n  CustomError.prototype.name = \"Error [\" + code + \"]\";\n  CustomError.prototype.code = code;\n  return CustomError;\n}\n\nfunction abortRequest(request) {\n  for (var e = 0; e < events.length; e++) {\n    request.removeListener(events[e], eventHandlers[events[e]]);\n  }\n  request.on(\"error\", noop);\n  request.abort();\n}\n\n// Exports\nmodule.exports = wrap({ http: http, https: https });\nmodule.exports.wrap = wrap;\n"]}]}