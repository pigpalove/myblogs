{"remainingRequest":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\babel-loader\\lib\\index.js??ref--3-1!D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\@vssue\\api-gitlab-v4\\lib\\index.js","dependencies":[{"path":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\@vssue\\api-gitlab-v4\\lib\\index.js","mtime":499162500000},{"path":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vscodeprojects\\vuepress-theme-reco\\myblogs\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkQ6L3ZzY29kZXByb2plY3RzL3Z1ZXByZXNzLXRoZW1lLXJlY28vbXlibG9ncy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICJEOi92c2NvZGVwcm9qZWN0cy92dWVwcmVzcy10aGVtZS1yZWNvL215YmxvZ3Mvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRDovdnNjb2RlcHJvamVjdHMvdnVlcHJlc3MtdGhlbWUtcmVjby9teWJsb2dzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJEOi92c2NvZGVwcm9qZWN0cy92dWVwcmVzcy10aGVtZS1yZWNvL215YmxvZ3Mvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJEOi92c2NvZGVwcm9qZWN0cy92dWVwcmVzcy10aGVtZS1yZWNvL215YmxvZ3Mvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNlYXJjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgYnVpbGRRdWVyeSwgYnVpbGRVUkwsIGNvbmNhdFVSTCwgZ2V0Q2xlYW5VUkwsIHBhcnNlUXVlcnkgfSBmcm9tICdAdnNzdWUvdXRpbHMnOwppbXBvcnQgeyBub3JtYWxpemVVc2VyLCBub3JtYWxpemVJc3N1ZSwgbm9ybWFsaXplQ29tbWVudCwgbm9ybWFsaXplUmVhY3Rpb25zLCBtYXBSZWFjdGlvbk5hbWUgfSBmcm9tICcuL3V0aWxzJzsKLyoqCiAqIEdpdExhYiBBUEkgVjQKICoKICogQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvCiAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL29hdXRoMi5odG1sCiAqLwoKdmFyIEdpdGxhYlY0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBHaXRsYWJWNChfcmVmKSB7CiAgICB2YXIgX3JlZiRiYXNlVVJMID0gX3JlZi5iYXNlVVJMLAogICAgICAgIGJhc2VVUkwgPSBfcmVmJGJhc2VVUkwgPT09IHZvaWQgMCA/ICdodHRwczovL2dpdGxhYi5jb20nIDogX3JlZiRiYXNlVVJMLAogICAgICAgIG93bmVyID0gX3JlZi5vd25lciwKICAgICAgICByZXBvID0gX3JlZi5yZXBvLAogICAgICAgIGxhYmVscyA9IF9yZWYubGFiZWxzLAogICAgICAgIGNsaWVudElkID0gX3JlZi5jbGllbnRJZCwKICAgICAgICBzdGF0ZSA9IF9yZWYuc3RhdGU7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdpdGxhYlY0KTsKCiAgICB0aGlzLmJhc2VVUkwgPSBiYXNlVVJMOwogICAgdGhpcy5vd25lciA9IG93bmVyOwogICAgdGhpcy5yZXBvID0gcmVwbzsKICAgIHRoaXMubGFiZWxzID0gbGFiZWxzOwogICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkOwogICAgdGhpcy5zdGF0ZSA9IHN0YXRlOyAvLyBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9SRUFETUUuaHRtbCNuYW1lc3BhY2VkLXBhdGgtZW5jb2RpbmcKCiAgICB0aGlzLl9lbmNvZGVkUmVwbyA9IGVuY29kZVVSSUNvbXBvbmVudCgiIi5jb25jYXQodGhpcy5vd25lciwgIi8iKS5jb25jYXQodGhpcy5yZXBvKSk7CiAgICB0aGlzLiRodHRwID0gYXhpb3MuY3JlYXRlKHsKICAgICAgYmFzZVVSTDogY29uY2F0VVJMKGJhc2VVUkwsICdhcGkvdjQnKSwKICAgICAgaGVhZGVyczogewogICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgIH0KICAgIH0pOwogIH0KICAvKioKICAgKiBUaGUgcGxhdGZvcm0gYXBpIGluZm8KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhHaXRsYWJWNCwgW3sKICAgIGtleTogInBsYXRmb3JtIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICdHaXRMYWInLAogICAgICAgIGxpbms6IHRoaXMuYmFzZVVSTCwKICAgICAgICB2ZXJzaW9uOiAndjQnLAogICAgICAgIG1ldGE6IHsKICAgICAgICAgIHJlYWN0YWJsZTogdHJ1ZSwKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfQogICAgICB9OwogICAgfQogICAgLyoqCiAgICAgKiBSZWRpcmVjdCB0byB0aGUgYXV0aG9yaXphdGlvbiBwYWdlIG9mIHBsYXRmb3JtLgogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL29hdXRoMi5odG1sIzEtcmVxdWVzdGluZy1hdXRob3JpemF0aW9uLWNvZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZWRpcmVjdEF1dGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZGlyZWN0QXV0aCgpIHsKICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBidWlsZFVSTChjb25jYXRVUkwodGhpcy5iYXNlVVJMLCAnb2F1dGgvYXV0aG9yaXplJyksIHsKICAgICAgICBjbGllbnRfaWQ6IHRoaXMuY2xpZW50SWQsCiAgICAgICAgcmVkaXJlY3RfdXJpOiB3aW5kb3cubG9jYXRpb24uaHJlZiwKICAgICAgICByZXNwb25zZV90eXBlOiAndG9rZW4nLAogICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlCiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBIYW5kbGUgYXV0aG9yaXphdGlvbi4KICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9vYXV0aDIuaHRtbCNpbXBsaWNpdC1ncmFudC1mbG93CiAgICAgKgogICAgICogQHJlbWFya3MKICAgICAqIElmIHRoZSBgYWNjZXNzX3Rva2VuYCBhbmQgYHN0YXRlYCBleGlzdCBpbiB0aGUgcXVlcnksIGFuZCB0aGUgYHN0YXRlYCBtYXRjaGVzLCByZW1vdmUgdGhlbSBmcm9tIHF1ZXJ5LCBhbmQgcmV0dXJuIHRoZSBhY2Nlc3MgdG9rZW4uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaGFuZGxlQXV0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2hhbmRsZUF1dGggPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGhhc2gsIGFjY2Vzc1Rva2VuLCBoYXNoU3RyaW5nLCBuZXdIYXNoLCByZXBsYWNlVVJMOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGhhc2ggPSBwYXJzZVF1ZXJ5KHdpbmRvdy5sb2NhdGlvbi5oYXNoLnNsaWNlKDEpKTsKCiAgICAgICAgICAgICAgICBpZiAoISghaGFzaC5hY2Nlc3NfdG9rZW4gfHwgaGFzaC5zdGF0ZSAhPT0gdGhpcy5zdGF0ZSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIG51bGwpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IGhhc2guYWNjZXNzX3Rva2VuOwogICAgICAgICAgICAgICAgZGVsZXRlIGhhc2guYWNjZXNzX3Rva2VuOwogICAgICAgICAgICAgICAgZGVsZXRlIGhhc2gudG9rZW5fdHlwZTsKICAgICAgICAgICAgICAgIGRlbGV0ZSBoYXNoLmV4cGlyZXNfaW47CiAgICAgICAgICAgICAgICBkZWxldGUgaGFzaC5zdGF0ZTsKICAgICAgICAgICAgICAgIGhhc2hTdHJpbmcgPSBidWlsZFF1ZXJ5KGhhc2gpOwogICAgICAgICAgICAgICAgbmV3SGFzaCA9IGhhc2hTdHJpbmcgPyAiIyIuY29uY2F0KGhhc2hTdHJpbmcpIDogJyc7CiAgICAgICAgICAgICAgICByZXBsYWNlVVJMID0gIiIuY29uY2F0KGdldENsZWFuVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKSkuY29uY2F0KHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpLmNvbmNhdChuZXdIYXNoKTsKICAgICAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCAnJywgcmVwbGFjZVVSTCk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBhY2Nlc3NUb2tlbik7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaGFuZGxlQXV0aCgpIHsKICAgICAgICByZXR1cm4gX2hhbmRsZUF1dGguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGhhbmRsZUF1dGg7CiAgICB9KCkKICAgIC8qKgogICAgICogR2V0IHRoZSBsb2dnZWQtaW4gdXNlciB3aXRoIGFjY2VzcyB0b2tlbi4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRVc2VyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0VXNlciA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoX3JlZjIpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIF95aWVsZCR0aGlzJCRodHRwJGdldCwgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjIuYWNjZXNzVG9rZW47CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5nZXQoJ3VzZXInLCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkZ2V0ID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkZ2V0LmRhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgbm9ybWFsaXplVXNlcihkYXRhKSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldFVzZXIoX3gpIHsKICAgICAgICByZXR1cm4gX2dldFVzZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldFVzZXI7CiAgICB9KCkKICAgIC8qKgogICAgICogR2V0IGlzc3VlIG9mIHRoaXMgcGFnZSBhY2NvcmRpbmcgdG8gdGhlIGlzc3VlIGlkIG9yIHRoZSBpc3N1ZSB0aXRsZQogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL2lzc3Vlcy5odG1sI3NpbmdsZS1pc3N1ZQogICAgICogQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvaXNzdWVzLmh0bWwjbGlzdC1pc3N1ZXMKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL1JFQURNRS5odG1sI3BhZ2luYXRpb24KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRJc3N1ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldElzc3VlID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhfcmVmMykgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgaXNzdWVJZCwgaXNzdWVUaXRsZSwgb3B0aW9ucywgX3lpZWxkJHRoaXMkJGh0dHAkZ2V0MiwgZGF0YSwgX3lpZWxkJHRoaXMkJGh0dHAkZ2V0MywgX2RhdGEsIGlzc3VlOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmMy5hY2Nlc3NUb2tlbiwgaXNzdWVJZCA9IF9yZWYzLmlzc3VlSWQsIGlzc3VlVGl0bGUgPSBfcmVmMy5pc3N1ZVRpdGxlOwogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHt9OwoKICAgICAgICAgICAgICAgIGlmIChhY2Nlc3NUb2tlbikgewogICAgICAgICAgICAgICAgICBvcHRpb25zLmhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoIWlzc3VlSWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSA0OwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KCJwcm9qZWN0cy8iLmNvbmNhdCh0aGlzLl9lbmNvZGVkUmVwbywgIi9pc3N1ZXMvIikuY29uY2F0KGlzc3VlSWQpLCBvcHRpb25zKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkZ2V0MiA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJGdldDIuZGF0YTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVJc3N1ZShkYXRhKSk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDEyOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLnQwID0gX2NvbnRleHQzWyJjYXRjaCJdKDQpOwoKICAgICAgICAgICAgICAgIGlmICghKF9jb250ZXh0My50MC5yZXNwb25zZSAmJiBfY29udGV4dDMudDAucmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBudWxsKTsKCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgIHRocm93IF9jb250ZXh0My50MDsKCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjg7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICAgIG9wdGlvbnMucGFyYW1zID0gewogICAgICAgICAgICAgICAgICBsYWJlbHM6IHRoaXMubGFiZWxzLmpvaW4oJywnKSwKICAgICAgICAgICAgICAgICAgb3JkZXJfYnk6ICdjcmVhdGVkX2F0JywKICAgICAgICAgICAgICAgICAgc29ydDogJ2FzYycsCiAgICAgICAgICAgICAgICAgIHNlYXJjaDogaXNzdWVUaXRsZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjQ7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5nZXQoInByb2plY3RzLyIuY29uY2F0KHRoaXMuX2VuY29kZWRSZXBvLCAiL2lzc3VlcyIpLCBvcHRpb25zKTsKCiAgICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJGdldDMgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgICAgIF9kYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkZ2V0My5kYXRhOwogICAgICAgICAgICAgICAgaXNzdWUgPSBfZGF0YS5tYXAobm9ybWFsaXplSXNzdWUpLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0udGl0bGUgPT09IGlzc3VlVGl0bGU7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBpc3N1ZSB8fCBudWxsKTsKCiAgICAgICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcywgW1s0LCAxMl1dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0SXNzdWUoX3gyKSB7CiAgICAgICAgcmV0dXJuIF9nZXRJc3N1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0SXNzdWU7CiAgICB9KCkKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IGlzc3VlCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvaXNzdWVzLmh0bWwjbmV3LWlzc3VlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicG9zdElzc3VlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcG9zdElzc3VlID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChfcmVmNCkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgdGl0bGUsIGNvbnRlbnQsIF95aWVsZCR0aGlzJCRodHRwJHBvcywgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjQuYWNjZXNzVG9rZW4sIHRpdGxlID0gX3JlZjQudGl0bGUsIGNvbnRlbnQgPSBfcmVmNC5jb250ZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgicHJvamVjdHMvIi5jb25jYXQodGhpcy5fZW5jb2RlZFJlcG8sICIvaXNzdWVzIiksIHsKICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLAogICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogY29udGVudCwKICAgICAgICAgICAgICAgICAgbGFiZWxzOiB0aGlzLmxhYmVscy5qb2luKCcsJykKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwb3MgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3MuZGF0YTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVJc3N1ZShkYXRhKSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHBvc3RJc3N1ZShfeDMpIHsKICAgICAgICByZXR1cm4gX3Bvc3RJc3N1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gcG9zdElzc3VlOwogICAgfSgpCiAgICAvKioKICAgICAqIEdldCBjb21tZW50cyBvZiB0aGlzIHBhZ2UgYWNjb3JkaW5nIHRvIHRoZSBpc3N1ZSBpZAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL25vdGVzLmh0bWwjbGlzdC1wcm9qZWN0LWlzc3VlLW5vdGVzCiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9SRUFETUUuaHRtbCNwYWdpbmF0aW9uCiAgICAgKgogICAgICogQHJlbWFya3MKICAgICAqIENhbm5vdCBnZXQgdGhlIEhUTUwgY29udGVudCBhbmQgdGhlIHJlYWN0aW9ucyAoYXdhcmRfZW1vamkpIGhlcmUuCiAgICAgKiBTbyBoYXZlIHRvIHJlcXVlc3QgdGhlbSB2aWEgYG1hcmtkb3duYCBhbmQgYGF3YXJkX2Vtb2ppYCBBUEkuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Q29tbWVudHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRDb21tZW50cyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoX3JlZjUpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGlzc3VlSWQsIF9yZWY1JHF1ZXJ5LCBfcmVmNSRxdWVyeSRwYWdlLCBwYWdlLCBfcmVmNSRxdWVyeSRwZXJQYWdlLCBwZXJQYWdlLCBfcmVmNSRxdWVyeSRzb3J0LCBzb3J0LCBvcHRpb25zLCByZXNwb25zZSwgY29tbWVudHNSYXcsIGdldENvbW1lbnRzTWV0YSwgX2l0ZXJhdG9yLCBfc3RlcCwgX2xvb3A7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWY1LmFjY2Vzc1Rva2VuLCBpc3N1ZUlkID0gX3JlZjUuaXNzdWVJZCwgX3JlZjUkcXVlcnkgPSBfcmVmNS5xdWVyeTsKICAgICAgICAgICAgICAgIF9yZWY1JHF1ZXJ5ID0gX3JlZjUkcXVlcnkgPT09IHZvaWQgMCA/IHt9IDogX3JlZjUkcXVlcnk7CiAgICAgICAgICAgICAgICBfcmVmNSRxdWVyeSRwYWdlID0gX3JlZjUkcXVlcnkucGFnZSwgcGFnZSA9IF9yZWY1JHF1ZXJ5JHBhZ2UgPT09IHZvaWQgMCA/IDEgOiBfcmVmNSRxdWVyeSRwYWdlLCBfcmVmNSRxdWVyeSRwZXJQYWdlID0gX3JlZjUkcXVlcnkucGVyUGFnZSwgcGVyUGFnZSA9IF9yZWY1JHF1ZXJ5JHBlclBhZ2UgPT09IHZvaWQgMCA/IDEwIDogX3JlZjUkcXVlcnkkcGVyUGFnZSwgX3JlZjUkcXVlcnkkc29ydCA9IF9yZWY1JHF1ZXJ5LnNvcnQsIHNvcnQgPSBfcmVmNSRxdWVyeSRzb3J0ID09PSB2b2lkIDAgPyAnZGVzYycgOiBfcmVmNSRxdWVyeSRzb3J0OwogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgLy8gcGFnaW5hdGlvbgogICAgICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2UsCiAgICAgICAgICAgICAgICAgICAgcGVyX3BhZ2U6IHBlclBhZ2UsCiAgICAgICAgICAgICAgICAgICAgb3JkZXJfYnk6ICdjcmVhdGVkX2F0JywKICAgICAgICAgICAgICAgICAgICBzb3J0OiBzb3J0CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgaWYgKGFjY2Vzc1Rva2VuKSB7CiAgICAgICAgICAgICAgICAgIG9wdGlvbnMuaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLmdldCgicHJvamVjdHMvIi5jb25jYXQodGhpcy5fZW5jb2RlZFJlcG8sICIvaXNzdWVzLyIpLmNvbmNhdChpc3N1ZUlkLCAiL25vdGVzIiksIG9wdGlvbnMpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0Ny5zZW50OwogICAgICAgICAgICAgICAgY29tbWVudHNSYXcgPSByZXNwb25zZS5kYXRhOyAvLyBnaXRsYWIgYXBpIHY0IHNob3VsZCBnZXQgcGFyc2VkIG1hcmtkb3duIGNvbnRlbnQgYW5kIHJlYWN0aW9ucyBieSBvdGhlciBhcGkKICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgcG90ZW50aWFsbHkgdG8gY2F1c2UgNDI5IFRvbyBNYW55IFJlcXVlc3RzCgogICAgICAgICAgICAgICAgZ2V0Q29tbWVudHNNZXRhID0gW107CiAgICAgICAgICAgICAgICBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihjb21tZW50c1Jhdyk7CgogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgY29tbWVudCA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIGdldENvbW1lbnRzTWV0YS5wdXNoKF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5nZXRNYXJrZG93bkNvbnRlbnQoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhY2Nlc3NUb2tlbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UmF3OiBjb21tZW50LmJvZHkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50LmJvZHlfaHRtbCA9IF9jb250ZXh0NS5zZW50OwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICAgICAgICAgICAgICAgIH0pKSgpKTsKICAgICAgICAgICAgICAgICAgICBnZXRDb21tZW50c01ldGEucHVzaChfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZ2V0Q29tbWVudFJlYWN0aW9ucyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IGFjY2Vzc1Rva2VuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzc3VlSWQ6IGlzc3VlSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudElkOiBjb21tZW50LmlkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudC5yZWFjdGlvbnMgPSBfY29udGV4dDYuc2VudDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU2KTsKICAgICAgICAgICAgICAgICAgICB9KSkoKSk7CiAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgICAgICAgICAgIF9sb29wKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGdldENvbW1lbnRzTWV0YSk7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgewogICAgICAgICAgICAgICAgICBjb3VudDogTnVtYmVyKHJlc3BvbnNlLmhlYWRlcnNbJ3gtdG90YWwnXSksCiAgICAgICAgICAgICAgICAgIHBhZ2U6IE51bWJlcihyZXNwb25zZS5oZWFkZXJzWyd4LXBhZ2UnXSksCiAgICAgICAgICAgICAgICAgIHBlclBhZ2U6IE51bWJlcihyZXNwb25zZS5oZWFkZXJzWyd4LXBlci1wYWdlJ10pLAogICAgICAgICAgICAgICAgICBkYXRhOiBjb21tZW50c1Jhdy5tYXAobm9ybWFsaXplQ29tbWVudCkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0Q29tbWVudHMoX3g0KSB7CiAgICAgICAgcmV0dXJuIF9nZXRDb21tZW50cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0Q29tbWVudHM7CiAgICB9KCkKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IGNvbW1lbnQKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9ub3Rlcy5odG1sI2NyZWF0ZS1uZXctaXNzdWUtbm90ZQogICAgICovCgogIH0sIHsKICAgIGtleTogInBvc3RDb21tZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcG9zdENvbW1lbnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KF9yZWY4KSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBpc3N1ZUlkLCBjb250ZW50LCBfeWllbGQkdGhpcyQkaHR0cCRwb3MyLCBkYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmOC5hY2Nlc3NUb2tlbiwgaXNzdWVJZCA9IF9yZWY4Lmlzc3VlSWQsIGNvbnRlbnQgPSBfcmVmOC5jb250ZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgicHJvamVjdHMvIi5jb25jYXQodGhpcy5fZW5jb2RlZFJlcG8sICIvaXNzdWVzLyIpLmNvbmNhdChpc3N1ZUlkLCAiL25vdGVzIiksIHsKICAgICAgICAgICAgICAgICAgYm9keTogY29udGVudAogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHBvczIgPSBfY29udGV4dDguc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3MyLmRhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgbm9ybWFsaXplQ29tbWVudChkYXRhKSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOCwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHBvc3RDb21tZW50KF94NSkgewogICAgICAgIHJldHVybiBfcG9zdENvbW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvc3RDb21tZW50OwogICAgfSgpCiAgICAvKioKICAgICAqIEVkaXQgYSBjb21tZW50CiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvbm90ZXMuaHRtbCNtb2RpZnktZXhpc3RpbmctaXNzdWUtbm90ZQogICAgICovCgogIH0sIHsKICAgIGtleTogInB1dENvbW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9wdXRDb21tZW50ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOShfcmVmOSkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgaXNzdWVJZCwgY29tbWVudElkLCBjb250ZW50LCBfeWllbGQkdGhpcyQkaHR0cCRwdXQsIGRhdGEsIF95aWVsZCRQcm9taXNlJGFsbCwgX3lpZWxkJFByb21pc2UkYWxsMiwgY29udGVudEhUTUwsIHJlYWN0aW9uczsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjkuYWNjZXNzVG9rZW4sIGlzc3VlSWQgPSBfcmVmOS5pc3N1ZUlkLCBjb21tZW50SWQgPSBfcmVmOS5jb21tZW50SWQsIGNvbnRlbnQgPSBfcmVmOS5jb250ZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucHV0KCJwcm9qZWN0cy8iLmNvbmNhdCh0aGlzLl9lbmNvZGVkUmVwbywgIi9pc3N1ZXMvIikuY29uY2F0KGlzc3VlSWQsICIvbm90ZXMvIikuY29uY2F0KGNvbW1lbnRJZCksIHsKICAgICAgICAgICAgICAgICAgYm9keTogY29udGVudAogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHB1dCA9IF9jb250ZXh0OS5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJHB1dC5kYXRhOwogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldE1hcmtkb3duQ29udGVudCh7CiAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhY2Nlc3NUb2tlbiwKICAgICAgICAgICAgICAgICAgY29udGVudFJhdzogZGF0YS5ib2R5CiAgICAgICAgICAgICAgICB9KSwgdGhpcy5nZXRDb21tZW50UmVhY3Rpb25zKHsKICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IGFjY2Vzc1Rva2VuLAogICAgICAgICAgICAgICAgICBpc3N1ZUlkOiBpc3N1ZUlkLAogICAgICAgICAgICAgICAgICBjb21tZW50SWQ6IGRhdGEuaWQKICAgICAgICAgICAgICAgIH0pXSk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIF95aWVsZCRQcm9taXNlJGFsbCA9IF9jb250ZXh0OS5zZW50OwogICAgICAgICAgICAgICAgX3lpZWxkJFByb21pc2UkYWxsMiA9IF9zbGljZWRUb0FycmF5KF95aWVsZCRQcm9taXNlJGFsbCwgMik7CiAgICAgICAgICAgICAgICBjb250ZW50SFRNTCA9IF95aWVsZCRQcm9taXNlJGFsbDJbMF07CiAgICAgICAgICAgICAgICByZWFjdGlvbnMgPSBfeWllbGQkUHJvbWlzZSRhbGwyWzFdOwogICAgICAgICAgICAgICAgZGF0YS5ib2R5X2h0bWwgPSBjb250ZW50SFRNTDsKICAgICAgICAgICAgICAgIGRhdGEucmVhY3Rpb25zID0gcmVhY3Rpb25zOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZUNvbW1lbnQoZGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU5LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcHV0Q29tbWVudChfeDYpIHsKICAgICAgICByZXR1cm4gX3B1dENvbW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHB1dENvbW1lbnQ7CiAgICB9KCkKICAgIC8qKgogICAgICogRGVsZXRlIGEgY29tbWVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL25vdGVzLmh0bWwjZGVsZXRlLWFuLWlzc3VlLW5vdGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkZWxldGVDb21tZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZGVsZXRlQ29tbWVudCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKF9yZWYxMCkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgaXNzdWVJZCwgY29tbWVudElkLCBfeWllbGQkdGhpcyQkaHR0cCRkZWwsIHN0YXR1czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWYxMC5hY2Nlc3NUb2tlbiwgaXNzdWVJZCA9IF9yZWYxMC5pc3N1ZUlkLCBjb21tZW50SWQgPSBfcmVmMTAuY29tbWVudElkOwogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwWyJkZWxldGUiXSgicHJvamVjdHMvIi5jb25jYXQodGhpcy5fZW5jb2RlZFJlcG8sICIvaXNzdWVzLyIpLmNvbmNhdChpc3N1ZUlkLCAiL25vdGVzLyIpLmNvbmNhdChjb21tZW50SWQpLCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkZGVsID0gX2NvbnRleHQxMC5zZW50OwogICAgICAgICAgICAgICAgc3RhdHVzID0gX3lpZWxkJHRoaXMkJGh0dHAkZGVsLnN0YXR1czsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdCgicmV0dXJuIiwgc3RhdHVzID09PSAyMDQpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMCwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGRlbGV0ZUNvbW1lbnQoX3g3KSB7CiAgICAgICAgcmV0dXJuIF9kZWxldGVDb21tZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZWxldGVDb21tZW50OwogICAgfSgpCiAgICAvKioKICAgICAqIEdldCByZWFjdGlvbnMgb2YgYSBjb21tZW50CiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvYXdhcmRfZW1vamkuaHRtbCNsaXN0LWFuLWF3YXJkYWJsZXMtYXdhcmQtZW1vamkKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDb21tZW50UmVhY3Rpb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0Q29tbWVudFJlYWN0aW9ucyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKF9yZWYxMSkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgaXNzdWVJZCwgY29tbWVudElkLCBfeWllbGQkdGhpcyQkaHR0cCRnZXQ0LCBkYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTExJChfY29udGV4dDExKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjExLmFjY2Vzc1Rva2VuLCBpc3N1ZUlkID0gX3JlZjExLmlzc3VlSWQsIGNvbW1lbnRJZCA9IF9yZWYxMS5jb21tZW50SWQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KCJwcm9qZWN0cy8iLmNvbmNhdCh0aGlzLl9lbmNvZGVkUmVwbywgIi9pc3N1ZXMvIikuY29uY2F0KGlzc3VlSWQsICIvbm90ZXMvIikuY29uY2F0KGNvbW1lbnRJZCwgIi9hd2FyZF9lbW9qaSIpLCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkZ2V0NCA9IF9jb250ZXh0MTEuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRnZXQ0LmRhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZVJlYWN0aW9ucyhkYXRhKSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0Q29tbWVudFJlYWN0aW9ucyhfeDgpIHsKICAgICAgICByZXR1cm4gX2dldENvbW1lbnRSZWFjdGlvbnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldENvbW1lbnRSZWFjdGlvbnM7CiAgICB9KCkKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IHJlYWN0aW9uIG9mIGEgY29tbWVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL2F3YXJkX2Vtb2ppLmh0bWwjYXdhcmQtYS1uZXctZW1vamkKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwb3N0Q29tbWVudFJlYWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcG9zdENvbW1lbnRSZWFjdGlvbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKF9yZWYxMikgewogICAgICAgIHZhciBpc3N1ZUlkLCBjb21tZW50SWQsIHJlYWN0aW9uLCBhY2Nlc3NUb2tlbiwgcmVzcG9uc2U7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpc3N1ZUlkID0gX3JlZjEyLmlzc3VlSWQsIGNvbW1lbnRJZCA9IF9yZWYxMi5jb21tZW50SWQsIHJlYWN0aW9uID0gX3JlZjEyLnJlYWN0aW9uLCBhY2Nlc3NUb2tlbiA9IF9yZWYxMi5hY2Nlc3NUb2tlbjsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTIucHJldiA9IDE7CiAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgicHJvamVjdHMvIi5jb25jYXQodGhpcy5fZW5jb2RlZFJlcG8sICIvaXNzdWVzLyIpLmNvbmNhdChpc3N1ZUlkLCAiL25vdGVzLyIpLmNvbmNhdChjb21tZW50SWQsICIvYXdhcmRfZW1vamkiKSwgewogICAgICAgICAgICAgICAgICBuYW1lOiBtYXBSZWFjdGlvbk5hbWUocmVhY3Rpb24pCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDEyLnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5hYnJ1cHQoInJldHVybiIsIHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAxKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgX2NvbnRleHQxMi5wcmV2ID0gODsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTIudDAgPSBfY29udGV4dDEyWyJjYXRjaCJdKDEpOwoKICAgICAgICAgICAgICAgIGlmICghKF9jb250ZXh0MTIudDAucmVzcG9uc2UgJiYgX2NvbnRleHQxMi50MC5yZXNwb25zZS5zdGF0dXMgPT09IDQwNCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQxMi50MDsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEyLCB0aGlzLCBbWzEsIDhdXSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHBvc3RDb21tZW50UmVhY3Rpb24oX3g5KSB7CiAgICAgICAgcmV0dXJuIF9wb3N0Q29tbWVudFJlYWN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwb3N0Q29tbWVudFJlYWN0aW9uOwogICAgfSgpCiAgICAvKioKICAgICAqIEdldCB0aGUgcGFyc2UgSFRNTCBvZiBtYXJrZG93biBjb250ZW50CiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvbWFya2Rvd24uaHRtbAogICAgICovCgogIH0sIHsKICAgIGtleTogImdldE1hcmtkb3duQ29udGVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldE1hcmtkb3duQ29udGVudCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKF9yZWYxMykgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgY29udGVudFJhdywgb3B0aW9ucywgX3lpZWxkJHRoaXMkJGh0dHAkcG9zMywgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMyQoX2NvbnRleHQxMykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWYxMy5hY2Nlc3NUb2tlbiwgY29udGVudFJhdyA9IF9yZWYxMy5jb250ZW50UmF3OwogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHt9OwoKICAgICAgICAgICAgICAgIGlmIChhY2Nlc3NUb2tlbikgewogICAgICAgICAgICAgICAgICBvcHRpb25zLmhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgibWFya2Rvd24iLCB7CiAgICAgICAgICAgICAgICAgIHRleHQ6IGNvbnRlbnRSYXcsCiAgICAgICAgICAgICAgICAgIGdmbTogdHJ1ZQogICAgICAgICAgICAgICAgfSwgb3B0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHBvczMgPSBfY29udGV4dDEzLnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkcG9zMy5kYXRhOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuYWJydXB0KCJyZXR1cm4iLCBkYXRhLmh0bWwpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMywgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldE1hcmtkb3duQ29udGVudChfeDEwKSB7CiAgICAgICAgcmV0dXJuIF9nZXRNYXJrZG93bkNvbnRlbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldE1hcmtkb3duQ29udGVudDsKICAgIH0oKQogIH1dKTsKCiAgcmV0dXJuIEdpdGxhYlY0Owp9KCk7CgpleHBvcnQgeyBHaXRsYWJWNCBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import axios from 'axios';\nimport { buildQuery, buildURL, concatURL, getCleanURL, parseQuery, } from '@vssue/utils';\nimport { normalizeUser, normalizeIssue, normalizeComment, normalizeReactions, mapReactionName, } from './utils';\n/**\n * GitLab API V4\n *\n * @see https://docs.gitlab.com/ce/api/\n * @see https://docs.gitlab.com/ce/api/oauth2.html\n */\nexport default class GitlabV4 {\n    constructor({ baseURL = 'https://gitlab.com', owner, repo, labels, clientId, state, }) {\n        this.baseURL = baseURL;\n        this.owner = owner;\n        this.repo = repo;\n        this.labels = labels;\n        this.clientId = clientId;\n        this.state = state;\n        // @see https://docs.gitlab.com/ce/api/README.html#namespaced-path-encoding\n        this._encodedRepo = encodeURIComponent(`${this.owner}/${this.repo}`);\n        this.$http = axios.create({\n            baseURL: concatURL(baseURL, 'api/v4'),\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n    /**\n     * The platform api info\n     */\n    get platform() {\n        return {\n            name: 'GitLab',\n            link: this.baseURL,\n            version: 'v4',\n            meta: {\n                reactable: true,\n                sortable: true,\n            },\n        };\n    }\n    /**\n     * Redirect to the authorization page of platform.\n     *\n     * @see https://docs.gitlab.com/ce/api/oauth2.html#1-requesting-authorization-code\n     */\n    redirectAuth() {\n        window.location.href = buildURL(concatURL(this.baseURL, 'oauth/authorize'), {\n            client_id: this.clientId,\n            redirect_uri: window.location.href,\n            response_type: 'token',\n            state: this.state,\n        });\n    }\n    /**\n     * Handle authorization.\n     *\n     * @see https://docs.gitlab.com/ce/api/oauth2.html#implicit-grant-flow\n     *\n     * @remarks\n     * If the `access_token` and `state` exist in the query, and the `state` matches, remove them from query, and return the access token.\n     */\n    async handleAuth() {\n        const hash = parseQuery(window.location.hash.slice(1));\n        if (!hash.access_token || hash.state !== this.state) {\n            return null;\n        }\n        const accessToken = hash.access_token;\n        delete hash.access_token;\n        delete hash.token_type;\n        delete hash.expires_in;\n        delete hash.state;\n        const hashString = buildQuery(hash);\n        const newHash = hashString ? `#${hashString}` : '';\n        const replaceURL = `${getCleanURL(window.location.href)}${window.location.search}${newHash}`;\n        window.history.replaceState(null, '', replaceURL);\n        return accessToken;\n    }\n    /**\n     * Get the logged-in user with access token.\n     */\n    async getUser({ accessToken, }) {\n        const { data } = await this.$http.get('user', {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeUser(data);\n    }\n    /**\n     * Get issue of this page according to the issue id or the issue title\n     *\n     * @see https://docs.gitlab.com/ce/api/issues.html#single-issue\n     * @see https://docs.gitlab.com/ce/api/issues.html#list-issues\n     * @see https://docs.gitlab.com/ce/api/README.html#pagination\n     */\n    async getIssue({ accessToken, issueId, issueTitle, }) {\n        const options = {};\n        if (accessToken) {\n            options.headers = {\n                Authorization: `Bearer ${accessToken}`,\n            };\n        }\n        if (issueId) {\n            try {\n                const { data } = await this.$http.get(`projects/${this._encodedRepo}/issues/${issueId}`, options);\n                return normalizeIssue(data);\n            }\n            catch (e) {\n                if (e.response && e.response.status === 404) {\n                    return null;\n                }\n                else {\n                    throw e;\n                }\n            }\n        }\n        else {\n            options.params = {\n                labels: this.labels.join(','),\n                order_by: 'created_at',\n                sort: 'asc',\n                search: issueTitle,\n            };\n            const { data } = await this.$http.get(`projects/${this._encodedRepo}/issues`, options);\n            const issue = data\n                .map(normalizeIssue)\n                .find(item => item.title === issueTitle);\n            return issue || null;\n        }\n    }\n    /**\n     * Create a new issue\n     *\n     * @see https://docs.gitlab.com/ce/api/issues.html#new-issue\n     */\n    async postIssue({ accessToken, title, content, }) {\n        const { data } = await this.$http.post(`projects/${this._encodedRepo}/issues`, {\n            title,\n            description: content,\n            labels: this.labels.join(','),\n        }, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeIssue(data);\n    }\n    /**\n     * Get comments of this page according to the issue id\n     *\n     * @see https://docs.gitlab.com/ce/api/notes.html#list-project-issue-notes\n     * @see https://docs.gitlab.com/ce/api/README.html#pagination\n     *\n     * @remarks\n     * Cannot get the HTML content and the reactions (award_emoji) here.\n     * So have to request them via `markdown` and `award_emoji` API.\n     */\n    async getComments({ accessToken, issueId, query: { page = 1, perPage = 10, sort = 'desc' } = {}, }) {\n        const options = {\n            params: {\n                // pagination\n                page: page,\n                per_page: perPage,\n                order_by: 'created_at',\n                sort: sort,\n            },\n        };\n        if (accessToken) {\n            options.headers = {\n                Authorization: `Bearer ${accessToken}`,\n            };\n        }\n        const response = await this.$http.get(`projects/${this._encodedRepo}/issues/${issueId}/notes`, options);\n        const commentsRaw = response.data;\n        // gitlab api v4 should get parsed markdown content and reactions by other api\n        // this is potentially to cause 429 Too Many Requests\n        const getCommentsMeta = [];\n        for (const comment of commentsRaw) {\n            getCommentsMeta.push((async () => {\n                comment.body_html = await this.getMarkdownContent({\n                    accessToken: accessToken,\n                    contentRaw: comment.body,\n                });\n            })());\n            getCommentsMeta.push((async () => {\n                comment.reactions = await this.getCommentReactions({\n                    accessToken: accessToken,\n                    issueId: issueId,\n                    commentId: comment.id,\n                });\n            })());\n        }\n        await Promise.all(getCommentsMeta);\n        return {\n            count: Number(response.headers['x-total']),\n            page: Number(response.headers['x-page']),\n            perPage: Number(response.headers['x-per-page']),\n            data: commentsRaw.map(normalizeComment),\n        };\n    }\n    /**\n     * Create a new comment\n     *\n     * @see https://docs.gitlab.com/ce/api/notes.html#create-new-issue-note\n     */\n    async postComment({ accessToken, issueId, content, }) {\n        const { data } = await this.$http.post(`projects/${this._encodedRepo}/issues/${issueId}/notes`, {\n            body: content,\n        }, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeComment(data);\n    }\n    /**\n     * Edit a comment\n     *\n     * @see https://docs.gitlab.com/ce/api/notes.html#modify-existing-issue-note\n     */\n    async putComment({ accessToken, issueId, commentId, content, }) {\n        const { data } = await this.$http.put(`projects/${this._encodedRepo}/issues/${issueId}/notes/${commentId}`, {\n            body: content,\n        }, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        const [contentHTML, reactions] = await Promise.all([\n            this.getMarkdownContent({\n                accessToken: accessToken,\n                contentRaw: data.body,\n            }),\n            this.getCommentReactions({\n                accessToken: accessToken,\n                issueId: issueId,\n                commentId: data.id,\n            }),\n        ]);\n        data.body_html = contentHTML;\n        data.reactions = reactions;\n        return normalizeComment(data);\n    }\n    /**\n     * Delete a comment\n     *\n     * @see https://docs.gitlab.com/ce/api/notes.html#delete-an-issue-note\n     */\n    async deleteComment({ accessToken, issueId, commentId, }) {\n        const { status } = await this.$http.delete(`projects/${this._encodedRepo}/issues/${issueId}/notes/${commentId}`, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return status === 204;\n    }\n    /**\n     * Get reactions of a comment\n     *\n     * @see https://docs.gitlab.com/ce/api/award_emoji.html#list-an-awardables-award-emoji\n     */\n    async getCommentReactions({ accessToken, issueId, commentId, }) {\n        const { data } = await this.$http.get(`projects/${this._encodedRepo}/issues/${issueId}/notes/${commentId}/award_emoji`, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeReactions(data);\n    }\n    /**\n     * Create a new reaction of a comment\n     *\n     * @see https://docs.gitlab.com/ce/api/award_emoji.html#award-a-new-emoji\n     */\n    async postCommentReaction({ issueId, commentId, reaction, accessToken, }) {\n        try {\n            const response = await this.$http.post(`projects/${this._encodedRepo}/issues/${issueId}/notes/${commentId}/award_emoji`, {\n                name: mapReactionName(reaction),\n            }, {\n                headers: {\n                    Authorization: `Bearer ${accessToken}`,\n                },\n            });\n            return response.status === 201;\n        }\n        catch (e) {\n            // it could be a bug of gitlab\n            // if a reaction (award emoji) has already existed, it returns a 404 response with a buggy message\n            // have submitted an issue: https://gitlab.com/gitlab-org/gitlab-ce/issues/56147\n            /* istanbul ignore next */\n            if (e.response && e.response.status === 404) {\n                return false;\n            }\n            else {\n                throw e;\n            }\n        }\n    }\n    /**\n     * Get the parse HTML of markdown content\n     *\n     * @see https://docs.gitlab.com/ce/api/markdown.html\n     */\n    async getMarkdownContent({ accessToken, contentRaw, }) {\n        const options = {};\n        if (accessToken) {\n            options.headers = {\n                Authorization: `Bearer ${accessToken}`,\n            };\n        }\n        const { data } = await this.$http.post(`markdown`, {\n            text: contentRaw,\n            gfm: true,\n        }, options);\n        return data.html;\n    }\n}\n//# sourceMappingURL=index.js.map"]}]}